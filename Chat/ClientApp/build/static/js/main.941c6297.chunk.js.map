{"version":3,"sources":["constants.ts","utils/utils.ts","components/styles/ChatThread.styles.ts","components/ChatThread.tsx","core/actions/ContosoClientAction.ts","core/actions/ConversationsAction.ts","core/actions/MessagesAction.ts","core/actions/ThreadAction.ts","core/actions/ThreadMembersAction.ts","core/actions/calls.ts","core/actions/controls.ts","core/actions/devices.ts","core/actions/streams.ts","core/RemoteStreamSelector.ts","core/constants.ts","core/actions/sdk.ts","components/SidePanel.tsx","core/sideEffects.ts","containers/ChatThread.ts","components/styles/SendBox.styles.ts","containers/SendBox.ts","components/SendBox.tsx","components/styles/TypingIndicator.styles.ts","containers/TypingIndicator.ts","components/TypingIndicator.tsx","components/styles/ChatArea.styles.ts","containers/ChatArea.ts","components/ChatArea.tsx","components/styles/SidePanel.styles.ts","components/styles/ChatHeader.styles.ts","components/InviteFooter.tsx","components/styles/MemberItem.styles.ts","components/MemberItem.tsx","components/styles/ConfigurationScreen.styles.ts","components/LocalPreview.tsx","components/CommandPanel.tsx","containers/ChatHeader.ts","components/ChatHeader.tsx","containers/SidePanel.ts","components/styles/ChatScreen.styles.ts","containers/ChatScreen.ts","components/ChatScreen.tsx","components/DisplayNameField.tsx","containers/ConfigurationScreen.ts","components/ConfigurationScreen.tsx","components/styles/LocalPreview.styles.ts","components/styles/LocalSettings.styles.ts","components/LocalSettings.tsx","components/styles/CallConfigurationScreen.styles.ts","components/CallDisplayNameField.tsx","containers/CallConfigurationScreen.ts","components/CallConfigurationScreen.tsx","components/styles/EndChat.styles.ts","components/EndScreen.tsx","components/RemovedFromThreadScreen.tsx","components/styles/HomeScreen.styles.ts","components/HomeScreen.tsx","containers/HomeScreen.ts","core/reducers/ContosoClientReducers.ts","core/reducers/ConversationsReducers.ts","core/reducers/MessagesReducer.ts","core/reducers/ThreadReducers.ts","core/reducers/ThreadMembersReducers.ts","core/reducers/devices.ts","core/reducers/streams.ts","core/reducers/controls.ts","core/reducers/sdk.ts","core/reducers/calls.ts","core/reducers/index.ts","components/styles/MediaControls.styles.ts","components/MediaControls.tsx","components/styles/ParticipantStack.styles.ts","components/ParticipantStack.tsx","containers/ParticipantStack.ts","components/styles/CommandPanel.styles.ts","components/Footer.tsx","components/styles/Header.styles.ts","containers/Header.ts","components/Header.tsx","components/styles/MediaGallery.styles.ts","components/styles/StreamMedia.styles.ts","components/LocalStreamMedia.tsx","components/RemoteStreamMedia.tsx","containers/MediaGallery.ts","components/MediaGallery.tsx","components/styles/MediaFullScreen.styles.ts","components/MediaFullScreen.tsx","components/styles/GroupCall.styles.ts","containers/GroupCall.ts","components/GroupCall.tsx","components/styles/EndCall.styles.ts","components/EndCall.tsx","App.tsx","index.tsx","assets/staticmedia.svg","assets/hero.svg"],"names":["URL_REGEX","EMPTY_MESSAGE_REGEX","getBackgroundColor","avatar","backgroundColor","getThreadId","urlParams","URLSearchParams","window","location","search","console","log","get","compareMessages","firstMessage","secondMessage","undefined","createdOn","Date","getTime","isUserMatchingIdentity","user","communicationUserId","isCommunicationUserIdentifier","convertToClientChatMessage","chatMessage","clientMessageId","content","message","sender","senderDisplayName","id","createNewClientChatMessage","userId","displayName","kind","utils","getAppServiceUrl","origin","getTokenForUser","a","fetch","response","ok","json","Error","getRefreshedTokenForUser","identity","token","isSelectedAudioDeviceInList","selected","list","filter","item","name","length","isSelectedVideoDeviceInList","isMobileSession","navigator","userAgent","match","isSmallScreen","innerWidth","innerHeight","isUnsupportedBrowser","getId","identifier","phoneNumber","microsoftTeamsUserId","getStreamId","stream","mediaStreamType","isOnIphoneAndNotSafari","includes","getBuildTime","messageAvatarContainerStyle","mergeStyles","width","minWidth","height","borderRadius","alignItems","display","justifyContent","fontFamily","fontSize","chatContainerStyle","maxHeight","overflow","noReadReceiptStyle","chatStyle","border","readReceiptIconStyle","mine","marginLeft","newMessageButtonStyle","float","loadMoreMessageButtonStyle","minHeight","DownIconStyle","marginRight","createdRef","createRef","chatThreadRef","setChatClient","chatClient","type","setContosoUser","setContosoUsers","users","setReceipts","receipts","setMessages","messages","setTypingNotifications","typingNotification","setTypingUsers","typingUsers","setFailedMessages","failedMessages","setThreadTopicName","topicName","setThreadId","threadId","setThreadMembers","threadMembers","setThreadMembersError","error","setCallAgent","callAgent","callAdded","addedCall","call","callRemoved","removedCall","group","incomingCallEndReason","direction","callEndReason","groupCallEndReason","setCallState","callState","setParticipants","participants","remoteParticipants","setDominantParticipants","dominantParticipants","setMic","mic","setShareScreen","shareScreen","setDeviceManager","deviceManager","setMicrophonePermission","microphonePermission","setCameraPermission","cameraPermission","setAudioDeviceInfo","audioDeviceInfo","setVideoDeviceInfo","videoDeviceInfo","setAudioDeviceList","audioDeviceList","setVideoDeviceList","videoDeviceList","addScreenShareStream","AudioChangedEvent","participantId","isUnMuted","timeStamp","this","now","participant","lastUnMuted","VideoChangedEvent","isVideoOn","SelectionState","RemoteStreamSelector","dominantParticipantsCount","dispatch","dipatch","batchedCommands","compareFn","b","processCommands","commands","forEach","command","process","sortedList","values","sort","slice","participantAudioChanged","isUnmuted","push","participantVideoChanged","participantStateChanged","state","set","delete","Map","setInterval","ProcessingDelayInSeconds","Singleton","getInstance","Constants","INCOMING","RINGING","CONNECTING","CONNECTED","DEFAULT_IMG_WIDTH","CROP_MEDIA","CONFIGURATION_LOCAL_VIDEO_PREVIEW_ID","LOCAL_VIDEO_PREVIEW_ID","MINI_HEADER_WINDOW_WIDTH","DOMINANT_PARTICIPANTS_COUNT","SidePanelTypes","setUserId","setCallClient","callClient","addUserToThread","emoji","getState","thread","getEnvironmentUrl","environmentUrl","getToken","userToken","options","tokenRefresher","refreshTokenAsync","refreshProactively","userAccessTokenCredentialNew","AzureCommunicationTokenCredential","ChatClient","setEmoji","getChatThreadClient","chatThreadClient","subscribeForMessage","subscribeForTypingIndicator","subscribeForReadReceipt","subscribeForChatParticipants","subscribeForTopicUpdated","addThreadMemberHelper","memberRole","getThreadInformation","getMessages","startRealtimeNotifications","on","event","fromId","from","originalArrivalTime","receivedOn","recipientId","recipient","version","chat","contosoClient","clientChatMessage","listReadReceipts","byPage","page","receipt","participantsRemoved","chatParticipant","isRemoved","originalParticipants","i","addedParticipants","participantsAdded","map","shareHistoryTime","addedParticipant","j","Object","assign","threadMember","getEmoji","serverUser","e","properties","topic","shouldDisplayTyping","lastReceivedTypingEventDate","isValidThread","validationRequestOptions","method","status","getMessagesHelper","reversedClientChatMessages","reverse","createThread","createThreadHelper","href","removeThreadMemberByUserId","removeParticipant","iteratableParticipants","listParticipants","chatParticipants","validChatParticipants","getProperties","updateThreadTopicName","setIsSavingTopicName","updateThreadTopicNameHelper","createThreadRequestOptions","createThreadResponse","text","updateTopic","body","addMemberRequestOptions","headers","JSON","stringify","sendMessageHelper","messageContent","sendMessage","messageResult","getMessage","updateMessagesArray","failed","newMessage","listMessages","maxPageSize","getMessagesResponse","messages_temp","sendTypingNotificationHelper","sendTypingNotification","getRequestOptions","then","getTokenRequestOptions","getTokenResponse","_responseJson","userIdentity","Promise","resolve","reject","Emoji","sendReadReceiptHelper","messageId","postReadReceiptRequest","chatMessageId","sendReadReceipt","setMicrophone","calls","controls","unmute","mute","subscribeToParticipant","remoteStreamSelector","isMuted","videoStreams","isAvailable","added","addedStream","updateAudioDevices","getMicrophones","microphoneList","devices","selectMicrophone","updateVideoDevices","getCameras","cameraList","subscribeToDeviceManager","askDevicePermission","audio","video","registerToCallAgent","callEndedHandler","setLogLevel","hangUp","isScreenSharingOn","ev","addedRemoteParticipant","removed","code","endCall","catch","joinGroup","context","callOptions","join","connect","isYourLatestMessage","latestArrivalTime","latestMessageId","date","isLargeParticipantsGroup","isMessageSeen","conversations","find","readMessagecreatedOn","isYourLatestSeenMessage","MessagesWithSeen","isSeen","props","useState","messagesWithAttached","setMessagesWithAttached","indexOfTheFirstMessage","setIndexOfTheFirstMessage","isAtBottomOfScroll","setIsAtBottomOfScroll","isAtTopOfScroll","setIsAtTopOfScroll","existsNewMessage","setExistsNewMessage","shouldUpdateMessageWithAttached","setShouldUpdateMessageWithAttached","numberOfMessagesToRender","setNumberOfMessagesToRender","messagesWithAttachedRef","useRef","isAtBottomOfScrollRef","numberOfMessagesToRenderRef","useEffect","numberOfMessagesToRenderValue","Math","ceil","current","clientHeight","updateIndexOfTheFirstMessage","scrollToBottom","addEventListener","handleScroll","removeEventListener","updateMessageWithAttached","loadNewMessages","scrollTop","scrollHeight","readReceiptIcon","failedMessage","TooltipHost","size","styles","color","messageWithAttached","className","isAtBottomOfScrollValue","atBottom","atTop","updateIndexOfTheFirstMessageToLoadMore","messagesWithAttachedValue","newMessagesWithAttached","index","messagesList","attached","Ref","innerRef","Stack","Button","fluid","disabled","onClick","Chat","items","liveAuthor","messageContentItem","aria-live","split","part","test","target","rel","gutter","key","contentPosition","Flex","vAlign","Message","overflowY","author","PrimaryButton","Icon","iconName","textFieldStyle","TextFieldStyleProps","wrapper","fieldGroup","sendBoxStyle","fontWeight","sendIconStyle","paddingLeft","paddingTop","emojiStyle","padding","marginBottom","onSendMessage","floor","random","toString","onSendTypingNotification","lastSentTypingNotificationDate","setLastSentTypingNotificationDate","currentDate","textValue","setTextValue","textValueOverflow","setTextValueOverflow","showEmojiPicker","setEmojiPicker","addMessage","onSelect","native","horizontal","TextField","borderless","ariaLabel","inputClassName","placeholder","value","onChange","autoComplete","onKeyUp","which","outline","TypingIndicatorContainerStyle","TypingIndicatorListStyle","whiteSpace","textOverflow","paddingRight","TypingIndicatorVerbStyle","generateTypingIndicatorList","typingUsersFromStore","contosoUsers","currentContosoUser","typingIndicator","typingUser","typingUserWithEmoji","len","generateTypingIndicatorVerb","typingIndicatorVerb","chatAreaContainerStyle","paddingBottom","typingNotifications","onUpdateTypingUsers","listener","clearInterval","palette","getTheme","paneFooterTokens","childrenGap","textFieldStyles","field","neutralSecondary","root","footerMainTextStyle","marginTop","copyLinkButtonStyle","copyIconStyle","copyLinkTextStyle","sidePanelContainerStyle","showSidePanel","borderLeft","titleStyle","memberListStyle","settingsListStyle","textFieldIconStyle","saveChatNameButtonStyle","inviteFooterStackContainerStyles","bottom","borderTop","inviteFooterStackStyles","topicWarningStyle","emptyWarningStyle","saveButtonTextStyle","groupNameStyle","groupNameInputBoxStyle","boxSizing","groupNameInputBoxWarningStyle","chatHeaderContainerStyle","selectors","borderBottom","topicNameLabelStyle","maxWidth","wordBreak","leaveButtonStyle","borderWidth","borderColor","pivotItemStyle","pivotItemStyles","linkIsSelected","themePrimary","link","verticalAlign","largeButtonContainerStyle","copyJoinLink","document","getElementById","select","execCommand","focus","tokens","tabIndex","baseURI","tab-index","memberItemContainerStyle","position","memberItemNameStyle","memberItemIsYouStyle","moreInforStyle","right","isYou","IconButton","menuIconProps","menuProps","responsiveLayoutStyle","flexDirection","leftPreviewContainerStyle","rightInputContainerStyle","smallAvatarContainerStyle","selectedAvatar","largeAvatarContainerStyle","smallAvatarStyle","letterSpacing","lineHeight","textAlign","largeAvatarStyle","labelFontStyle","inputBoxStyle","horizontalAlign","inputBoxTextStyle","inputBoxWarningStyle","warningStyle","chatIconStyle","buttonStyle","mainContainerStyle","startChatButtonTextStyle","rendererView","CommandPanelTypes","existsTopicName","generateHeaderMessage","header","members","member","removeChatParticipantById","setHeader","togglePeople","selectedPane","setSelectedPane","People","None","toggleSettings","Settings","leaveChatHandler","startCallHandler","Item","align","Pivot","onKeyDownCapture","keyCode","preventDefault","getTabId","itemKey","onLinkClick","togglePivotItem","defaultSelectedKey","selectedKey","PivotItem","onRenderItemLink","UserFriendsIcon","SettingsIcon","DefaultButton","setTopicName","setIsEditingTopicName","isTopicNameOverflow","setTopicNameOverflow","isSavingTopicName","onTopicNameSubmit","setTimeout","StackItem","FocusZone","FocusZoneDirection","vertical","person","MemberItem","InviteFooter","defaultValue","onSubmit","chatScreenContainerStyle","chatScreenBottomContainerStyle","removedFromThreadHandler","grow","disableShrink","isEmpty","isNameLengthExceedLimit","setName","setNameLengthExceedLimit","setEmptyWarning","onKeyDown","validateName","role","setup","avatarsList","emptyWarning","setSelectedAvatar","isJoining","setIsJoining","setIsValidThread","joinChatHandler","isValidThreadProp","joinChatArea","aria-label","opacity","wordWrap","data-is-focusable","onFocus","DisplayNameField","ChatIcon","Spinner","label","ariaLive","labelPosition","toggleStyle","imgStyles","toggleButtonsBarToken","localPreviewContainerStyle","background","neutralLighter","neutralPrimaryAlt","toggleButtonsBarStyle","neutralQuaternaryAlt","localPreviewStyle","imageProps","src","staticMediaSVG","imageFit","ImageFit","cover","maximizeFrame","localVideoStream","renderer","VideoStreamRenderer","createView","scalingMode","isMirrored","container","childElementCount","appendChild","dispose","Image","CallVideoIcon","Toggle","checked","_ev","LocalVideoStream","setLocalVideoStream","MicIcon","mainStackTokens","micStackTokens","dropDownStyles","caretDownWrapper","dropdownItem","dropdown","title","localSettingsContainer","getDropDownList","val","deviceType","Dropdown","configurationStackTokens","videoCameraIconStyle","localSettingsContainerStyle","fullScreenStyle","verticalStackStyle","boxShadow","margin","overflowWrap","connector","screenWidth","groupId","videoOptions","localVideoStreams","audioOptions","muted","tokenResponse","tokenCredential","createCallAgent","sdk","deviceInfo","setupCallClient","unsupportedStateHandler","CallClient","getDeviceManager","initCallClient","registerToCallEvents","endCallHandler","setGroup","updateDevices","LocalPreview","CallDisplayNameField","LocalSettings","VideoCameraEmphasisIcon","buttonsStackTokens","upperStackTokens","endCallContainerStyle","endCallTitleStyle","buttonTextStyle","isRejoiningThread","setIsRejoiningThread","rejoinThread","rejoinHandler","homeHandler","imgStyle","containerTokens","headerStyle","listStyleType","upperStackStyle","startChatTextStyle","imageStyleProps","image","createThreadHandler","heroSVG","isCreatingThread","setIsCreatingThread","alt","initContosoState","initConversationsState","initMessagesState","initThreadState","initState","initialState","localVideoRendererIsBusy","screenShareStreams","localVideo","attempts","reducer","combineReducers","action","streams","newScreenShareStream","mediaControlStyles","controlButtonStyle","white","controlButtonDisabledStyle","neutralLight","endCallButtonStyle","endCallButtonTextStyle","fullWidth","cameraActive","cameraDisabled","cameraOnClick","onCameraChange","micActive","micDisabled","micOnClick","onMicChange","screenShareDisabled","activeScreenShareStream","CommandButton","CallVideoOffIcon","MicOffIcon","isLocalScreenShareSupportedInBrowser","onScreenShareChange","screenShareActive","CallControlCloseTrayIcon","CallControlPresentNewIcon","onEndCallClick","compressedMode","CallEndIcon","itemStyles","alignSelf","primaryText","overFlowButtonStyles","participantStackStyle","iconStyle","participantStackTokens","onRenderItem","Persona","PersonaSize","size32","presence","PersonaPresence","online","offline","isSpeaking","isScreenSharing","FontIcon","onRenderOverflowButton","overflowItems","screenShareStream","OverflowSet","getParticipants","fullHeightStyles","paneFooterStyles","paneHeaderStyle","paneHeaderTextStyle","settingsContainerStyle","Separator","Footer","headerContainer","headerCenteredContainer","separatorContainerStyle","separatorStyles","actionable","forEveryone","setScreenShare","screenShare","startScreenSharing","stopScreenSharing","handleLocalVideoOnOff","stopVideo","startVideo","initialSelectedKey","MediaControls","mediaGalleryStyle","borderRight","substageMediaGalleryStyle","mediaGalleryGridStyle","neutralLighterAlt","mediaGallerySubstageStyle","overflowX","videoHint","left","mediaContainer","localVideoContainerStyle","rendererViewRef","activeStreamBeingRendered","setActiveStreamBeingRendered","contain","style","Label","streamId","showRenderLoading","setShowRenderLoading","isParticipantStreamSelected","renderRemoteStream","useCallback","SpinnerSize","xSmall","gridCol","setGridCol","gridRow","setGridRow","rows","cols","warn","numRemoteParticipantsToRender","min","numberStreamsToRender","useMemo","num","max","participantsToLayout","isParticipantADominant","p","isParticipantBDominant","mainStageParticipants","substageParticipants","isSubstageVisible","gridTemplateRows","gridTemplateColumns","remoteParticipantsMediaGalleryItems","RemoteStreamMedia","localParticipantMediaGalleryItem","LocalStreamMedia","unshift","getMediaGalleryTilesForParticipants","hiddenFullScreenStyle","loadingStyle","loading","setLoading","renderStreamCallback","headerStyles","containerStyles","paneStyles","overlayStyles","hiddenContainerClassName","activeContainerClassName","isGroup","activeScreenShare","CommandPanel","Overlay","MediaFullScreen","info","require","loadTheme","initializeIcons","store","createStore","applyMiddleware","thunk","setPage","setCallEndReason","setScreenWidth","setWindowWidth","getGroupIdFromUrl","history","pushState","errorMsg","EndCall","EndScreen","RemovedFromThreadScreen","iconTheme","componentStyles","SvgIcon","svgIconStyles","componentVariables","svgIconVariables","siteVariables","ReactDOM","render","Provider","theme","mergeThemes","teamsTheme","App","module","exports"],"mappings":"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","file":"static/js/main.941c6297.chunk.js","sourcesContent":["// Project settings\nexport const GUID_FOR_INITIAL_TOPIC_NAME = 'c774da81-94d5-4652-85c7-6ed0e8dc67e6';\n\n// Project configurations\nexport const INITIAL_MESSAGES_SIZE = 2000;\nexport const MAXIMUM_LENGTH_OF_NAME = 20;\nexport const MAXIMUM_LENGTH_OF_MESSAGE = 8000;\nexport const MAXIMUM_LENGTH_OF_TOPIC = 30;\nexport const MAXIMUM_LENGTH_OF_TYPING_USERS = 35;\nexport const MINIMUM_TYPING_INTERVAL_IN_MILLISECONDS = 8000;\nexport const MAXIMUM_INT64 = 9223372036854775807;\nexport const NUMBER_OF_MESSAGES_TO_LOAD = 10;\nexport const PAGE_SIZE = 200;\nexport const PARTICIPANTS_THRESHOLD = 20;\n\n// Keyboard keys\nexport const ENTER_KEY = 13;\nexport const SPACE_KEY = 32;\n\n// Http Status Code\nexport const OK = 200;\n\n// Regex\nexport const URL_REGEX = /https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/;\nexport const EMPTY_MESSAGE_REGEX = /^\\s*$/;\n","import { ChatMessage } from '@azure/communication-chat';\nimport { CommunicationIdentifier, isCommunicationUserIdentifier } from '@azure/communication-common';\nimport preval from 'preval.macro';\nimport { ClientChatMessage } from '../core/reducers/MessagesReducer';\nimport { AudioDeviceInfo, VideoDeviceInfo, RemoteVideoStream } from '@azure/communication-calling';\nimport { CommunicationIdentifierKind } from '@azure/communication-common';\nimport { CommunicationUserToken } from '@azure/communication-identity';\n\nexport const CAT = '🐱';\nexport const MOUSE = '🐭';\nexport const KOALA = '🐨';\nexport const OCTOPUS = '🐙';\nexport const MONKEY = '🐵';\nexport const FOX = '🦊';\n\nexport const getImage = (avatar: string, isSmall: boolean) => {\n  let avatarType: string = '';\n  switch (avatar) {\n    case CAT:\n      avatarType = 'cat';\n      break;\n    case MOUSE:\n      avatarType = 'mouse';\n      break;\n    case KOALA:\n      avatarType = 'koala';\n      break;\n    case OCTOPUS:\n      avatarType = 'octopus';\n      break;\n    case MONKEY:\n      avatarType = 'monkey';\n      break;\n    case FOX:\n      avatarType = 'fox';\n      break;\n  }\n\n  return `${isSmall ? '1' : '2'}x/${avatarType}.png`;\n};\nexport const getBackgroundColor = (avatar: string) => {\n  switch (avatar) {\n    case CAT:\n      return {\n        backgroundColor: 'rgba(255, 250, 228, 1)'\n      };\n    case MOUSE:\n      return {\n        backgroundColor: 'rgba(33, 131, 196, 0.1)'\n      };\n    case KOALA:\n      return {\n        backgroundColor: 'rgba(197, 179, 173, 0.3)'\n      };\n    case OCTOPUS:\n      return {\n        backgroundColor: 'rgba(255, 240, 245, 1)'\n      };\n    case MONKEY:\n      return {\n        backgroundColor: 'rgba(255, 245, 222, 1)'\n      };\n    case FOX:\n      return {\n        backgroundColor: 'rgba(255, 231, 205, 1)'\n      };\n    default:\n      return {\n        backgroundColor: 'rgba(255, 250, 228, 1)'\n      };\n  }\n};\n\nexport const getThreadId = () => {\n  const urlParams = new URLSearchParams(window.location.search);\n  console.log(urlParams.get('threadId'));\n  return urlParams.get('threadId');\n};\n\nexport const getBuildTime = () => {\n  const dateTimeStamp = preval`module.exports = new Date().toLocaleString();`;\n  return dateTimeStamp;\n};\n\nexport function getChatSDKVersion() {\n  return require('../../package.json')['dependencies']['@azure/communication-chat'];\n}\n\nexport const compareMessages = (firstMessage: ClientChatMessage, secondMessage: ClientChatMessage) => {\n  if (firstMessage.createdOn === undefined) return 1;\n  if (secondMessage.createdOn === undefined) return -1;\n  const firstDate = new Date(firstMessage.createdOn).getTime();\n  const secondDate = new Date(secondMessage.createdOn).getTime();\n  return firstDate - secondDate;\n};\n\nexport const isUserMatchingIdentity = (user: CommunicationIdentifier, communicationUserId: string): boolean => {\n  return isCommunicationUserIdentifier(user) && user.communicationUserId === communicationUserId;\n};\n\nexport const convertToClientChatMessage = (chatMessage: ChatMessage, clientMessageId?: string): ClientChatMessage => {\n  return {\n    content: { message: chatMessage.content?.message },\n    clientMessageId: clientMessageId,\n    sender: chatMessage.sender,\n    senderDisplayName: chatMessage.senderDisplayName,\n    createdOn: chatMessage.createdOn,\n    id: chatMessage.id\n  };\n};\n\nexport const createNewClientChatMessage = (\n  userId: string,\n  displayName: string,\n  clientMessageId: string,\n  message: string\n): ClientChatMessage => {\n  return {\n    content: { message: message },\n    clientMessageId: clientMessageId,\n    sender: { communicationUserId: userId, kind: 'communicationUser' },\n    senderDisplayName: displayName,\n    createdOn: new Date()\n  };\n};\n\nexport const utils = {\n  getAppServiceUrl: (): string => {\n    return window.location.origin;\n  },\n  getTokenForUser: async (): Promise<CommunicationUserToken> => {\n    const response = await fetch('/token');\n    if (response.ok) {\n      return response.json();\n    }\n    throw new Error('Invalid token response');\n  },\n  getRefreshedTokenForUser: async (identity: string): Promise<string> => {\n    const response = await fetch(`/refreshToken/${identity}`);\n    if (response.ok) {\n      const content = await response.json();\n      return content.token;\n    }\n    throw new Error('Invalid token response');\n  },\n  isSelectedAudioDeviceInList(selected: AudioDeviceInfo, list: AudioDeviceInfo[]): boolean {\n    return list.filter((item) => item.name === selected.name).length > 0;\n  },\n  isSelectedVideoDeviceInList(selected: VideoDeviceInfo, list: VideoDeviceInfo[]): boolean {\n    return list.filter((item) => item.name === selected.name).length > 0;\n  },\n  isMobileSession(): boolean {\n    return window.navigator.userAgent.match(/(iPad|iPhone|iPod|Android|webOS|BlackBerry|Windows Phone)/g)\n      ? true\n      : false;\n  },\n  isSmallScreen(): boolean {\n    return window.innerWidth < 700 || window.innerHeight < 400;\n  },\n  isUnsupportedBrowser(): boolean {\n    return window.navigator.userAgent.match(/(Firefox)/g) ? true : false;\n  },\n  getId: (identifier: CommunicationIdentifierKind): string => {\n    switch (identifier.kind) {\n      case 'communicationUser':\n        return identifier.communicationUserId;\n      case 'phoneNumber':\n        return identifier.phoneNumber;\n      case 'microsoftTeamsUser':\n        return identifier.microsoftTeamsUserId;\n      case 'unknown':\n        return identifier.id;\n    }\n  },\n  getStreamId: (userId: string, stream: RemoteVideoStream): string => {\n    return `${userId}-${stream.id}-${stream.mediaStreamType}`;\n  },\n  /*\n   * TODO:\n   *  Remove this method once the SDK improves error handling for unsupported browser.\n   */\n  isOnIphoneAndNotSafari(): boolean {\n    const userAgent = navigator.userAgent;\n    // Chrome uses 'CriOS' in user agent string and Firefox uses 'FxiOS' in user agent string.\n    if (userAgent.includes('iPhone') && (userAgent.includes('FxiOS') || userAgent.includes('CriOS'))) {\n      return true;\n    }\n    return false;\n  },\n  getBuildTime: (): string => {\n    const dateTimeStamp = preval`module.exports = new Date().toLocaleString();`;\n    return dateTimeStamp;\n  }\n};\n","import { mergeStyles } from '@fluentui/react';\nimport { ComponentSlotStyle } from '@fluentui/react-northstar';\n\nimport { getBackgroundColor } from '../../utils/utils';\n\nconst messageAvatarContainerStyle = (avatar: string) =>\n  mergeStyles({\n    width: '2rem',\n    minWidth: '2rem',\n    height: '2rem',\n    backgroundColor: getBackgroundColor(avatar)?.backgroundColor,\n    borderRadius: '50%',\n    alignItems: 'center',\n    display: 'flex',\n    justifyContent: 'center',\n    fontFamily: 'Segoe UI Regular',\n    fontSize: '1rem' // 16px\n  });\n\nconst chatContainerStyle = mergeStyles({\n  height: '100%',\n  width: '100%',\n  maxHeight: '100%',\n  overflow: 'auto'\n});\n\nconst noReadReceiptStyle = mergeStyles({\n  width: '1rem'\n});\n\nconst chatStyle: ComponentSlotStyle = {\n  backgroundColor: 'white',\n  border: 'none',\n  overflow: 'auto',\n  height: '100%'\n};\n\nconst chatMessageStyle = (mine: boolean): ComponentSlotStyle => ({\n  backgroundColor: mine ? 'rgba(42, 161,255, 0.25)' : 'rgba(243,242,241)',\n  overflowY: 'hidden'\n});\n\nconst readReceiptIconStyle = (mine: boolean) =>\n  mergeStyles({\n    marginLeft: mine ? '1rem' : '0rem'\n  });\n\nconst newMessageButtonStyle = mergeStyles({\n  float: 'right',\n  width: 'fit-content'\n});\n\nconst loadMoreMessageButtonStyle = mergeStyles({\n  minHeight: '1.5rem'\n});\n\nconst DownIconStyle = mergeStyles({\n  marginRight: '0.5em'\n});\n\nexport {\n  messageAvatarContainerStyle,\n  chatMessageStyle,\n  readReceiptIconStyle,\n  chatContainerStyle,\n  noReadReceiptStyle,\n  chatStyle,\n  newMessageButtonStyle,\n  loadMoreMessageButtonStyle,\n  DownIconStyle\n};\n","import { Stack, TooltipHost, PrimaryButton, Icon } from '@fluentui/react';\r\nimport {\r\n  Chat,\r\n  MessageSeenIcon,\r\n  Flex,\r\n  Ref,\r\n  Button,\r\n  PresenceAvailableIcon,\r\n  PresenceStrokeIcon,\r\n  RedbangIcon\r\n} from '@fluentui/react-northstar';\r\nimport React, { useEffect, useState, createRef, useRef } from 'react';\r\nimport { LiveAnnouncer, LiveMessage } from 'react-aria-live';\r\n\r\nimport { URL_REGEX, NUMBER_OF_MESSAGES_TO_LOAD } from '../constants';\r\nimport {\r\n  chatContainerStyle,\r\n  messageAvatarContainerStyle,\r\n  noReadReceiptStyle,\r\n  chatStyle,\r\n  chatMessageStyle,\r\n  newMessageButtonStyle,\r\n  loadMoreMessageButtonStyle,\r\n  readReceiptIconStyle,\r\n  DownIconStyle\r\n} from './styles/ChatThread.styles';\r\nimport { User } from '../core/reducers/ContosoClientReducers';\r\nimport { ClientChatMessage } from '../core/reducers/MessagesReducer';\r\nimport { isUserMatchingIdentity } from '../utils/utils';\r\n\r\ninterface ChatThreadProps {\r\n  isYourLatestMessage(clientMessageId: string, messages: any[]): boolean;\r\n  isYourLatestSeenMessage(clientMessageId: string, MessagesWithSeen: any[]): boolean;\r\n  isLargeParticipantsGroup(): boolean;\r\n  isMessageSeen(clientMessageId: string, messages: any[]): boolean;\r\n  sendReadReceipt(messages: any[], userId: string): void;\r\n  messages: ClientChatMessage[];\r\n  user: User;\r\n  users: any;\r\n  failedMessages: string[];\r\n}\r\n\r\n// Reference: https://stackoverflow.com/questions/33235890/react-replace-links-in-a-text\r\n\r\nconst renderHyperlink = (text: string) => {\r\n  return text.split(' ').map((part) =>\r\n    URL_REGEX.test(part) ? (\r\n      <a href={part} target=\"_blank\" rel=\"noopener noreferrer\">\r\n        {part}{' '}\r\n      </a>\r\n    ) : (\r\n      part + ' '\r\n    )\r\n  );\r\n};\r\n\r\nlet createdRef: any = createRef();\r\nlet chatThreadRef: any = createRef();\r\n//  A Chatthread will be fed many messages so it will try to map out the messages out of the props and feed them into a\r\n//  Chat item\r\n//  We need to be smarter and figure out for the last N messages are they all of the same person or not?\r\nexport default (props: ChatThreadProps): JSX.Element => {\r\n  const [messagesWithAttached, setMessagesWithAttached] = useState<any[]>([]);\r\n  const [indexOfTheFirstMessage, setIndexOfTheFirstMessage] = useState(props.messages.length);\r\n  const [isAtBottomOfScroll, setIsAtBottomOfScroll] = useState(true);\r\n  const [isAtTopOfScroll, setIsAtTopOfScroll] = useState(false);\r\n  const [existsNewMessage, setExistsNewMessage] = useState(false);\r\n  const [shouldUpdateMessageWithAttached, setShouldUpdateMessageWithAttached] = useState(false);\r\n  const [numberOfMessagesToRender, setNumberOfMessagesToRender] = useState(0);\r\n  const existsNewMessageText = 'New Messages';\r\n  const loadMoreText = 'click to load more messages...';\r\n  const unableToLoadMoreText = 'You have reached the beginning of the thread';\r\n\r\n  const messagesWithAttachedRef = useRef(messagesWithAttached);\r\n  const setMessagesWithAttachedRef = (messagesWithAttachedValue: any[]) => {\r\n    messagesWithAttachedRef.current = messagesWithAttachedValue;\r\n    setMessagesWithAttached(messagesWithAttachedValue);\r\n  };\r\n\r\n  const isAtBottomOfScrollRef = useRef(isAtBottomOfScroll);\r\n  const setIsAtBottomOfScrollRef = (isAtBottomOfScrollValue: boolean) => {\r\n    isAtBottomOfScrollRef.current = isAtBottomOfScrollValue;\r\n    setIsAtBottomOfScroll(isAtBottomOfScrollValue);\r\n  };\r\n\r\n  const numberOfMessagesToRenderRef = useRef(numberOfMessagesToRender);\r\n  const setNumberOfMessagesToRenderRef = (numberOfMessagesToRenderValue: number) => {\r\n    numberOfMessagesToRenderRef.current = numberOfMessagesToRenderValue;\r\n    setNumberOfMessagesToRender(numberOfMessagesToRenderValue);\r\n  };\r\n\r\n  useEffect(() => {\r\n    setNumberOfMessagesToRenderRef(Math.ceil(chatThreadRef.current.clientHeight / 34)); //34 px is the minimum height of the chat bubble\r\n  }, [chatThreadRef.current?.clientHeight]);\r\n\r\n  useEffect(() => {\r\n    updateIndexOfTheFirstMessage();\r\n  }, [numberOfMessagesToRender]);\r\n\r\n  useEffect(() => {\r\n    // get the sender of the most recent message\r\n    const user =\r\n      props.messages && props.messages[props.messages.length - 1] && props.messages[props.messages.length - 1].sender;\r\n    // if you are the person that sent the most recent message\r\n    if (props.messages.length > 0 && user && isUserMatchingIdentity(user, props.user.identity)) {\r\n      // after sending a message, scroll to bottom\r\n      scrollToBottom();\r\n      updateIndexOfTheFirstMessage();\r\n    } else if (isAtBottomOfScroll) {\r\n      updateIndexOfTheFirstMessage();\r\n    } else {\r\n      setExistsNewMessage(true);\r\n    }\r\n    window.addEventListener('focus', sendReadReceipt);\r\n    createdRef.current.addEventListener('scroll', handleScroll);\r\n    return () => {\r\n      window.removeEventListener('focus', sendReadReceipt);\r\n      createdRef.current.removeEventListener('scroll', handleScroll);\r\n    };\r\n  }, [props.messages]);\r\n\r\n  useEffect(() => {\r\n    if (shouldUpdateMessageWithAttached) {\r\n      updateMessageWithAttached();\r\n    }\r\n    setShouldUpdateMessageWithAttached(false);\r\n  }, [shouldUpdateMessageWithAttached]);\r\n\r\n  // auto scroll to the latest message when we are at bottom of the scroll\r\n  useEffect(() => {\r\n    if (isAtBottomOfScroll) {\r\n      scrollToBottom();\r\n    }\r\n  }, [messagesWithAttached]);\r\n\r\n  const loadMoreMessages = () => {\r\n    updateIndexOfTheFirstMessageToLoadMore();\r\n  };\r\n\r\n  const loadNewMessages = () => {\r\n    scrollToBottom();\r\n    updateIndexOfTheFirstMessage();\r\n  };\r\n\r\n  const scrollToBottom = () => {\r\n    createdRef.current.scrollTop = createdRef.current.scrollHeight - createdRef.current.clientHeight;\r\n    setExistsNewMessage(false);\r\n  };\r\n\r\n  const sendReadReceipt = () => {\r\n    props.sendReadReceipt(messagesWithAttachedRef.current, props.user.identity);\r\n  };\r\n\r\n  const readReceiptIcon = (message: any) => {\r\n    // message is pending send or is failed to be sent\r\n    if (message.failed) {\r\n      let messageFailed: boolean =\r\n        props.failedMessages.find((failedMessage: string) => failedMessage === message.clientMessageId) !== undefined;\r\n      return messageFailed ? (\r\n        <TooltipHost content=\"failed to send\">\r\n          <RedbangIcon size=\"medium\" styles={{ color: 'red' }} />{' '}\r\n        </TooltipHost>\r\n      ) : (\r\n        <TooltipHost content=\"sending\">\r\n          <PresenceStrokeIcon size=\"medium\" />{' '}\r\n        </TooltipHost>\r\n      );\r\n    } else {\r\n      // show read receipt if it's not a large participant group\r\n      if (!props.isLargeParticipantsGroup()) {\r\n        let MessagesWithSeen = messagesWithAttached.map((messageWithAttached) => {\r\n          let isSeen = props.isMessageSeen(messageWithAttached.clientMessageId, messagesWithAttached);\r\n          return { ...messageWithAttached, isSeen };\r\n        });\r\n        if (props.isYourLatestSeenMessage(message.clientMessageId, MessagesWithSeen)) {\r\n          return (\r\n            <TooltipHost content=\"seen\">\r\n              <MessageSeenIcon size=\"medium\" />\r\n            </TooltipHost>\r\n          );\r\n        }\r\n      }\r\n      if (props.isYourLatestMessage(message.id, messagesWithAttached)) {\r\n        return (\r\n          <TooltipHost content=\"sent\">\r\n            <PresenceAvailableIcon size=\"medium\" />\r\n          </TooltipHost>\r\n        );\r\n      } else {\r\n        return <div className={noReadReceiptStyle}></div>;\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleScroll = () => {\r\n    let atBottom = createdRef.current.scrollTop >= createdRef.current.scrollHeight - createdRef.current.clientHeight;\r\n    let atTop = createdRef.current.scrollTop === 0;\r\n    if (atBottom && !isAtBottomOfScrollRef.current) {\r\n      loadNewMessages();\r\n    }\r\n    setIsAtBottomOfScrollRef(atBottom);\r\n    setIsAtTopOfScroll(atTop);\r\n  };\r\n\r\n  const updateIndexOfTheFirstMessageToLoadMore = () => {\r\n    setIndexOfTheFirstMessage(\r\n      indexOfTheFirstMessage > NUMBER_OF_MESSAGES_TO_LOAD ? indexOfTheFirstMessage - NUMBER_OF_MESSAGES_TO_LOAD : 0\r\n    );\r\n    setShouldUpdateMessageWithAttached(true);\r\n  };\r\n\r\n  const updateIndexOfTheFirstMessage = () => {\r\n    setIndexOfTheFirstMessage(\r\n      props.messages.length > numberOfMessagesToRenderRef.current\r\n        ? props.messages.length - numberOfMessagesToRenderRef.current\r\n        : 0\r\n    );\r\n    setShouldUpdateMessageWithAttached(true);\r\n  };\r\n\r\n  const updateMessageWithAttached = () => {\r\n    let newMessagesWithAttached: any[] = [];\r\n    let messagesToRender = props.messages.slice(indexOfTheFirstMessage, props.messages.length);\r\n    messagesToRender.map((message: any, index: number, messagesList: any) => {\r\n      let mine = message.sender.communicationUserId === props.user.identity;\r\n      let attached: string | boolean = false;\r\n      if (index === 0) {\r\n        if (index !== messagesList.length - 1) {\r\n          //the next message has the same sender\r\n          if (messagesList[index].sender.communicationUserId === messagesList[index + 1].sender.communicationUserId) {\r\n            attached = 'top';\r\n          }\r\n        }\r\n      } else {\r\n        if (messagesList[index].sender.communicationUserId === messagesList[index - 1].sender.communicationUserId) {\r\n          //the previous message has the same sender\r\n          if (index !== messagesList.length - 1) {\r\n            if (messagesList[index].sender.communicationUserId === messagesList[index + 1].sender.communicationUserId) {\r\n              //the next message has the same sender\r\n              attached = true;\r\n            } else {\r\n              //the next message has a different sender\r\n              attached = 'bottom';\r\n            }\r\n          } else {\r\n            // this is the last message of the whole messages list\r\n            attached = 'bottom';\r\n          }\r\n        } else {\r\n          //the previous message has a different sender\r\n          if (index !== messagesList.length - 1) {\r\n            if (messagesList[index].sender.communicationUserId === messagesList[index + 1].sender.communicationUserId) {\r\n              //the next message has the same sender\r\n              attached = 'top';\r\n            }\r\n          }\r\n        }\r\n      }\r\n      let messageWithAttached = { ...message, attached, mine };\r\n      newMessagesWithAttached.push(messageWithAttached);\r\n    });\r\n    setMessagesWithAttachedRef(newMessagesWithAttached);\r\n  };\r\n\r\n  return (\r\n    <Ref innerRef={chatThreadRef}>\r\n      <Stack className={chatContainerStyle}>\r\n        {isAtTopOfScroll && (\r\n          <Button\r\n            text\r\n            fluid\r\n            className={loadMoreMessageButtonStyle}\r\n            content={indexOfTheFirstMessage === 0 ? unableToLoadMoreText : loadMoreText}\r\n            disabled={indexOfTheFirstMessage === 0}\r\n            onClick={loadMoreMessages}\r\n          />\r\n        )}\r\n        <Ref innerRef={createdRef}>\r\n          <LiveAnnouncer>\r\n            <Chat\r\n              styles={chatStyle}\r\n              items={messagesWithAttached.map((message: any, index: number) => {\r\n                const liveAuthor = `${message.senderDisplayName} says `;\r\n                const messageContentItem = (\r\n                  <div>\r\n                    <LiveMessage message={`${message.mine ? '' : liveAuthor} ${message.content}`} aria-live=\"polite\" />\r\n                    {renderHyperlink(message.content.message)}\r\n                  </div>\r\n                );\r\n                return {\r\n                  gutter: message.mine ? (\r\n                    ''\r\n                  ) : (\r\n                    <div\r\n                      className={messageAvatarContainerStyle(\r\n                        props.users[message.sender.communicationUserId] === undefined\r\n                          ? ''\r\n                          : props.users[message.sender.communicationUserId].emoji\r\n                      )}\r\n                    >\r\n                      {props.users[message.sender.communicationUserId] === undefined\r\n                        ? ''\r\n                        : props.users[message.sender.communicationUserId].emoji}\r\n                    </div>\r\n                  ),\r\n                  key: index,\r\n                  contentPosition: message.mine ? 'end' : 'start',\r\n                  message: (\r\n                    <Flex vAlign=\"end\">\r\n                      <Chat.Message\r\n                        styles={chatMessageStyle(message.mine)}\r\n                        content={messageContentItem}\r\n                        author={message.senderDisplayName}\r\n                        mine={message.mine}\r\n                      />\r\n                      <div className={readReceiptIconStyle(message.mine)}>{readReceiptIcon(message)}</div>\r\n                    </Flex>\r\n                  ),\r\n                  attached: message.attached\r\n                };\r\n              })}\r\n            />\r\n          </LiveAnnouncer>\r\n        </Ref>\r\n        {existsNewMessage && (\r\n          <div>\r\n            <PrimaryButton className={newMessageButtonStyle} onClick={loadNewMessages}>\r\n              <Icon iconName=\"Down\" className={DownIconStyle} />\r\n              {existsNewMessageText}\r\n            </PrimaryButton>\r\n          </div>\r\n        )}\r\n      </Stack>\r\n    </Ref>\r\n  );\r\n};\r\n","import { ChatClient } from '@azure/communication-chat';\n\nexport const SET_CHAT_CLIENT = 'SET_CHAT_CLIENT';\nexport const SET_CURRENT_USER = 'SET_CURRENT_USER';\nexport const SET_USERS = 'SET_USERS';\n\nexport type UserConfiguration = {\n  emoji: string;\n};\n\nexport type Users = Record<string, UserConfiguration>;\n\nexport interface SetChatClientAction {\n  type: typeof SET_CHAT_CLIENT;\n  chatClient: ChatClient | undefined;\n}\n\nexport interface SetContosoUserAction {\n  type: typeof SET_CURRENT_USER;\n  identity: string;\n  token: string;\n  displayName: string;\n  memberRole?: string;\n}\n\nexport interface SetContosoUsersAction {\n  type: typeof SET_USERS;\n  users: Users;\n}\n\nexport const setChatClient = (chatClient: ChatClient | undefined): SetChatClientAction => ({\n  type: SET_CHAT_CLIENT,\n  chatClient\n});\n\nexport const setContosoUser = (identity: string, token: string, displayName: string): SetContosoUserAction => ({\n  type: SET_CURRENT_USER,\n  identity,\n  token,\n  displayName\n});\n\nexport const setContosoUsers = (users: Users): SetContosoUsersAction => ({\n  type: SET_USERS,\n  users\n});\n\nexport type ContosoActionTypes = SetChatClientAction | SetContosoUserAction | SetContosoUsersAction;\n","import { ChatMessageReadReceipt } from '@azure/communication-chat';\n\nexport const SET_RECEIPTS = 'SET_RECEIPTS';\n\nexport interface SetReceiptsAction {\n  type: typeof SET_RECEIPTS;\n  receipts: ChatMessageReadReceipt[];\n}\n\nexport const setReceipts = (receipts: ChatMessageReadReceipt[]): SetReceiptsAction => ({\n  type: SET_RECEIPTS,\n  receipts\n});\n\nexport type ConversationsActionTypes = SetReceiptsAction;\n","import { ChatParticipant } from '@azure/communication-chat';\nimport { ClientChatMessage } from '../reducers/MessagesReducer';\n\nexport const SET_MESSAGES = 'SET_MESSAGES';\nexport const SET_TYPING_NOTIFICATIONS = 'SET_TYPING_NOTIFICATIONS';\nexport const SET_TYPING_USERS = 'SET_TYPING_USERS';\nexport const SET_FAILED_MESSAGES = 'SET_FAILED_MESSAGES';\n\nexport interface SetMessagesAction {\n  type: typeof SET_MESSAGES;\n  messages: ClientChatMessage[];\n}\n\nexport type TypingNotification = {\n  recipientId: string; // the user that is sending a message\n  originalArrivalTime: Date; // when the message was last sent\n  threadId: string;\n  version: string;\n};\n\nexport interface SetTypingNotificationsAction {\n  type: typeof SET_TYPING_NOTIFICATIONS;\n  id: string;\n  typingNotification: TypingNotification;\n}\n\nexport interface SetTypingUsersAction {\n  type: typeof SET_TYPING_USERS;\n  typingUsers: ChatParticipant[];\n}\n\nexport interface SetFailedMessagesAction {\n  type: typeof SET_FAILED_MESSAGES;\n  failedMessages: string[];\n}\n\nexport const setMessages = (messages: ClientChatMessage[]): SetMessagesAction => ({\n  type: SET_MESSAGES,\n  messages\n});\n\nexport const setTypingNotifications = (\n  id: string,\n  typingNotification: TypingNotification\n): SetTypingNotificationsAction => ({\n  type: SET_TYPING_NOTIFICATIONS,\n  id,\n  typingNotification\n});\n\nexport const setTypingUsers = (typingUsers: ChatParticipant[]): SetTypingUsersAction => ({\n  type: SET_TYPING_USERS,\n  typingUsers\n});\n\nexport const setFailedMessages = (failedMessages: string[]): SetFailedMessagesAction => ({\n  type: SET_FAILED_MESSAGES,\n  failedMessages\n});\n\nexport type MessagesActionTypes =\n  | SetMessagesAction\n  | SetTypingNotificationsAction\n  | SetTypingUsersAction\n  | SetFailedMessagesAction;\n","export const SET_THREAD_TOPIC_NAME = 'SET_THREAD_TOPIC_NAME';\nexport const SET_THREAD_ID = 'SET_THREAD_ID';\n\nexport interface SetThreadTopicNameAction {\n  type: typeof SET_THREAD_TOPIC_NAME;\n  topicName: string;\n}\n\nexport interface SetThreadIdAction {\n  type: typeof SET_THREAD_ID;\n  threadId: string;\n}\n\nexport const setThreadTopicName = (topicName: string): SetThreadTopicNameAction => ({\n  type: SET_THREAD_TOPIC_NAME,\n  topicName\n});\n\nexport const setThreadId = (threadId: string): SetThreadIdAction => ({\n  type: SET_THREAD_ID,\n  threadId\n});\n\nexport type ThreadActionTypes = SetThreadTopicNameAction | SetThreadIdAction;\n","import { ChatParticipant } from '@azure/communication-chat';\n\nexport const SET_THREAD_MEMBERS = 'SET_THREAD_MEMBERS';\nexport const SET_THREAD_MEMBERS_ERROR = 'SET_THREAD_MEMBERS_ERROR';\nexport const SET_REMOVE_THREAD_MEMBER_ERROR = 'SET_REMOVE_THREAD_MEMBER_ERROR';\nexport const SET_ADD_THREAD_MEMBER_ERROR = 'SET_ADD_THREAD_MEMBER_ERROR';\nexport const SET_REMOVED_FROM_THREAD = 'SET_REMOVED_FROM_THREAD';\n\nexport interface SetThreadMembersAction {\n  type: typeof SET_THREAD_MEMBERS;\n  threadMembers: ChatParticipant[];\n}\n\nexport interface SetThreadMembersErrorAction {\n  type: typeof SET_THREAD_MEMBERS_ERROR;\n  error?: boolean;\n}\n\nexport interface SetRemovedFromThreadAction {\n  type: typeof SET_REMOVED_FROM_THREAD;\n  isRemoved: boolean;\n}\n\nexport const setThreadMembers = (threadMembers: ChatParticipant[]): SetThreadMembersAction => ({\n  type: SET_THREAD_MEMBERS,\n  threadMembers\n});\n\nexport const setThreadMembersError = (error: boolean): SetThreadMembersErrorAction => ({\n  type: SET_THREAD_MEMBERS_ERROR,\n  error\n});\n\nexport const setRemovedFromThread = (isRemoved: boolean): SetRemovedFromThreadAction => ({\n  type: SET_REMOVED_FROM_THREAD,\n  isRemoved\n});\n\nexport type ThreadMembersActionTypes =\n  | SetThreadMembersAction\n  | SetThreadMembersErrorAction\n  | SetRemovedFromThreadAction;\n","import { CallEndReason, Call, RemoteParticipant, CallAgent } from '@azure/communication-calling';\nimport { SelectionState } from '../RemoteStreamSelector';\n\nconst SET_CALL_AGENT = 'SET_CALL_AGENT';\nconst SET_GROUP = 'SET_GROUP';\nconst CALL_ADDED = 'CALL_ADDED';\nconst CALL_REMOVED = 'CALL_REMOVED';\nconst SET_CALL_STATE = 'SET_CALL_STATE';\nconst SET_PARTICIPANTS = 'SET_PARTICIPANTS';\nconst SET_DOMINANT_PARTICIPANTS = 'SET_DOMINANT_PARTICIPANTS';\n\ninterface SetCallAgentAction {\n  type: typeof SET_CALL_AGENT;\n  callAgent: CallAgent;\n}\n\ninterface SetGroupAction {\n  type: typeof SET_GROUP;\n  group: string;\n}\n\ninterface CallAddedAction {\n  type: typeof CALL_ADDED;\n  call: Call;\n}\n\ninterface CallRemovedAction {\n  type: typeof CALL_REMOVED;\n  call: Call | undefined;\n  incomingCallEndReason: CallEndReason | undefined;\n  groupCallEndReason: CallEndReason | undefined;\n}\n\ninterface SetCallStateAction {\n  type: typeof SET_CALL_STATE;\n  callState: string;\n}\n\ninterface SetParticipantsAction {\n  type: typeof SET_PARTICIPANTS;\n  remoteParticipants: RemoteParticipant[];\n}\n\ninterface SetDominantParticipantsAction {\n  type: typeof SET_DOMINANT_PARTICIPANTS;\n  dominantParticipants: SelectionState[];\n}\n\nexport const setCallAgent = (callAgent: CallAgent): SetCallAgentAction => {\n  return {\n    type: SET_CALL_AGENT,\n    callAgent\n  };\n};\n\nexport const setGroup = (groupId: string): SetGroupAction => {\n  return {\n    type: SET_GROUP,\n    group: groupId\n  };\n};\n\nexport const callAdded = (addedCall: Call): CallAddedAction => {\n  return {\n    type: CALL_ADDED,\n    call: addedCall\n  };\n};\n\nexport const callRemoved = (removedCall: Call, group: string): CallRemovedAction => {\n  return {\n    type: CALL_REMOVED,\n    call: undefined,\n    incomingCallEndReason: removedCall.direction === 'Incoming' ? removedCall.callEndReason : undefined,\n    groupCallEndReason: removedCall.direction !== 'Incoming' && !!group ? removedCall.callEndReason : undefined\n  };\n};\n\nexport const setCallState = (callState: string): SetCallStateAction => {\n  return {\n    type: SET_CALL_STATE,\n    callState\n  };\n};\n\nexport const setParticipants = (participants: RemoteParticipant[]): SetParticipantsAction => {\n  return {\n    type: SET_PARTICIPANTS,\n    remoteParticipants: participants\n  };\n};\n\nexport const setDominantParticipants = (selected: SelectionState[]): SetDominantParticipantsAction => {\n  return {\n    type: SET_DOMINANT_PARTICIPANTS,\n    dominantParticipants: selected\n  };\n};\n\nexport {\n  SET_CALL_AGENT,\n  SET_GROUP,\n  CALL_ADDED,\n  CALL_REMOVED,\n  SET_CALL_STATE,\n  SET_DOMINANT_PARTICIPANTS,\n  SET_PARTICIPANTS\n};\n\nexport type CallTypes =\n  | SetCallAgentAction\n  | SetParticipantsAction\n  | SetDominantParticipantsAction\n  | SetCallStateAction\n  | SetGroupAction\n  | CallAddedAction\n  | CallRemovedAction;\n","const SET_MIC = 'SET_MIC';\nconst SET_SHARE_SCREEN = 'SET_SHARE_SCREEN';\n\ninterface SetMicAction {\n  type: typeof SET_MIC;\n  mic: boolean;\n}\n\ninterface SetShareScreenAction {\n  type: typeof SET_SHARE_SCREEN;\n  shareScreen: boolean;\n}\n\nexport const setMic = (mic: boolean): SetMicAction => {\n  return {\n    type: SET_MIC,\n    mic\n  };\n};\n\nexport const setShareScreen = (shareScreen: boolean): SetShareScreenAction => {\n  return {\n    type: SET_SHARE_SCREEN,\n    shareScreen\n  };\n};\n\nexport { SET_MIC, SET_SHARE_SCREEN };\n\nexport type ControlTypes = SetMicAction | SetShareScreenAction;\n","import { AudioDeviceInfo, VideoDeviceInfo, DeviceManager } from '@azure/communication-calling';\n\nconst SET_DEVICE_MANAGER = 'SET_DEVICE_MANAGER';\nconst SET_AUDIO_DEVICE_INFO = 'SET_AUDIO_DEVICE_INFO';\nconst SET_VIDEO_DEVICE_INFO = 'SET_VIDEO_DEVICE_INFO';\nconst SET_AUDIO_DEVICE_LIST = 'SET_AUDIO_DEVICE_LIST';\nconst SET_VIDEO_DEVICE_LIST = 'SET_VIDEO_DEVICE_LIST';\nconst SET_MICROPHONE_PERMISSION = 'SET_MICROPHONE_PERMISSION';\nconst SET_CAMERA_PERMISSION = 'SET_CAMERA_PERMISSION';\n\ninterface SetDeviceManagerAction {\n  type: typeof SET_DEVICE_MANAGER;\n  deviceManager: DeviceManager;\n}\n\ninterface SetMicrophonePermission {\n  type: typeof SET_MICROPHONE_PERMISSION;\n  microphonePermission: string;\n}\n\ninterface SetCameraPermission {\n  type: typeof SET_CAMERA_PERMISSION;\n  cameraPermission: string;\n}\n\ninterface SetAudioDeviceAction {\n  type: typeof SET_AUDIO_DEVICE_INFO;\n  audioDeviceInfo: AudioDeviceInfo | undefined;\n}\n\ninterface SetVideoDeviceAction {\n  type: typeof SET_VIDEO_DEVICE_INFO;\n  videoDeviceInfo: VideoDeviceInfo | undefined;\n}\n\ninterface SetAudioDeviceListAction {\n  type: typeof SET_AUDIO_DEVICE_LIST;\n  audioDeviceList: AudioDeviceInfo[];\n}\n\ninterface SetVideoDeviceListAction {\n  type: typeof SET_VIDEO_DEVICE_LIST;\n  videoDeviceList: VideoDeviceInfo[];\n}\n\nexport const setDeviceManager = (deviceManager: DeviceManager): SetDeviceManagerAction => {\n  return {\n    type: SET_DEVICE_MANAGER,\n    deviceManager\n  };\n};\n\nexport const setMicrophonePermission = (microphonePermission: string): SetMicrophonePermission => {\n  return {\n    type: SET_MICROPHONE_PERMISSION,\n    microphonePermission\n  };\n};\n\nexport const setCameraPermission = (cameraPermission: string): SetCameraPermission => {\n  return {\n    type: SET_CAMERA_PERMISSION,\n    cameraPermission\n  };\n};\n\nexport const setAudioDeviceInfo = (audioDeviceInfo: AudioDeviceInfo | undefined): SetAudioDeviceAction => {\n  return {\n    type: SET_AUDIO_DEVICE_INFO,\n    audioDeviceInfo\n  };\n};\n\nexport const setVideoDeviceInfo = (videoDeviceInfo: VideoDeviceInfo | undefined): SetVideoDeviceAction => {\n  return {\n    type: SET_VIDEO_DEVICE_INFO,\n    videoDeviceInfo\n  };\n};\n\nexport const setAudioDeviceList = (audioDeviceList: AudioDeviceInfo[]): SetAudioDeviceListAction => {\n  return {\n    type: SET_AUDIO_DEVICE_LIST,\n    audioDeviceList\n  };\n};\n\nexport const setVideoDeviceList = (videoDeviceList: VideoDeviceInfo[]): SetVideoDeviceListAction => {\n  return {\n    type: SET_VIDEO_DEVICE_LIST,\n    videoDeviceList\n  };\n};\nexport {\n  SET_DEVICE_MANAGER,\n  SET_AUDIO_DEVICE_INFO,\n  SET_VIDEO_DEVICE_INFO,\n  SET_VIDEO_DEVICE_LIST,\n  SET_AUDIO_DEVICE_LIST,\n  SET_CAMERA_PERMISSION,\n  SET_MICROPHONE_PERMISSION\n};\n\nexport type DeviceTypes =\n  | SetDeviceManagerAction\n  | SetAudioDeviceAction\n  | SetVideoDeviceAction\n  | SetMicrophonePermission\n  | SetCameraPermission\n  | SetAudioDeviceListAction\n  | SetVideoDeviceListAction;\n","import { RemoteParticipant, RemoteVideoStream } from '@azure/communication-calling';\n\nconst ADD_SCREENSHARE_STREAM = 'ADD_SCREENSHARE_STREAM';\nconst REMOVE_SCREENSHARE_STREAM = 'REMOVE_SCREENSHARE_STREAM';\n\ninterface AddScreenShareStreamAction {\n  type: typeof ADD_SCREENSHARE_STREAM;\n  stream: RemoteVideoStream;\n  user: RemoteParticipant;\n}\n\ninterface RemoveScreenShareStreamAction {\n  type: typeof REMOVE_SCREENSHARE_STREAM;\n  stream: RemoteVideoStream;\n  user: RemoteParticipant;\n}\n\nexport const addScreenShareStream = (\n  stream: RemoteVideoStream,\n  user: RemoteParticipant\n): AddScreenShareStreamAction => {\n  return {\n    type: ADD_SCREENSHARE_STREAM,\n    stream,\n    user\n  };\n};\n\nexport const removeScreenShareStream = (\n  stream: RemoteVideoStream,\n  user: RemoteParticipant\n): RemoveScreenShareStreamAction => {\n  return {\n    type: REMOVE_SCREENSHARE_STREAM,\n    stream,\n    user\n  };\n};\n\nexport { ADD_SCREENSHARE_STREAM, REMOVE_SCREENSHARE_STREAM };\n\nexport type StreamTypes = AddScreenShareStreamAction | RemoveScreenShareStreamAction;\n","import { setDominantParticipants } from './actions/calls';\nimport { Dispatch } from 'redux';\nimport { RemoteParticipantState } from '@azure/communication-calling';\n\ninterface Event {\n  participantId: string;\n  timeStamp: number;\n  process: Function;\n}\n\nclass AudioChangedEvent implements Event {\n  participantId: string;\n  timeStamp: number;\n  isUnMuted = false;\n\n  constructor(participantId: string, isUnMuted: boolean) {\n    this.participantId = participantId;\n    this.isUnMuted = isUnMuted;\n    this.timeStamp = Date.now();\n  }\n\n  process(participant: SelectionState): void {\n    if (this.isUnMuted && !participant.isUnMuted) {\n      participant.lastUnMuted = this.timeStamp;\n    }\n    participant.isUnMuted = this.isUnMuted;\n  }\n}\n\nclass VideoChangedEvent implements Event {\n  participantId: string;\n  timeStamp: number;\n  isVideoOn = false;\n\n  constructor(participantId: string, isVideoOn: boolean) {\n    this.participantId = participantId;\n    this.isVideoOn = isVideoOn;\n    this.timeStamp = Date.now();\n  }\n\n  process(participant: SelectionState): void {\n    participant.isVideoOn = this.isVideoOn;\n  }\n}\n\nexport class SelectionState {\n  isVideoOn: boolean;\n  isUnMuted: boolean;\n  lastUnMuted: number;\n  participantId: string;\n  displayName: string;\n\n  constructor(participantId: string, displayName: string, isUnMuted = false, isVideoOn = false) {\n    this.participantId = participantId;\n    this.displayName = displayName;\n    this.isUnMuted = isUnMuted;\n    this.isVideoOn = isVideoOn;\n    this.lastUnMuted = -1;\n  }\n}\n\nexport default class RemoteStreamSelector {\n  private readonly dominantParticipantsCount: number;\n  private readonly dipatch: Dispatch;\n  private batchedCommands: Event[];\n  private remoteParticipants: Map<string, SelectionState>;\n  private static ProcessingDelayInSeconds = 2000;\n  private static Singleton: RemoteStreamSelector;\n\n  constructor(dominantParticipantsCount: number, dispatch: Dispatch) {\n    this.dominantParticipantsCount = dominantParticipantsCount;\n    this.dipatch = dispatch;\n    this.batchedCommands = [];\n    this.remoteParticipants = new Map();\n\n    setInterval(\n      () => this.batchedCommands.length > 0 && this.processCommands(),\n      RemoteStreamSelector.ProcessingDelayInSeconds\n    );\n  }\n\n  private compareFn = (a: SelectionState, b: SelectionState): number => {\n    if (a.isVideoOn === b.isVideoOn) {\n      if (a.isUnMuted === b.isUnMuted) return b.lastUnMuted - a.lastUnMuted;\n      return a.isUnMuted ? -1 : 1;\n    }\n    return a.isVideoOn ? -1 : 1;\n  };\n\n  public processCommands = (commands = this.batchedCommands): void => {\n    commands.forEach((command) => {\n      const participant = this.remoteParticipants.get(command.participantId);\n      if (!participant) {\n        console.error(`RemoteStreamSelector: Participant ${command.participantId} not found`);\n        return;\n      }\n      command.process(participant);\n    });\n    this.batchedCommands = [];\n\n    const sortedList = [...this.remoteParticipants.values()].sort(this.compareFn);\n    console.log('RemoteStreamSelector: Participants sorted list', sortedList);\n\n    this.dipatch(setDominantParticipants(sortedList.slice(0, this.dominantParticipantsCount)));\n  };\n\n  public participantAudioChanged = (participantId: string, isUnmuted: boolean): void => {\n    this.batchedCommands.push(new AudioChangedEvent(participantId, isUnmuted));\n  };\n\n  public participantVideoChanged = (participantId: string, isVideoOn: boolean): void => {\n    this.batchedCommands.push(new VideoChangedEvent(participantId, isVideoOn));\n  };\n\n  public participantStateChanged = (\n    participantId: string,\n    displayName: string,\n    state: RemoteParticipantState,\n    isUnMuted: boolean,\n    isVideoOn: boolean\n  ): void => {\n    switch (state) {\n      case 'Connecting':\n        this.remoteParticipants.set(\n          participantId,\n          new SelectionState(participantId, displayName, isUnMuted, isVideoOn)\n        );\n        break;\n      case 'Connected':\n        this.remoteParticipants.set(\n          participantId,\n          new SelectionState(participantId, displayName, isUnMuted, isVideoOn)\n        );\n        this.participantAudioChanged(participantId, isUnMuted);\n        this.participantVideoChanged(participantId, isVideoOn);\n        break;\n      case 'Disconnected':\n        this.remoteParticipants.delete(participantId);\n        this.processCommands(); // Force update Redux list with removed participant.\n        break;\n    }\n  };\n\n  public static getInstance = (dominantParticipantsCount: number, dispatch: Dispatch): RemoteStreamSelector =>\n    (RemoteStreamSelector.Singleton =\n      RemoteStreamSelector.Singleton ?? new RemoteStreamSelector(dominantParticipantsCount, dispatch));\n}\n","export class Constants {\n    static INCOMING = 'Incoming';\n    static RINGING = 'Ringing';\n    static CONNECTING = 'Connecting';\n    static CONNECTED = 'Connected';\n    static DEFAULT_IMG_WIDTH = 200;\n    static CROP_MEDIA = 'Crop';\n    static CONFIGURATION_LOCAL_VIDEO_PREVIEW_ID = 'ConfigurationLocalVideoPreview';\n    static LOCAL_VIDEO_PREVIEW_ID = 'LocalVideoPreview';\n    static MINI_HEADER_WINDOW_WIDTH = 360;\n    static DOMINANT_PARTICIPANTS_COUNT = 1; // The media gallery is design to work between 1 and 8 dominant participants inclusive\n  }\n","import { CallClient } from '@azure/communication-calling';\n\nconst SET_USERID = 'SET_USERID';\nconst SET_CALL_CLIENT = 'SET_CALL_CLIENT';\nconst SET_DISPLAY_NAME = 'SET_DISPLAY_NAME';\n\ninterface SetUserIdAction {\n  type: typeof SET_USERID;\n  userId: string;\n}\n\ninterface SetCallClient {\n  type: typeof SET_CALL_CLIENT;\n  callClient: CallClient;\n}\n\ninterface SetDisplayNameAction {\n  type: typeof SET_DISPLAY_NAME;\n  displayName: string;\n}\n\nexport const setUserId = (userId: string): SetUserIdAction => {\n  return {\n    type: SET_USERID,\n    userId\n  };\n};\n\nexport const setCallClient = (callClient: CallClient): SetCallClient => {\n  return {\n    type: SET_CALL_CLIENT,\n    callClient\n  };\n};\n\nexport const setDisplayName = (displayName: string): SetDisplayNameAction => {\n  return {\n    type: SET_DISPLAY_NAME,\n    displayName\n  };\n};\n\nexport { SET_USERID, SET_CALL_CLIENT, SET_DISPLAY_NAME };\n\nexport type SdkTypes = SetUserIdAction | SetCallClient | SetDisplayNameAction;\n","import { Stack, TextField, PrimaryButton, Icon, StackItem } from '@fluentui/react';\nimport React, { useEffect, useState, Dispatch } from 'react';\nimport { FocusZone, FocusZoneDirection } from 'office-ui-fabric-react/lib/FocusZone';\n\nimport { ENTER_KEY, GUID_FOR_INITIAL_TOPIC_NAME, MAXIMUM_LENGTH_OF_TOPIC } from '../../src/constants';\nimport InviteFooter from './InviteFooter';\nimport MemberItem from './MemberItem';\nimport { inputBoxTextStyle } from './styles/ConfigurationScreen.styles';\nimport {\n  memberListStyle,\n  settingsListStyle,\n  saveChatNameButtonStyle,\n  sidePanelContainerStyle,\n  textFieldIconStyle,\n  titleStyle,\n  topicWarningStyle,\n  emptyWarningStyle,\n  saveButtonTextStyle,\n  groupNameStyle,\n  groupNameInputBoxStyle,\n  groupNameInputBoxWarningStyle\n} from './styles/SidePanel.styles';\nimport { SidePanelDispatchProps, SidePanelProps } from '../containers/SidePanel';\nimport { CommunicationUserIdentifier } from '@azure/communication-common';\n\nexport enum SidePanelTypes {\n  None = 'none',\n  People = 'People',\n  Settings = 'Settings'\n}\n\ntype ChatSidePaneProps = {\n  selectedPane: SidePanelTypes;\n  setSelectedPane: Dispatch<SidePanelTypes>;\n};\n\nexport default (props: SidePanelProps & SidePanelDispatchProps & ChatSidePaneProps): JSX.Element => {\n  const [topicName, setTopicName] = useState('');\n  const [isEditingTopicName, setIsEditingTopicName] = useState(false);\n  const [isTopicNameOverflow, setTopicNameOverflow] = useState(false);\n  const [isSavingTopicName, setIsSavingTopicName] = useState(false);\n\n  const { chatClient, threadId } = props;\n\n  const onTopicNameTextChange = (event: any) => {\n    setIsEditingTopicName(true);\n    setTopicName(event.target.value);\n    if (event.target.value.length > MAXIMUM_LENGTH_OF_TOPIC) {\n      setTopicNameOverflow(true);\n    } else {\n      setTopicNameOverflow(false);\n    }\n  };\n\n  const onTopicNameSubmit = () => {\n    if (topicName.length > MAXIMUM_LENGTH_OF_TOPIC) return;\n    if (!chatClient) return;\n    if (!threadId) return;\n    props.updateThreadTopicName(chatClient, threadId, topicName, setIsSavingTopicName);\n    setIsSavingTopicName(true);\n    setIsEditingTopicName(false);\n    setTimeout(() => {\n      document.getElementById('focusButton')?.focus();\n    }, 100);\n  };\n\n  return (\n    <>\n      <Stack\n        verticalAlign=\"space-between\"\n        className={sidePanelContainerStyle(props.selectedPane === SidePanelTypes.People)}\n      >\n        {/* Title */}\n        <span className={titleStyle}>People</span>\n        {/* Member list */}\n        <StackItem className={memberListStyle}>\n          <FocusZone direction={FocusZoneDirection.vertical}>\n            {props.chatParticipants.map((person) => {\n              const id = (person.id as CommunicationUserIdentifier).communicationUserId;\n              return (\n                <MemberItem\n                  key={id}\n                  userId={id}\n                  avatar={props.users[id] === undefined ? '' : props.users[id].emoji}\n                  name={person.displayName as string}\n                  isYou={id === (props.identity as string)}\n                  removeThreadMemberByUserId={props.removeChatParticipantById}\n                />\n              );\n            })}\n          </FocusZone>\n        </StackItem>\n        {/* Invite link footer */}\n        <InviteFooter />\n      </Stack>\n      <Stack\n        verticalAlign=\"space-between\"\n        className={sidePanelContainerStyle(props.selectedPane === SidePanelTypes.Settings)}\n      >\n        {/* Title */}\n        <div className={titleStyle}>Settings</div>\n        <div className={settingsListStyle}>\n          {/* Change Chat Name */}\n          <div className={groupNameStyle}>Group Name</div>\n          <TextField\n            className={isTopicNameOverflow ? groupNameInputBoxWarningStyle : groupNameInputBoxStyle}\n            inputClassName={inputBoxTextStyle}\n            borderless={true}\n            defaultValue={props.topic === GUID_FOR_INITIAL_TOPIC_NAME ? '' : props.topic}\n            placeholder={props.existsTopicName ? undefined : 'Type a group name'}\n            autoComplete=\"off\"\n            onSubmit={onTopicNameSubmit}\n            onChange={onTopicNameTextChange}\n            onKeyUp={(ev) => {\n              if (ev.which === ENTER_KEY) {\n                onTopicNameSubmit();\n              }\n            }}\n          />\n          {(isTopicNameOverflow && <div className={topicWarningStyle}> Topic cannot be over 30 characters </div>) ||\n            (!isTopicNameOverflow && <div className={emptyWarningStyle} />)}\n          <PrimaryButton\n            id=\"editThreadTopicButton\"\n            className={saveChatNameButtonStyle}\n            onClick={(e: any) => onTopicNameSubmit()}\n            disabled={isSavingTopicName}\n          >\n            <Icon iconName=\"Save\" className={textFieldIconStyle} />\n            <div className={saveButtonTextStyle}>{isSavingTopicName ? 'Saving...' : 'Save'}</div>\n          </PrimaryButton>\n        </div>\n      </Stack>\n    </>\n  );\n};\n","import { Dispatch } from 'redux';\nimport React from 'react';\n\nimport {\n  MINIMUM_TYPING_INTERVAL_IN_MILLISECONDS,\n  MAXIMUM_INT64,\n  PAGE_SIZE,\n  INITIAL_MESSAGES_SIZE,\n} from '../constants';\nimport { setChatClient, setContosoUser, setContosoUsers } from './actions/ContosoClientAction';\nimport { setReceipts } from './actions/ConversationsAction';\nimport { setMessages, setTypingNotifications, setTypingUsers, setFailedMessages } from './actions/MessagesAction';\nimport { setThreadId, setThreadTopicName } from './actions/ThreadAction';\nimport { setThreadMembers, setThreadMembersError, setRemovedFromThread } from './actions/ThreadMembersAction';\nimport { User } from './reducers/ContosoClientReducers';\nimport { State } from './reducers/index';\nimport { ClientChatMessage } from './reducers/MessagesReducer';\nimport {\n  compareMessages,\n  convertToClientChatMessage,\n  createNewClientChatMessage,\n  isUserMatchingIdentity,\n  utils,\n} from '../utils/utils';\n\nimport {\n  ChatClient,\n  ChatThreadClient,\n  SendReadReceiptRequest,\n  ChatMessageReadReceipt,\n  ChatMessage,\n  ChatParticipant\n} from '@azure/communication-chat';\nimport {\n  AzureCommunicationTokenCredential,\n  CommunicationTokenRefreshOptions,\n  CommunicationUserIdentifier\n} from '@azure/communication-common';\nimport {\n  ChatThreadPropertiesUpdatedEvent,\n  CommunicationUserKind,\n  ParticipantsAddedEvent,\n  ParticipantsRemovedEvent\n} from '@azure/communication-signaling';\n\nimport {\n  AudioDeviceInfo,\n  Call,\n  CommunicationServicesError,\n  GroupCallLocator,\n  JoinCallOptions,\n  DeviceManager,\n  DeviceAccess,\n  RemoteParticipant,\n  VideoDeviceInfo,\n  CallAgent,\n  CallClient,\n  HangUpOptions,\n  CallEndReason\n} from '@azure/communication-calling';\nimport { callAdded, callRemoved, setCallState, setParticipants, setCallAgent } from './actions/calls';\nimport { setMic, setShareScreen } from './actions/controls';\nimport {\n  setAudioDeviceInfo,\n  setAudioDeviceList,\n  setCameraPermission,\n  setMicrophonePermission,\n  setVideoDeviceInfo,\n  setVideoDeviceList,\n  setDeviceManager\n} from './actions/devices';\nimport { addScreenShareStream, removeScreenShareStream } from './actions/streams';\nimport { setLogLevel } from '@azure/logger';\nimport RemoteStreamSelector from './RemoteStreamSelector';\nimport { Constants } from './constants';\nimport { setCallClient, setUserId } from './actions/sdk';\n\n// This function sets up the user to chat with the thread\nconst addUserToThread = (displayName: string, emoji: string) => async (dispatch: Dispatch, getState: () => State) => {\n  let state: State = getState();\n  if (state.thread.threadId === undefined) {\n    console.error('Thread Id not created yet');\n    return;\n  }\n  let threadId: string = state.thread.threadId;\n\n  // get environment url from server\n  let environmentUrl = await getEnvironmentUrl();\n\n  if (environmentUrl === undefined) {\n    console.error('unable to get environment url from server');\n    return;\n  }\n  // create our user\n  let userToken = await getToken();\n\n  if (userToken === undefined) {\n    console.error('unable to get a token');\n    return;\n  }\n\n  const user = userToken.user as CommunicationUserIdentifier;\n\n  let options: CommunicationTokenRefreshOptions = {\n    token: userToken.token,\n    tokenRefresher: () => refreshTokenAsync(user.communicationUserId),\n    refreshProactively: true\n  };\n\n  let userAccessTokenCredentialNew = new AzureCommunicationTokenCredential(options);\n  let chatClient = new ChatClient(environmentUrl, userAccessTokenCredentialNew);\n\n  // set emoji for the user\n  setEmoji(user.communicationUserId, emoji);\n\n  // subscribe for message, typing indicator, and read receipt\n  let chatThreadClient = await chatClient.getChatThreadClient(threadId);\n  subscribeForMessage(chatClient, dispatch, getState);\n  subscribeForTypingIndicator(chatClient, dispatch);\n  subscribeForReadReceipt(chatClient, chatThreadClient, dispatch);\n  subscribeForChatParticipants(chatClient, user.communicationUserId, dispatch, getState);\n  subscribeForTopicUpdated(chatClient, dispatch, getState);\n  dispatch(setThreadId(threadId));\n  dispatch(setContosoUser(user.communicationUserId, userToken.token, displayName));\n  dispatch(setChatClient(chatClient));\n\n  await addThreadMemberHelper(\n    threadId,\n    {\n      identity: user.communicationUserId,\n      token: userToken.token,\n      displayName: displayName,\n      memberRole: 'User'\n    },\n    dispatch\n  );\n\n  await getThreadInformation(chatClient, dispatch, getState);\n  await getMessages(chatClient, dispatch, getState);\n};\n\nconst subscribeForTypingIndicator = async (chatClient: ChatClient, dispatch: Dispatch) => {\n  await chatClient.startRealtimeNotifications();\n  chatClient.on('typingIndicatorReceived', async (event) => {\n    const fromId = (event.sender as CommunicationUserKind).communicationUserId;\n    const typingNotification = {\n      from: fromId,\n      originalArrivalTime: event.receivedOn,\n      recipientId: (event.recipient as CommunicationUserKind).communicationUserId,\n      threadId: event.threadId,\n      version: event.version\n    };\n    dispatch(setTypingNotifications(fromId, typingNotification));\n  });\n};\n\nconst subscribeForMessage = async (chatClient: ChatClient, dispatch: Dispatch, getState: () => State) => {\n  await chatClient.startRealtimeNotifications();\n  chatClient.on('chatMessageReceived', async (event) => {\n    let state: State = getState();\n    let messages: ClientChatMessage[] = state.chat.messages !== undefined ? state.chat.messages : [];\n    if (!isUserMatchingIdentity(event.sender, state.contosoClient.user.identity)) {\n      const clientChatMessage = {\n        sender: event.sender,\n        id: event.id,\n        senderDisplayName: event.senderDisplayName,\n        createdOn: event.createdOn,\n        content: { message: event.message }\n      };\n\n      messages.push(clientChatMessage);\n      dispatch(setMessages(messages.sort(compareMessages)));\n    }\n  });\n};\n\nconst subscribeForReadReceipt = async (\n  chatClient: ChatClient,\n  chatThreadClient: ChatThreadClient,\n  dispatch: Dispatch\n) => {\n  await chatClient.startRealtimeNotifications();\n  chatClient.on('readReceiptReceived', async (event) => {\n    let receipts: ChatMessageReadReceipt[] = [];\n    for await (let page of chatThreadClient.listReadReceipts().byPage()) {\n      for (const receipt of page) {\n        receipts.push(receipt);\n      }\n    }\n    dispatch(setReceipts(receipts));\n  });\n};\n\nconst subscribeForChatParticipants = async (\n  chatClient: ChatClient,\n  identity: string,\n  dispatch: Dispatch,\n  getState: () => State\n) => {\n  chatClient.on('participantsRemoved', async (event: ParticipantsRemovedEvent) => {\n    const state = getState();\n    let participants: ChatParticipant[] = [];\n    for (let chatParticipant of event.participantsRemoved) {\n      // if you are in the list, remove yourself from the chat\n      if (isUserMatchingIdentity(chatParticipant.id, identity)) {\n        dispatch(setRemovedFromThread(true));\n        return;\n      }\n    }\n\n    const originalParticipants = state.threadMembers.threadMembers;\n    for (var i = 0; i < originalParticipants.length; i++) {\n      const participantId = (originalParticipants[i].id as CommunicationUserIdentifier).communicationUserId;\n      if (\n        event.participantsRemoved.filter((chatParticipant) => isUserMatchingIdentity(chatParticipant.id, participantId))\n          .length === 0\n      ) {\n        participants.push(originalParticipants[i]);\n      }\n    }\n\n    dispatch(setThreadMembers(participants));\n  });\n\n  chatClient.on('participantsAdded', async (event: ParticipantsAddedEvent) => {\n    const state = getState();\n    let participants: ChatParticipant[] = [...state.threadMembers.threadMembers];\n\n    // there is a chance that the participant added is you and so there is a chance that you can come in as a\n    // new participant as well\n    const addedParticipants = event.participantsAdded.map((chatParticipant: ChatParticipant) => {\n      return {\n        id: chatParticipant.id,\n        displayName: chatParticipant.displayName,\n        shareHistoryTime: new Date(chatParticipant?.shareHistoryTime || new Date())\n      };\n    });\n\n    // add participants not in the list\n    for (var j = 0; j < event.participantsAdded.length; j++) {\n      const addedParticipant = event.participantsAdded[j];\n      const id = (addedParticipant.id as CommunicationUserIdentifier).communicationUserId;\n      if (\n        participants.filter((participant: ChatParticipant) => isUserMatchingIdentity(participant.id, id)).length === 0\n      ) {\n        participants.push(addedParticipant);\n      }\n    }\n\n    // also make sure we get the emojis for the new participants\n    let users = Object.assign({}, state.contosoClient.users);\n    for (var i = 0; i < addedParticipants.length; i++) {\n      var threadMember = addedParticipants[i];\n      var identity = (threadMember.id as CommunicationUserIdentifier).communicationUserId;\n      var user = users[identity];\n      if (user == null) {\n        var serverUser = await getEmoji(identity);\n        if (serverUser !== undefined) {\n          users[identity] = { emoji: serverUser.emoji };\n        }\n      }\n    }\n\n    dispatch(setContosoUsers(users));\n    dispatch(setThreadMembers(participants));\n  });\n};\n\nconst subscribeForTopicUpdated = async (chatClient: ChatClient, dispatch: Dispatch, getState: () => State) => {\n  chatClient.on('chatThreadPropertiesUpdated', async (e: ChatThreadPropertiesUpdatedEvent) => {\n    const state = getState();\n    let threadId = state.thread.threadId;\n\n    if (!threadId) {\n      console.error('no threadId set');\n      return;\n    }\n\n    dispatch(setThreadTopicName(e.properties.topic));\n  });\n};\n\nconst sendTypingNotification = () => async (dispatch: Dispatch, getState: () => State) => {\n  let state: State = getState();\n  let chatClient = state.contosoClient.chatClient;\n  if (chatClient === undefined) {\n    console.error('Chat Client not created yet');\n    return;\n  }\n  let threadId = state.thread.threadId;\n  if (threadId === undefined) {\n    console.error('Thread Id not created yet');\n    return;\n  }\n  await sendTypingNotificationHelper(await chatClient.getChatThreadClient(threadId));\n};\n\nconst updateTypingUsers = () => async (dispatch: Dispatch, getState: () => State) => {\n  let typingUsers = [];\n  let state: State = getState();\n  let typingNotifications = state.chat.typingNotifications;\n  for (let id in typingNotifications) {\n    let typingNotification = typingNotifications[id];\n    if (!typingNotification.originalArrivalTime) {\n      continue;\n    }\n    if (shouldDisplayTyping(typingNotification.originalArrivalTime)) {\n      let threadMember = state.threadMembers.threadMembers.find((threadMember) =>\n        isUserMatchingIdentity(threadMember.id, id)\n      );\n      if (threadMember) {\n        typingUsers.push(threadMember);\n      }\n    }\n  }\n  dispatch(setTypingUsers(typingUsers));\n};\n\nconst shouldDisplayTyping = (lastReceivedTypingEventDate: number) => {\n  let currentDate = new Date();\n  let timeSinceLastTypingNotificationMs = currentDate.getTime() - lastReceivedTypingEventDate;\n  return timeSinceLastTypingNotificationMs <= MINIMUM_TYPING_INTERVAL_IN_MILLISECONDS;\n};\n\nconst sendMessage = (messageContent: string) => async (dispatch: Dispatch, getState: () => State) => {\n  let state: State = getState();\n  let chatClient = state.contosoClient.chatClient;\n  if (chatClient === undefined) {\n    console.error('Chat Client not created yet');\n    return;\n  }\n  let threadId = state.thread.threadId;\n  if (threadId === undefined) {\n    console.error('Thread Id not created yet');\n    return;\n  }\n  let displayName = state.contosoClient.user.displayName;\n  let userId = state.contosoClient.user.identity;\n\n  // we use this client message id to have a local id for messages\n  // if we fail to send the message we'll at least be able to show that the message failed to send on the client\n  let clientMessageId = (Math.floor(Math.random() * MAXIMUM_INT64) + 1).toString(); //generate a random unsigned Int64 number\n  let newMessage = createNewClientChatMessage(userId, displayName, clientMessageId, messageContent);\n\n  let messages = getState().chat.messages;\n  messages.push(newMessage);\n  dispatch(setMessages(messages));\n\n  await sendMessageHelper(\n    await chatClient.getChatThreadClient(threadId),\n    messageContent,\n    displayName,\n    clientMessageId,\n    dispatch,\n    getState\n  );\n};\n\nconst isValidThread = (threadId: string) => async (dispatch: Dispatch) => {\n  try {\n    let validationRequestOptions = { method: 'GET' };\n    let validationResponse = await fetch('/isValidThread/' + threadId, validationRequestOptions);\n    if (validationResponse.status === 200) {\n      dispatch(setThreadId(threadId));\n      return true;\n    } else {\n      return false;\n    }\n  } catch (error) {\n    console.error('Failed at getting isThreadIdValid, Error: ', error);\n  }\n};\n\nconst getMessages = async (chatClient: ChatClient, dispatch: Dispatch, getState: () => State) => {\n  let state: State = getState();\n  if (chatClient === undefined) {\n    console.error('Chat Client not created yet');\n    return;\n  }\n  let threadId = state.thread.threadId;\n  if (threadId === undefined) {\n    console.error('Thread Id not created yet');\n    return;\n  }\n  let messages = await getMessagesHelper(await chatClient.getChatThreadClient(threadId));\n  if (messages === undefined) {\n    console.error('unable to get messages');\n    return;\n  }\n\n  const reversedClientChatMessages: ClientChatMessage[] = messages\n    .map((message) => convertToClientChatMessage(message))\n    .reverse();\n\n  return dispatch(setMessages(reversedClientChatMessages));\n};\n\nconst createThread = async () => {\n  let threadId = await createThreadHelper();\n  if (threadId !== null) {\n    window.location.href += `?threadId=${threadId}`;\n  } else {\n    console.error('unable to generate a new chat thread');\n  }\n};\n\nconst addThreadMember = () => async (dispatch: Dispatch, getState: () => State) => {\n  let state: State = getState();\n  let user = state.contosoClient.user;\n  let threadId = state.thread.threadId;\n\n  if (threadId === undefined) {\n    console.error('Thread Id not created yet');\n    return;\n  }\n  await addThreadMemberHelper(\n    threadId,\n    {\n      identity: user.identity,\n      token: user.token,\n      displayName: user.displayName,\n      memberRole: 'User'\n    },\n    dispatch\n  );\n};\n\nconst removeThreadMemberByUserId = (userId: string) => async (dispatch: Dispatch, getState: () => State) => {\n  let state: State = getState();\n  let chatClient = state.contosoClient.chatClient;\n  let threadId = state.thread.threadId;\n  if (chatClient === undefined) {\n    console.error(\"Chat client doesn't created yet\");\n    return;\n  }\n  if (threadId === undefined) {\n    console.error('Thread Id not created yet');\n    return;\n  }\n  let chatThreadClient = await chatClient.getChatThreadClient(threadId);\n  try {\n    await chatThreadClient.removeParticipant({\n      communicationUserId: userId\n    });\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nconst getThreadMembers = () => async (dispatch: Dispatch, getState: () => State) => {\n  let state: State = getState();\n  let chatClient = state.contosoClient.chatClient;\n  if (chatClient === undefined) {\n    console.error('Chat Client not created yet');\n    return;\n  }\n  let threadId = state.thread.threadId;\n  if (threadId === undefined) {\n    console.error('Thread Id not created yet');\n    return;\n  }\n  let chatThreadClient = await chatClient.getChatThreadClient(threadId);\n\n  try {\n    let threadMembers = [];\n    for await (let page of chatThreadClient.listParticipants().byPage()) {\n      for (const threadMember of page) {\n        threadMembers.push(threadMember);\n      }\n    }\n    dispatch(setThreadMembers(threadMembers));\n  } catch (error) {\n    console.error('Failed at getting members, Error: ', error);\n    dispatch(setThreadMembersError(true));\n  }\n};\n\n// We want to grab everything about the chat thread that has occured before we register for events.\n// We care about pre-existing messages, the chat topic, and the participants in this chat\nconst getThreadInformation = async (chatClient: ChatClient, dispatch: Dispatch, getState: () => State) => {\n  let state: State = getState();\n  if (chatClient === undefined) {\n    console.error('Chat Client not created yet');\n    return;\n  }\n  let threadId = state.thread.threadId;\n  if (threadId === undefined) {\n    console.error('Thread Id not created yet');\n    return;\n  }\n\n  let chatThreadClient;\n  let iteratableParticipants;\n\n  try {\n    chatThreadClient = chatClient.getChatThreadClient(threadId);\n    iteratableParticipants = chatThreadClient.listParticipants();\n  } catch (error) {\n    console.error(error);\n    dispatch(setThreadMembersError(true));\n  }\n\n  let chatParticipants = [];\n  // This is just to get all of the members in a chat. This is not performance as we're not using paging\n  if (!iteratableParticipants) {\n    console.error('unable to resolve chat participant iterator');\n    return; // really we need to alert that there was an error?\n  }\n\n  for await (const page of iteratableParticipants.byPage()) {\n    for (const chatParticipant of page) {\n      chatParticipants.push(chatParticipant);\n    }\n  }\n\n  if (chatParticipants.length === 0) {\n    console.error('unable to get members in the thread');\n    return;\n  }\n\n  // remove undefined display name chat participants\n  const validChatParticipants = chatParticipants.filter(\n    (chatParticipant) => chatParticipant.displayName !== undefined && chatParticipant.id !== undefined\n  );\n\n  // get the emojis for the new participants\n  let users = state.contosoClient.users;\n  for (var i = 0; i < chatParticipants.length; i++) {\n    var threadMember = chatParticipants[i];\n    var identity = (threadMember.id as CommunicationUserIdentifier).communicationUserId;\n    var user = users[identity];\n    if (user == null) {\n      var serverUser = await getEmoji(identity);\n      if (serverUser !== undefined) {\n        users[identity] = { emoji: serverUser.emoji };\n      }\n    }\n  }\n\n  const properties = await chatThreadClient?.getProperties();\n\n  if (!properties) {\n    console.error('no chat thread properties');\n    return;\n  }\n\n  dispatch(setThreadId(threadId));\n  dispatch(setThreadTopicName(properties.topic));\n  dispatch(setContosoUsers(users));\n  dispatch(setThreadMembers(validChatParticipants));\n};\n\nconst updateThreadTopicName = async (\n  chatClient: ChatClient,\n  threadId: string,\n  topicName: string,\n  setIsSavingTopicName: React.Dispatch<boolean>\n) => {\n  const chatThreadClient = await chatClient.getChatThreadClient(threadId);\n  updateThreadTopicNameHelper(chatThreadClient, topicName, setIsSavingTopicName);\n};\n\n// Thread Helper\nconst createThreadHelper = async () => {\n  try {\n    let createThreadRequestOptions = { method: 'POST' };\n    let createThreadResponse = await fetch('/createThread', createThreadRequestOptions);\n    let threadId = await createThreadResponse.text();\n    return threadId;\n  } catch (error) {\n    console.error('Failed at creating thread, Error: ', error);\n  }\n};\n\nconst updateThreadTopicNameHelper = async (\n  chatThreadClient: ChatThreadClient,\n  topicName: string,\n  setIsSavingTopicName: React.Dispatch<boolean>\n) => {\n  try {\n    await chatThreadClient.updateTopic(topicName);\n    setIsSavingTopicName(false);\n  } catch (error) {\n    console.error('Failed at updating thread property, Error: ', error);\n  }\n};\n\n// Thread Member Helper\nconst addThreadMemberHelper = async (threadId: string, user: User, dispatch: Dispatch) => {\n  try {\n    let body = {\n      id: user.identity,\n      displayName: user.displayName\n    };\n    let addMemberRequestOptions = {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(body)\n    };\n    await fetch('/addUser/' + threadId, addMemberRequestOptions);\n  } catch (error) {\n    console.error('Failed at adding thread member, Error: ', error);\n  }\n};\n\n// Message Helper\nconst sendMessageHelper = async (\n  chatThreadClient: ChatThreadClient,\n  messageContent: string,\n  displayName: string,\n  clientMessageId: string,\n  dispatch: Dispatch,\n  getState: () => State\n) => {\n  // for real time messages we want to store it locally and render it and then sync it with the server message later\n  // 1. send the message\n  // 2. cache the message locally using the message.id\n  // 3. when we get the server synced message we match with the message.id\n  try {\n    const messageResult = await chatThreadClient.sendMessage(\n      { content: messageContent },\n      { senderDisplayName: displayName }\n    );\n    const message: ChatMessage = await chatThreadClient.getMessage(messageResult.id);\n    updateMessagesArray(dispatch, getState, convertToClientChatMessage(message, clientMessageId));\n  } catch (error) {\n    console.error('Failed at getting messages, Error: ', error);\n    let failedMessages = getState().chat.failedMessages;\n    failedMessages.push(clientMessageId);\n    setFailedMessages(failedMessages);\n\n    const message = getState().chat.messages.filter((message) => message.clientMessageId === clientMessageId)[0];\n    message.failed = true;\n    updateMessagesArray(dispatch, getState, message);\n  }\n};\n\n// Merge our local messages with server synced messages\nconst updateMessagesArray = async (dispatch: Dispatch, getState: () => State, newMessage: ClientChatMessage) => {\n  let state: State = getState();\n  let messages: ClientChatMessage[] = state.chat.messages !== undefined ? state.chat.messages : [];\n\n  // the message id is what we we get from the server when it is synced. There will be other server attributes\n  // on the message but the id should be consistent.\n  messages = messages.map((message: ClientChatMessage) => {\n    return message.clientMessageId === newMessage.clientMessageId ? Object.assign({}, message, newMessage) : message;\n  });\n  dispatch(setMessages(messages.sort(compareMessages)));\n};\n\nconst getMessagesHelper = async (chatThreadClient: ChatThreadClient): Promise<ChatMessage[] | undefined> => {\n  try {\n    let messages: ChatMessage[] = [];\n    let getMessagesResponse = await chatThreadClient.listMessages({\n      maxPageSize: PAGE_SIZE\n    });\n\n    let messages_temp = [];\n\n    for await (let page of getMessagesResponse.byPage()) {\n      for (const message of page) {\n        messages_temp.push(message);\n      }\n    }\n\n    while (true) {\n      if (messages_temp === undefined) {\n        console.error('Unable to get messages from server');\n        return;\n      }\n\n      // filter and only return top 100 text messages\n      messages.push(...messages_temp.filter((message) => message.type === 'text'));\n      if (messages.length >= INITIAL_MESSAGES_SIZE) {\n        return messages.slice(0, INITIAL_MESSAGES_SIZE);\n      }\n      // if there is no more messages\n      break;\n    }\n\n    return messages.slice(0, INITIAL_MESSAGES_SIZE);\n  } catch (error) {\n    console.error('Failed at getting messages, Error: ', error);\n  }\n};\n\n// Typing Notification Helper\nconst sendTypingNotificationHelper = async (chatThreadClient: ChatThreadClient) => {\n  try {\n    await chatThreadClient.sendTypingNotification();\n  } catch (error) {\n    console.error('Failed at sending typing notification, Error: ', error);\n  }\n};\n\nconst getEnvironmentUrl = async () => {\n  try {\n    let getRequestOptions = {\n      method: 'GET'\n    };\n    let response = await fetch('/getEnvironmentUrl', getRequestOptions);\n    return response.text().then((environmentUrl) => environmentUrl);\n  } catch (error) {\n    console.error('Failed at getting environment url, Error: ', error);\n  }\n};\n\n// Token Helper\nexport const getToken = async () => {\n  try {\n    let getTokenRequestOptions = {\n      method: 'POST'\n    };\n    let getTokenResponse = await fetch('/token', getTokenRequestOptions);\n    return getTokenResponse.json().then((_responseJson) => _responseJson);\n  } catch (error) {\n    console.error('Failed at getting token, Error: ', error);\n  }\n};\n\nconst refreshTokenAsync = async (userIdentity: string): Promise<string> => {\n  return new Promise<string>((resolve, reject) => {\n    return fetch('/refreshToken/' + userIdentity).then(\n      (response) => {\n        if (response.ok) {\n          resolve(response.json().then((json) => json.token));\n        } else {\n          reject(new Error('error'));\n        }\n      },\n      (error) => {\n        reject(new Error(error.message));\n      }\n    );\n  });\n};\n\nconst setEmoji = async (userId: string, emoji: string) => {\n  try {\n    let getTokenRequestOptions = {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ Emoji: emoji })\n    };\n    await (await fetch('/userConfig/' + userId, getTokenRequestOptions)).json;\n  } catch (error) {\n    console.error('Failed at setting emoji, Error: ', error);\n  }\n};\n\nconst getEmoji = async (userId: string) => {\n  try {\n    let getTokenRequestOptions = {\n      headers: { 'Content-Type': 'application/json' },\n      method: 'GET'\n    };\n    return await (await fetch('/userConfig/' + userId, getTokenRequestOptions)).json();\n  } catch (error) {\n    console.error('Failed at getting emoji, Error: ', error);\n  }\n};\n\nconst sendReadReceipt = (messageId: string) => async (dispatch: Dispatch, getState: () => State) => {\n  // This is sent when we get focus to this tab and see this message\n  let state: State = getState();\n  let chatClient = state.contosoClient.chatClient;\n  if (chatClient === undefined) {\n    console.error('Chat Client not created yet');\n    return;\n  }\n  let threadId = state.thread.threadId;\n  if (threadId === undefined) {\n    console.error('Thread Id not created yet');\n    return;\n  }\n  await sendReadReceiptHelper(await chatClient.getChatThreadClient(threadId), messageId);\n};\n\nconst sendReadReceiptHelper = async (chatThreadClient: ChatThreadClient, messageId: string) => {\n  let postReadReceiptRequest: SendReadReceiptRequest = {\n    chatMessageId: messageId\n  };\n  await chatThreadClient.sendReadReceipt(postReadReceiptRequest);\n};\n\nexport const setMicrophone = (mic: boolean) => {\n  return async (dispatch: Dispatch, getState: () => State): Promise<void> => {\n    const state = getState();\n\n    if (state === undefined || state.calls.call === undefined) {\n      console.error('state or state.controls.mic is null');\n      return;\n    }\n\n    try {\n      if (!state.controls.mic) {\n        await state.calls.call.unmute();\n      } else {\n        await state.calls.call.mute();\n      }\n\n      dispatch(setMic(mic));\n    } catch (e) {\n      console.error(e);\n    }\n  };\n};\n\nexport const setShareUnshareScreen = (shareScreen: boolean) => {\n  return async (dispatch: Dispatch, getState: () => State): Promise<void> => {\n    const state = getState();\n\n    if (state === undefined || state.calls.call === undefined) {\n      console.error('state or state.controls.shareScreen is null');\n      return;\n    }\n\n    try {\n      if (!state.controls.shareScreen) {\n        await state.calls.call.startScreenSharing();\n      } else {\n        await state.calls.call.stopScreenSharing();\n      }\n\n      dispatch(setShareScreen(shareScreen));\n    } catch (e) {\n      console.error(e);\n    }\n  };\n};\n\nconst subscribeToParticipant = (participant: RemoteParticipant, call: Call, dispatch: Dispatch): void => {\n  const remoteStreamSelector = RemoteStreamSelector.getInstance(Constants.DOMINANT_PARTICIPANTS_COUNT, dispatch);\n\n  participant.on('stateChanged', () => {\n    remoteStreamSelector.participantStateChanged(\n      utils.getId(participant.identifier),\n      participant.displayName ?? '',\n      participant.state,\n      !participant.isMuted,\n      participant.videoStreams[0].isAvailable\n    );\n    dispatch(setParticipants([...call.remoteParticipants.values()]));\n  });\n\n  participant.on('isMutedChanged', () => {\n    remoteStreamSelector.participantAudioChanged(utils.getId(participant.identifier), !participant.isMuted);\n  });\n\n  participant.on('isSpeakingChanged', () => {\n    dispatch(setParticipants([...call.remoteParticipants.values()]));\n  });\n\n  participant.on('videoStreamsUpdated', (e): void => {\n    e.added.forEach((addedStream) => {\n      if (addedStream.mediaStreamType === 'ScreenSharing') {\n        addedStream.on('isAvailableChanged', () => {\n          if (addedStream.isAvailable) {\n            dispatch(addScreenShareStream(addedStream, participant));\n          } else {\n            dispatch(removeScreenShareStream(addedStream, participant));\n          }\n        });\n\n        if (addedStream.isAvailable) {\n          dispatch(addScreenShareStream(addedStream, participant));\n        }\n      } else if (addedStream.mediaStreamType === 'Video') {\n        addedStream.on('isAvailableChanged', () => {\n          remoteStreamSelector.participantVideoChanged(utils.getId(participant.identifier), addedStream.isAvailable);\n        });\n      }\n    });\n    dispatch(setParticipants([...call.remoteParticipants.values()]));\n  });\n};\n\nconst updateAudioDevices = async (\n  deviceManager: DeviceManager,\n  dispatch: Dispatch,\n  getState: () => State\n): Promise<void> => {\n  const microphoneList: AudioDeviceInfo[] = await deviceManager.getMicrophones();\n  dispatch(setAudioDeviceList(microphoneList));\n\n  const state = getState();\n  if (state.devices.audioDeviceInfo === undefined && microphoneList.length > 0) {\n    dispatch(setAudioDeviceInfo(microphoneList[0]));\n    deviceManager.selectMicrophone(microphoneList[0]);\n  } else if (\n    state.devices.audioDeviceInfo &&\n    !utils.isSelectedAudioDeviceInList(state.devices.audioDeviceInfo, microphoneList)\n  ) {\n    deviceManager.selectMicrophone(state.devices.audioDeviceInfo);\n  }\n};\n\nconst updateVideoDevices = async (\n  deviceManager: DeviceManager,\n  dispatch: Dispatch,\n  getState: () => State\n): Promise<void> => {\n  const cameraList: VideoDeviceInfo[] = await deviceManager.getCameras();\n  dispatch(setVideoDeviceList(cameraList));\n\n  const state = getState();\n  if (state.devices.videoDeviceInfo === undefined) {\n    dispatch(setVideoDeviceInfo(cameraList[0]));\n  } else if (\n    state.devices.videoDeviceInfo &&\n    !utils.isSelectedVideoDeviceInList(state.devices.videoDeviceInfo, cameraList)\n  ) {\n    dispatch(setVideoDeviceInfo(state.devices.videoDeviceInfo));\n  }\n};\n\nconst subscribeToDeviceManager = async (\n  deviceManager: DeviceManager,\n  dispatch: Dispatch,\n  getState: () => State\n): Promise<void> => {\n  // listen for any new events\n  deviceManager.on('videoDevicesUpdated', async () => {\n    updateVideoDevices(deviceManager, dispatch, getState);\n  });\n\n  deviceManager.on('audioDevicesUpdated', async () => {\n    updateAudioDevices(deviceManager, dispatch, getState);\n  });\n\n  deviceManager.askDevicePermission({ audio: true, video: true }).then((e: DeviceAccess) => {\n    if (e.audio !== undefined) {\n      if (e.audio) {\n        dispatch(setMicrophonePermission('Granted'));\n\n        updateAudioDevices(deviceManager, dispatch, getState);\n      } else {\n        dispatch(setMicrophonePermission('Denied'));\n      }\n    }\n\n    if (e.video !== undefined) {\n      if (e.video) {\n        dispatch(setCameraPermission('Granted'));\n        updateVideoDevices(deviceManager, dispatch, getState);\n      } else {\n        dispatch(setCameraPermission('Denied'));\n      }\n    }\n  });\n};\n\nexport const updateDevices = () => {\n  return async (dispatch: Dispatch, getState: () => State): Promise<void> => {\n    const state = getState();\n    const deviceManager = state.devices.deviceManager;\n\n    if (deviceManager == null) {\n      console.error('no device manager available');\n      return;\n    }\n\n    const cameraList: VideoDeviceInfo[] = await deviceManager.getCameras();\n\n    dispatch(setVideoDeviceList(cameraList));\n\n    const microphoneList: AudioDeviceInfo[] = await deviceManager.getMicrophones();\n\n    dispatch(setAudioDeviceList(microphoneList));\n  };\n};\n\nexport const registerToCallAgent = (\n  userId: string,\n  callAgent: CallAgent,\n  callEndedHandler: (reason: CallEndReason) => void\n) => {\n  return async (dispatch: Dispatch, getState: () => State): Promise<void> => {\n    setLogLevel('verbose');\n\n    setUserId(userId);\n    setCallAgent(callAgent);\n\n    callAgent.on('callsUpdated', (e: { added: Call[]; removed: Call[] }): void => {\n      e.added.forEach((addedCall) => {\n        console.log(`Call added : Call Id = ${addedCall.id}`);\n\n        const state = getState();\n        if (state.calls.call && addedCall.direction === 'Incoming') {\n          addedCall.hangUp();\n          return;\n        }\n\n        dispatch(callAdded(addedCall));\n\n        addedCall.on('stateChanged', (): void => {\n          dispatch(setCallState(addedCall.state));\n        });\n\n        dispatch(setCallState(addedCall.state));\n\n        addedCall.on('isScreenSharingOnChanged', (): void => {\n          dispatch(setShareScreen(addedCall.isScreenSharingOn));\n        });\n\n        dispatch(setShareScreen(addedCall.isScreenSharingOn));\n\n        // if remote participants have changed, subscribe to the added remote participants\n        addedCall.on('remoteParticipantsUpdated', (ev): void => {\n          // for each of the added remote participants, subscribe to events and then just update as well in case the update has already happened\n          const state = getState();\n          ev.added.forEach((addedRemoteParticipant) => {\n            subscribeToParticipant(addedRemoteParticipant, addedCall, dispatch);\n            dispatch(setParticipants([...state.calls.remoteParticipants, addedRemoteParticipant]));\n          });\n\n          // We don't use the actual value we are just going to reset the remoteParticipants based on the call\n          if (ev.removed.length > 0) {\n            dispatch(setParticipants([...addedCall.remoteParticipants.values()]));\n          }\n        });\n\n        dispatch(setParticipants([...state.calls.remoteParticipants]));\n      });\n      e.removed.forEach((removedCall) => {\n        const state = getState();\n        if (state.calls.call && state.calls.call === removedCall) {\n          dispatch(callRemoved(removedCall, state.calls.group));\n          if (removedCall.callEndReason && removedCall.callEndReason.code !== 0) {\n            removedCall.callEndReason && callEndedHandler(removedCall.callEndReason);\n          }\n        }\n      });\n    });\n  };\n};\n\nexport const initCallClient = (unsupportedStateHandler: () => void) => {\n  return async (dispatch: Dispatch, getState: () => State): Promise<void> => {\n    let callClient;\n\n    // check if chrome on ios OR firefox browser\n    if (utils.isOnIphoneAndNotSafari() || utils.isUnsupportedBrowser()) {\n      unsupportedStateHandler();\n      return;\n    }\n\n    try {\n      setLogLevel('verbose');\n      callClient = new CallClient();\n    } catch (e) {\n      unsupportedStateHandler();\n      return;\n    }\n\n    if (!callClient) {\n      return;\n    }\n\n    const deviceManager: DeviceManager = await callClient.getDeviceManager();\n    dispatch(setCallClient(callClient));\n    dispatch(setDeviceManager(deviceManager));\n    subscribeToDeviceManager(deviceManager, dispatch, getState);\n  };\n};\n\n// what does the forEveryone parameter really mean?\nexport const endCall = async (call: Call, options: HangUpOptions): Promise<void> => {\n  await call.hangUp(options).catch((e: CommunicationServicesError) => console.error(e));\n};\n\nexport const joinGroup = async (\n  callAgent: CallAgent,\n  context: GroupCallLocator,\n  callOptions: JoinCallOptions\n): Promise<void> => {\n  try {\n    await callAgent.join(context, callOptions);\n  } catch (e) {\n    console.log('Failed to join a call', e);\n    return;\n  }\n};\n\nexport const addParticipant = async (call: Call, user: CommunicationUserKind): Promise<void> => {\n  await call.addParticipant(user);\n};\n\nexport const removeParticipant = async (call: Call, user: CommunicationUserKind): Promise<void> => {\n  await call.removeParticipant(user).catch((e: CommunicationServicesError) => console.error(e));\n};\n\n\nexport {\n  sendMessage,\n  getMessages,\n  createThread,\n  addThreadMember,\n  getThreadMembers,\n  addUserToThread,\n  removeThreadMemberByUserId,\n  getEmoji,\n  setEmoji,\n  sendReadReceipt,\n  sendTypingNotification,\n  updateTypingUsers,\n  isValidThread,\n  updateThreadTopicName\n};\n","import { connect } from 'react-redux';\n\nimport ChatThread from '../components/ChatThread';\nimport { State } from '../core/reducers/index';\nimport { sendReadReceipt } from '../core/sideEffects';\nimport { PARTICIPANTS_THRESHOLD } from '../constants';\nimport { isUserMatchingIdentity } from '../utils/utils';\n\nconst mapStateToProps = (state: State) => ({\n  messages: state.chat.messages,\n  user: state.contosoClient.user,\n  users: state.contosoClient.users,\n  failedMessages: state.chat.failedMessages,\n  isYourLatestMessage: (messageId: string, messages: any[]) => {\n    let latestArrivalTime: any = -1;\n    let latestMessageId: string | undefined = undefined;\n\n    for (var i = 0; i < messages.length; i++) {\n      let date: any = messages[i].createdOn;\n      if (\n        messages[i].sender.communicationUserId === state.contosoClient.user.identity &&\n        messages[i] &&\n        new Date(date) >= new Date(latestArrivalTime)\n      ) {\n        latestArrivalTime = messages[i].createdOn;\n        latestMessageId = messages[i].id;\n      }\n    }\n\n    // we know the message we are rendering is not our latest message so we dont want to render a seen component\n    if (messageId !== latestMessageId || latestMessageId === undefined) {\n      return false;\n    }\n\n    return true;\n  },\n  isLargeParticipantsGroup: () => {\n    return state.threadMembers.threadMembers.length >= PARTICIPANTS_THRESHOLD;\n  },\n  isMessageSeen: (clientMessageId: string, messages: any[]) => {\n    if (!state.conversations.receipts || state.conversations.receipts.length === 0) {\n      return false;\n    }\n\n    let message = messages.find((message) => message.clientMessageId === clientMessageId);\n    let latestArrivalTime: any = message ? message.createdOn : -1;\n\n    var numSeen = state.conversations.receipts.filter((receipt) => {\n      if (isUserMatchingIdentity(receipt.sender, state.contosoClient.user.identity)) return false; //don't count sender's own read receipt\n      let readMessagecreatedOn = messages.find((message) => message.id === receipt.chatMessageId)?.createdOn;\n      return new Date(readMessagecreatedOn) >= new Date(latestArrivalTime);\n    }).length;\n\n    return numSeen > 0 ? true : false;\n  },\n  isYourLatestSeenMessage: (clientMessageId: string, MessagesWithSeen: any[]) => {\n    let latestArrivalTime: any = -1;\n    let latestMessageId: string | undefined = undefined;\n\n    for (var i = 0; i < MessagesWithSeen.length; i++) {\n      let date: any = MessagesWithSeen[i].createdOn;\n      if (\n        MessagesWithSeen[i].isSeen &&\n        MessagesWithSeen[i].sender.communicationUserId === state.contosoClient.user.identity &&\n        MessagesWithSeen[i] &&\n        new Date(date) >= new Date(latestArrivalTime)\n      ) {\n        latestArrivalTime = MessagesWithSeen[i].createdOn;\n        latestMessageId = MessagesWithSeen[i].clientMessageId;\n      }\n    }\n\n    if (clientMessageId !== latestMessageId || latestMessageId === undefined) {\n      return false;\n    }\n\n    return true;\n  }\n});\n\nconst mapDispatchToProps = (dispatch: any) => ({\n  sendReadReceipt: (messages: any[], userId: string) => {\n    // if you have no messages, you haven't seen any messages to send a read receipt for\n    if (!messages || messages.length === 0) {\n      return;\n    }\n\n    let latestArrivalTime: any = -1;\n    let latestMessageId = undefined;\n\n    for (var i = 0; i < messages.length; i++) {\n      let date: any = messages[i].createdOn;\n      if (messages[i].sender.communicationUserId !== userId && new Date(date) > new Date(latestArrivalTime)) {\n        latestArrivalTime = messages[i].createdOn;\n        latestMessageId = messages[i].id;\n      }\n    }\n    if (latestMessageId) {\n      dispatch(sendReadReceipt(latestMessageId));\n    }\n  }\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ChatThread);\n","import { mergeStyles } from '@fluentui/react';\n\nconst textFieldStyle = mergeStyles({\n  width: '100%',\n  height: '2.25rem'\n});\n\nconst TextFieldStyleProps = {\n  wrapper: {\n    height: '2.25rem'\n  },\n  fieldGroup: {\n    height: '2.25rem'\n  }\n};\nconst sendBoxStyle = mergeStyles({\n  border: '0rem', // 0px\n  color: 'black',\n  backgroundColor: '#EEF2F5',\n  fontWeight: 400,\n  fontSize: '1rem', // 16px\n  width: '100%',\n  height: '2.25rem',\n  '::-webkit-input-placeholder': {\n    fontSize: '1rem'\n  },\n  '::-moz-placeholder': {\n    fontSize: '1rem'\n  },\n  ':-moz-placeholder': {\n    fontSize: '1rem'\n  }\n});\n\nconst sendIconStyle = mergeStyles({\n  backgroundColor: '#EEF2F5',\n  width: '2.25rem',\n  height: '2.25rem',\n  color: 'grey',\n  paddingLeft: '0.5rem',\n  paddingTop: '0.625rem',\n  fontSize: '0.875rem' // 14px\n});\n\nconst emojiStyle = mergeStyles({\n    border: 'none',\n    width: '50px',\n    height: 'auto',\n    padding: '0',\n    marginBottom: '0',    \n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n});\n\nexport { textFieldStyle, sendBoxStyle, sendIconStyle, TextFieldStyleProps, emojiStyle };\n","import { connect } from 'react-redux';\r\nimport { Dispatch } from 'react';\r\n\r\nimport SendBox from '../components/SendBox';\r\nimport { sendMessage, sendTypingNotification } from '../core/sideEffects';\r\nimport { MINIMUM_TYPING_INTERVAL_IN_MILLISECONDS } from '../constants';\r\nimport { State } from '../core/reducers';\r\n\r\nconst mapStateToProps = (state: State) => ({\r\n  user: state.contosoClient.user\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch: any) => ({\r\n  onSendMessage: (messageContent: string) => dispatch(sendMessage(messageContent)),\r\n  onSendTypingNotification: (\r\n    lastSentTypingNotificationDate: number,\r\n    setLastSentTypingNotificationDate: Dispatch<number>\r\n  ) => {\r\n    let currentDate = new Date();\r\n    let timeSinceLastSentTypingNotificationMs = currentDate.getTime() - lastSentTypingNotificationDate;\r\n    if (timeSinceLastSentTypingNotificationMs >= MINIMUM_TYPING_INTERVAL_IN_MILLISECONDS) {\r\n      dispatch(sendTypingNotification());\r\n      setLastSentTypingNotificationDate(currentDate.getTime());\r\n    }\r\n  }\r\n});\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SendBox);\r\n","import { Stack, TextField } from '@fluentui/react';\nimport { SendIcon } from '@fluentui/react-northstar';\nimport React, { useState, Dispatch } from 'react';\nimport { Smile } from 'react-feather';\nimport { Picker } from 'emoji-mart/';\nimport 'emoji-mart/css/emoji-mart.css';\n\nimport { ENTER_KEY, EMPTY_MESSAGE_REGEX, MAXIMUM_LENGTH_OF_MESSAGE } from '../../src/constants';\nimport { sendBoxStyle, sendIconStyle, textFieldStyle, TextFieldStyleProps, emojiStyle } from './styles/SendBox.styles';\nimport { User } from '../core/reducers/ContosoClientReducers';\n\ninterface SendboxProps {\n  onSendMessage(messageContent: string): void;\n  onSendTypingNotification(\n    lastSentTypingNotificationDate: number,\n    setLastSentTypingNotificationDate: Dispatch<number>\n  ): void;\n  user: User;\n}\n\nexport default (props: SendboxProps): JSX.Element => {\n  const [textValue, setTextValue] = useState('');\n  const [textValueOverflow, setTextValueOverflow] = useState(false);\n  const [lastSentTypingNotificationDate, setLastSentTypingNotificationDate] = useState(0);\n  const [showEmojiPicker, setEmojiPicker] = useState(false);\n\n  const addEmoji = (emoji: any) => {\n    const text = `${textValue}${emoji.native}`;\n    setTextValue(text);\n    setEmojiPicker(false);\n  };\n  const toggleEmojiPicker = () => {\n    setEmojiPicker(!showEmojiPicker);\n  };\n  const addMessage = () => {\n    // we dont want to send empty messages including spaces, newlines, tabs\n    if (!EMPTY_MESSAGE_REGEX.test(textValue)) {\n      props.onSendMessage(textValue);\n      setTextValue('');\n    }\n  };\n  const setText = (e: any) => {\n    if (e.target.value.length > MAXIMUM_LENGTH_OF_MESSAGE) {\n      setTextValueOverflow(true);\n    } else {\n      setTextValueOverflow(false);\n    }\n    setTextValue(e.target.value);\n  };\n\n  return (\n    <div>\n      {showEmojiPicker ? (\n          <Picker set=\"apple\" onSelect={addEmoji}  />\n        ) : null}\n\n      <Stack horizontal={true}>\n        <button\n          type=\"button\"\n          className={emojiStyle}\n          onClick={toggleEmojiPicker}\n        >\n          <Smile />\n        </button>   \n\n        <TextField\n          className={textFieldStyle}\n          id=\"sendbox\"\n          borderless={true}\n          ariaLabel={'Type'}\n          inputClassName={sendBoxStyle}\n          placeholder=\"Type your message\"\n          value={textValue}\n          onChange={setText}\n          autoComplete=\"off\"\n          onKeyUp={(ev) => {\n            if (ev.which === ENTER_KEY && !textValueOverflow) {\n              addMessage();\n            }\n            props.onSendTypingNotification(lastSentTypingNotificationDate, setLastSentTypingNotificationDate);\n          }}\n          styles={TextFieldStyleProps}\n        />\n        <SendIcon\n          outline\n          className={sendIconStyle}\n          id=\"sendmessage\"\n          onClick={() => {\n            if (!textValueOverflow) {\n              addMessage();\n            }\n          }}\n        />\n      </Stack>\n    </div>\n  );\n};\n","import { mergeStyles } from '@fluentui/react';\n\nconst TypingIndicatorContainerStyle = mergeStyles({\n  height: '2.125rem',\n  display: 'flex',\n  alignItems: 'center'\n});\n\nconst TypingIndicatorListStyle = mergeStyles({\n  fontWeight: 400,\n  whiteSpace: 'nowrap',\n  overflow: 'hidden',\n  textOverflow: 'ellipsis',\n  paddingRight: '0.1875rem'\n});\n\nconst TypingIndicatorVerbStyle = mergeStyles({\n  fontWeight: 400,\n  whiteSpace: 'nowrap',\n  overflow: 'hidden',\n  textOverflow: 'ellipsis',\n  paddingRight: '0.1875rem'\n});\n\nexport { TypingIndicatorContainerStyle, TypingIndicatorListStyle, TypingIndicatorVerbStyle };\n","import { connect } from 'react-redux';\n\nimport TypingIndicator from '../components/TypingIndicator';\nimport { State } from '../core/reducers/index';\nimport { PARTICIPANTS_THRESHOLD, MAXIMUM_LENGTH_OF_TYPING_USERS } from '../constants';\nimport { ChatParticipant } from '@azure/communication-chat';\nimport { CommunicationUserIdentifier } from '@azure/communication-common';\n\nconst mapStateToProps = (state: State) => ({\n  generateTypingIndicatorList: () => {\n    let typingUsersFromStore = state.chat.typingUsers;\n    let contosoUsers = state.contosoClient.users;\n    let currentContosoUser = state.contosoClient.user;\n\n    let typingIndicator = '';\n    let typingUsers = typingUsersFromStore.filter(\n      (typingUser: ChatParticipant) =>\n        (typingUser.id as CommunicationUserIdentifier).communicationUserId !== currentContosoUser.identity\n    );\n    if (typingUsers.length === 0 || state.threadMembers.threadMembers.length >= PARTICIPANTS_THRESHOLD) {\n      return typingIndicator;\n    }\n    // if we have at least one other participant we want to show names for the first 2\n    if (typingUsers.length > 0) {\n      typingIndicator += typingUsers\n        .filter(\n          (typingUser: ChatParticipant) =>\n            contosoUsers[(typingUser.id as CommunicationUserIdentifier).communicationUserId] !== undefined\n        )\n        .slice(0, 2)\n        .map(\n          (typingUserWithEmoji: any) =>\n            `${contosoUsers[typingUserWithEmoji.id.communicationUserId].emoji}${typingUserWithEmoji.displayName}`\n        )\n        .join(', ');\n    }\n    // if we have more than 2 other participants we want to show the number of other participants\n    if (typingUsers.length > 2) {\n      var len = typingUsers.length - 2;\n      typingIndicator += ` and ${len} other${len === 1 ? '' : 's'}`;\n    }\n    if (typingIndicator.length > MAXIMUM_LENGTH_OF_TYPING_USERS) {\n      typingIndicator = `${typingUsers.length} participant${typingUsers.length === 1 ? '' : 's'}`;\n    }\n    return typingIndicator;\n  },\n\n  generateTypingIndicatorVerb: () => {\n    let typingUsersFromStore = state.chat.typingUsers;\n    let currentContosoUser = state.contosoClient.user;\n\n    let typingIndicatorVerb = '';\n    let typingUsers = typingUsersFromStore.filter(\n      (typingUser: ChatParticipant) =>\n        (typingUser.id as CommunicationUserIdentifier).communicationUserId !== currentContosoUser.identity\n    );\n    if (typingUsers.length === 0 || state.threadMembers.threadMembers.length >= PARTICIPANTS_THRESHOLD) {\n      return typingIndicatorVerb;\n    }\n    typingIndicatorVerb = (typingUsers.length > 1 ? ' are' : ' is') + ' typing...';\n    return typingIndicatorVerb;\n  }\n});\n\nexport default connect(mapStateToProps)(TypingIndicator);\n","import React from 'react';\n\nimport {\n  TypingIndicatorContainerStyle,\n  TypingIndicatorListStyle,\n  TypingIndicatorVerbStyle\n} from './styles/TypingIndicator.styles';\n\ninterface TypingIndicatorProps {\n  generateTypingIndicatorList(): string;\n  generateTypingIndicatorVerb(): string;\n}\n\nexport default (props: TypingIndicatorProps): JSX.Element => {\n  return (\n    <div className={TypingIndicatorContainerStyle}>\n      <span className={TypingIndicatorListStyle}>{props.generateTypingIndicatorList()}</span>\n      <span className={TypingIndicatorVerbStyle}>{props.generateTypingIndicatorVerb()}</span>\n    </div>\n  );\n};\n","import { mergeStyles } from '@fluentui/react';\n\nconst chatAreaContainerStyle = mergeStyles({\n  height: '100%',\n  width: '100%',\n  marginLeft: '6%',\n  marginRight: '6%',\n  paddingBottom: '1rem',\n  overflow: 'auto'\n});\n\nexport { chatAreaContainerStyle };\n","import { connect } from 'react-redux';\n\nimport ChatArea from '../components/ChatArea';\nimport { State } from '../core/reducers/index';\nimport { updateTypingUsers } from '../core/sideEffects';\n\nconst mapStateToProps = (state: State) => ({\n  typingNotifications: state.chat.typingNotifications\n});\n\nconst mapDispatchToProps = (dispatch: any) => ({\n  onUpdateTypingUsers: () => dispatch(updateTypingUsers())\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ChatArea);\n","import { Stack } from '@fluentui/react';\r\nimport React, { useEffect } from 'react';\r\n\r\nimport ChatThread from '../containers/ChatThread';\r\nimport SendBox from '../containers/SendBox';\r\nimport TypingIndicator from '../containers/TypingIndicator';\r\nimport { chatAreaContainerStyle } from './styles/ChatArea.styles';\r\n\r\ninterface ChatAreaProps {\r\n  onUpdateTypingUsers(): void;\r\n  typingNotifications: any;\r\n}\r\n\r\nexport default (props: ChatAreaProps): JSX.Element => {\r\n  const { onUpdateTypingUsers } = props;\r\n\r\n  useEffect(() => {\r\n    let listener: NodeJS.Timeout = setInterval(() => {\r\n      onUpdateTypingUsers();\r\n    }, 500);\r\n    return () => {\r\n      clearInterval(listener);\r\n    };\r\n  }, [onUpdateTypingUsers]);\r\n\r\n  return (\r\n    <Stack className={chatAreaContainerStyle}>\r\n      <ChatThread />\r\n      <TypingIndicator />\r\n      <SendBox />\r\n    </Stack>\r\n  );\r\n};\r\n","import { getTheme, IStackTokens, IStackStyles, ITextFieldStyles, mergeStyles } from '@fluentui/react';\n\nconst palette = getTheme().palette;\n\nconst paneFooterTokens: IStackTokens = {\n  childrenGap: 5\n};\n\nconst textFieldStyles: Partial<ITextFieldStyles> = {\n  field: {\n    color: palette.neutralSecondary,\n    padding: 0\n  },\n  root: {\n    marginLeft: '1rem',\n    marginRight: '1rem'\n  },\n  fieldGroup: {\n    border: 'none'\n  }\n};\n\nconst footerMainTextStyle = mergeStyles({\n  fontSize: '1rem', // 16px\n  fontWeight: 600,\n  marginLeft: '1rem',\n  marginRight: '1rem',\n  marginTop: '1rem'\n});\n\nconst copyLinkButtonStyle = mergeStyles({\n  fontWeight: 600,\n  height: '2.5rem',\n  marginLeft: '1rem',\n  marginRight: '1rem',\n  width: '90%'\n});\n\nconst copyIconStyle = mergeStyles({\n  marginRight: '0.5em',\n  fontSize: '0.875rem' // 14px\n});\n\nconst copyLinkTextStyle = mergeStyles({\n  fontSize: '1rem'\n});\n\nconst sidePanelContainerStyle = (showSidePanel: boolean) =>\n  mergeStyles({\n    height: '100%',\n    width: '17.813rem', // 285px\n    display: showSidePanel ? 'flex' : 'none',\n    borderLeft: '0.063rem solid #DDDDDD'\n  });\n\nconst titleStyle = mergeStyles({\n  marginLeft: '1rem',\n  marginTop: '1rem',\n  fontSize: '1rem', // 16px\n  height: '1.375rem',\n  marginBottom: '1.25rem',\n  fontWeight: 600\n});\n\nconst memberListStyle = mergeStyles({\n  height: '100%',\n  width: '100%',\n  maxHeight: '100%',\n  overflow: 'auto'\n});\n\nconst settingsListStyle = mergeStyles({\n  height: '100%',\n  width: '100%',\n  maxHeight: '100%'\n});\n\nconst textFieldIconStyle = mergeStyles({\n  marginRight: '0.5em',\n  fontSize: '0.875rem' // 14px\n});\n\nconst chatNameTextFieldStyle: Partial<ITextFieldStyles> = {\n  field: {\n    width: '100%',\n    height: '100%'\n  },\n  root: {\n    marginLeft: '1rem',\n    marginRight: '1rem'\n  },\n  fieldGroup: {\n    borderColor: '#CCCCCC',\n    borderRadius: '0.188rem',\n    height: '2.25rem',\n    paddingBottom: '0.25rem'\n  },\n  subComponentStyles: {\n    label: {\n      root: {} && {\n        fontSize: '0.875rem' // 14px\n      }\n    }\n  }\n};\n\nconst chatNameTextWarningFieldStyle: Partial<ITextFieldStyles> = {\n  field: {\n    width: '100%',\n    height: '100%'\n  },\n  root: {\n    marginLeft: '1rem',\n    marginRight: '1rem'\n  },\n  fieldGroup: {\n    borderColor: '#FF0000',\n    borderRadius: '0.188rem',\n    height: '2.25rem',\n    paddingBottom: '0.25rem'\n  },\n  subComponentStyles: {\n    label: {\n      root: {} && {\n        fontSize: '0.875rem' // 14px\n      }\n    }\n  }\n};\n\nconst saveChatNameButtonStyle = mergeStyles({\n  fontWeight: 600,\n  height: '2.5rem',\n  marginLeft: '1rem',\n  paddingRight: '1rem',\n  width: '90%'\n});\n\nconst giveFeedbackSectionStyle = mergeStyles({\n  bottom: '1rem',\n  minHeight: '7.25rem',\n  borderTop: '0.063rem solid #DDDDDD'\n});\n\nconst giveFeedbackBottomStyle = mergeStyles({\n  border: '1px solid #CCCCCC',\n  borderRadius: '2px',\n  fontWeight: 600,\n  height: '2.5rem',\n  marginLeft: '1rem',\n  marginRight: '1rem',\n  marginTop: '1rem',\n  width: '90%'\n});\n\nconst giveFeedbackIconStyle = mergeStyles({\n  marginRight: '0.5rem'\n});\n\nconst appInformationStyle = mergeStyles({\n  paddingLeft: '1rem',\n  paddingTop: '0.625rem',\n  color: '#605E5C'\n});\n\nconst inviteFooterStackContainerStyles = mergeStyles({\n  minHeight: '7.25rem',\n  borderTop: '0.063rem solid #DDDDDD'\n});\n\nconst inviteFooterStackStyles: IStackStyles = {\n  root: {\n    marginBottom: '1.25rem'\n  }\n};\n\nconst topicWarningStyle = mergeStyles({\n  height: '1.75rem',\n  backgroundColor: '#FFFFFF',\n  color: 'red',\n  fontSize: '0.75rem',\n  paddingLeft: '1rem',\n  paddingBottom: '0.5rem'\n});\n\nconst emptyWarningStyle = mergeStyles({\n  height: '1.75rem',\n  paddingBottom: '1.75rem'\n});\n\nconst saveButtonTextStyle = mergeStyles({\n  fontSize: '0.875rem' // 14px\n});\n\nconst groupNameStyle = mergeStyles({\n  fontSize: '0.875rem',\n  fontWeight: 600,\n  marginTop: '0.5rem',\n  marginLeft: '1rem'\n});\n\nconst groupNameInputBoxStyle = mergeStyles({\n  boxSizing: 'border-box',\n  height: '2.5rem',\n  width: '90%',\n  border: '0.125rem solid #CCCCCC',\n  borderRadius: '0.188rem',\n  backgroundColor: '#FFFFFF',\n  marginTop: '0.375rem',\n  marginBottom: '0.25rem',\n  marginLeft: '1rem',\n  fontSize: '1rem'\n});\n\nconst groupNameInputBoxWarningStyle = mergeStyles({\n  boxSizing: 'border-box',\n  height: '2.5rem',\n  width: '90%',\n  border: '0.125rem solid #FF0000',\n  borderRadius: '0.188rem',\n  backgroundColor: '#FFFFFF',\n  marginTop: '0.375rem',\n  marginBottom: '0.25rem',\n  marginLeft: '1rem',\n  fontSize: '1rem'\n});\n\nexport {\n  sidePanelContainerStyle,\n  titleStyle,\n  memberListStyle,\n  settingsListStyle,\n  textFieldIconStyle,\n  chatNameTextFieldStyle,\n  chatNameTextWarningFieldStyle,\n  saveChatNameButtonStyle,\n  giveFeedbackSectionStyle,\n  giveFeedbackBottomStyle,\n  giveFeedbackIconStyle,\n  appInformationStyle,\n  inviteFooterStackContainerStyles,\n  inviteFooterStackStyles,\n  paneFooterTokens,\n  textFieldStyles,\n  footerMainTextStyle,\n  copyLinkButtonStyle,\n  copyIconStyle,\n  copyLinkTextStyle,\n  topicWarningStyle,\n  emptyWarningStyle,\n  saveButtonTextStyle,\n  groupNameStyle,\n  groupNameInputBoxStyle,\n  groupNameInputBoxWarningStyle\n};\n","import { getTheme, IIconProps, IPivotStyles, mergeStyles } from '@fluentui/react';\n\nconst chatHeaderContainerStyle = mergeStyles({\n  width: '100%',\n  height: 'auto',\n  paddingLeft: '3.25rem',\n  paddingRight: '3.25rem',\n  marginTop: '1rem',\n  selectors: {\n    '@media (max-width: 65rem)': {\n      paddingLeft: '5%',\n      paddingRight: '5%'\n    }\n  },\n  borderBottom: '0.063rem solid #DDDDDD'\n});\n\nconst topicNameContainerStyle = mergeStyles({\n  height: '100%',\n  maxWidth: '100%',\n  display: 'flex',\n  alignItems: 'center',\n  marginLeft: '0.625rem'\n});\n\nconst topicNameLabelStyle = mergeStyles({\n  color: '#323130',\n  fontSize: '1rem', // 16px\n  fontWeight: 600,\n  marginRight: '0.125rem',\n  width: '31.25rem',\n  wordBreak: 'break-all',\n  overflowY: 'hidden'\n});\n\nconst topicNameEditTextStyle1 = mergeStyles({\n  color: '#A19F9D',\n  fontSize: '1rem', // 16px\n  fontWeight: 600,\n  width: '100%',\n  height: '100%'\n});\n\nconst leaveButtonContainerStyle = mergeStyles({\n  height: '100%',\n  display: 'flex',\n  alignItems: 'center'\n});\n\nconst leaveButtonStyle = mergeStyles({\n  marginRight: '0.625rem',\n  width: '6.688rem',\n  borderWidth: '0.125rem',\n  borderColor: '#CCCCCC',\n  color: '#323130',\n  fontSize: '0.875rem', // 14px\n  fontWeight: 600\n});\n\nconst greyIconButtonStyle = mergeStyles({\n  color: '#323130',\n  marginRight: '0.5rem'\n});\n\nconst editIcon: IIconProps = {\n  iconName: 'Edit'\n};\n\nconst leaveIcon: IIconProps = {\n  iconName: 'Leave'\n};\n\nconst pivotItemStyle = mergeStyles({\n  padding: '0px 13px'\n});\n\nconst palette = getTheme().palette;\nconst pivotItemStyles: Partial<IPivotStyles> = {\n  linkIsSelected: {\n    padding: 0,\n    marginRight: 0,\n    height: '100%',\n    color: palette.themePrimary,\n    selectors: {\n      ':hover': { color: palette.themePrimary }\n    }\n  },\n  link: { padding: 0, marginRight: 0, height: 60 },\n  root: {\n    width: 84,\n    height: 60,\n    marginRight: '0.5rem',\n    display: 'inline-block',\n    verticalAlign: 'top'\n  }\n};\n\nconst iconButtonContainerStyle = mergeStyles({\n  whiteSpace: 'nowrap',\n  selectors: {\n    '@media (min-width: 50rem)': {\n      display: 'none'\n    }\n  }\n});\n\nconst largeButtonContainerStyle = mergeStyles({\n  whiteSpace: 'nowrap',\n  // selectors: {\n  //   '@media (max-width: 50rem)': {\n  //     display: 'none'\n  //   }\n  // }\n});\n\nexport {\n  chatHeaderContainerStyle,\n  topicNameContainerStyle,\n  topicNameLabelStyle,\n  topicNameEditTextStyle1,\n  leaveButtonContainerStyle,\n  leaveButtonStyle,\n  greyIconButtonStyle,\n  editIcon,\n  leaveIcon,\n  pivotItemStyle,\n  pivotItemStyles,\n  iconButtonContainerStyle,\n  largeButtonContainerStyle\n};\n","import { Icon, PrimaryButton, Stack, TextField } from '@fluentui/react';\nimport React from 'react';\n\nimport {\n  copyLinkButtonStyle,\n  copyLinkTextStyle,\n  copyIconStyle,\n  footerMainTextStyle,\n  paneFooterTokens,\n  textFieldStyles\n} from './styles/SidePanel.styles';\nimport {\n  inviteFooterStackContainerStyles,\n  inviteFooterStackStyles,\n  saveButtonTextStyle\n} from './styles/SidePanel.styles';\n\nconst copyJoinLink = () => {\n  const inputElement: HTMLInputElement = document.getElementById('inputText') as HTMLInputElement;\n  inputElement.select();\n  document.execCommand('copy');\n  document.getElementById('copyLinkButton')?.focus();\n};\n\nexport default (): JSX.Element => {\n  const invitePeopleString = 'Invite people to join';\n  const copyJoinInfoString = 'Copy invite link';\n\n  return (\n    <Stack styles={inviteFooterStackStyles} className={inviteFooterStackContainerStyles} tokens={paneFooterTokens}>\n      <div className={footerMainTextStyle}>{invitePeopleString}</div>\n      <TextField\n        inputClassName={copyLinkTextStyle}\n        tabIndex={-1}\n        ariaLabel=\"Join link\"\n        styles={textFieldStyles}\n        id=\"inputText\"\n        type=\"text\"\n        value={`${document.baseURI}`}\n      ></TextField>\n      <PrimaryButton tab-index=\"-1\" id=\"copyLinkButton\" className={copyLinkButtonStyle} onClick={copyJoinLink}>\n        <Icon iconName=\"Copy\" className={copyIconStyle} />\n        <div className={saveButtonTextStyle}>{copyJoinInfoString}</div>\n      </PrimaryButton>\n    </Stack>\n  );\n};\n","import { mergeStyles } from '@fluentui/react';\n\nconst memberItemContainerStyle = mergeStyles({\n  marginLeft: '1rem',\n  marginRight: '0.5rem',\n  marginTop: '0.125rem',\n  marginBottom: '0.125rem',\n  display: 'flex',\n  position: 'relative'\n});\n\nconst memberItemNameStyle = mergeStyles({\n  fontSize: '0.875rem', // 14px\n  fontWeight: 400,\n  marginTop: '0.3125rem',\n  marginRight: '0.25rem',\n  paddingLeft: '0.25rem',\n  overflowY: 'hidden'\n});\n\nconst memberItemIsYouStyle = mergeStyles({\n  fontSize: '0.875rem', // 14px\n  fontWeight: 400,\n  color: '#A19F9D',\n  marginTop: '0.3125rem',\n  marginLeft: '0.3125rem'\n});\n\nconst moreInforStyle = mergeStyles({\n  position: 'absolute',\n  right: '1rem'\n});\n\nexport { memberItemContainerStyle, memberItemNameStyle, memberItemIsYouStyle, moreInforStyle };\n","import { IconButton } from '@fluentui/react';\nimport React from 'react';\n\nimport { messageAvatarContainerStyle } from './styles/ChatThread.styles';\nimport {\n  memberItemContainerStyle,\n  memberItemIsYouStyle,\n  memberItemNameStyle,\n  moreInforStyle\n} from './styles/MemberItem.styles';\n\ninterface MemberItemProps {\n  name: string;\n  userId: string;\n  isYou: boolean;\n  avatar: string;\n  removeThreadMemberByUserId(userId: string): void;\n}\n\nexport default (props: MemberItemProps): JSX.Element => {\n  return (\n    <div className={memberItemContainerStyle}>\n      <div className={messageAvatarContainerStyle(props.avatar)}>{props.avatar}</div>\n      <span className={memberItemNameStyle}>{props.name}</span>\n      {props.isYou && <span className={memberItemIsYouStyle}>(you)</span>}\n      {!props.isYou && (\n        <div className={moreInforStyle}>\n          <IconButton\n            menuIconProps={{ iconName: 'More' }}\n            menuProps={{\n              items: props.isYou\n                ? []\n                : [\n                    {\n                      key: props.name,\n                      name: 'Remove participant',\n                      onClick: () => {\n                        props.removeThreadMemberByUserId(props.userId);\n                      }\n                    }\n                  ]\n            }}\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n","import { mergeStyles } from '@fluentui/react';\n\nimport { getBackgroundColor } from '../../utils/utils';\n\nconst responsiveLayoutStyle = mergeStyles({\n  display: 'flex',\n  flexDirection: 'row',\n  selectors: {\n    '@media (max-width: 37.5rem)': {\n      flexDirection: 'column'\n    }\n  }\n});\n\nconst leftPreviewContainerStyle = mergeStyles({\n  height: '10.563rem',\n  width: '8.313rem',\n  marginRight: '9.688rem',\n  selectors: {\n    '@media (max-width: 37.5rem)': {\n      marginRight: '0rem'\n    }\n  }\n});\n\nconst rightInputContainerStyle = mergeStyles({\n  height: '14.75rem',\n  width: '19rem',\n  selectors: {\n    '@media (max-width: 37.5rem)': {\n      marginTop: '6.25rem'\n    }\n  }\n});\n\nconst smallAvatarContainerStyle = (avatar: string, selectedAvatar: string) =>\n  mergeStyles({\n    width: '3rem',\n    height: '3rem',\n    border: avatar === selectedAvatar ? '0.125rem solid #0378D4' : '',\n    backgroundColor: getBackgroundColor(avatar)?.backgroundColor,\n    borderRadius: '50%',\n    alignItems: 'center',\n    display: 'flex',\n    justifyContent: 'center',\n    outline: 'none'\n  });\n\nconst largeAvatarContainerStyle = (avatar: string) =>\n  mergeStyles({\n    width: '8.25rem',\n    height: '8.25rem',\n    backgroundColor: getBackgroundColor(avatar)?.backgroundColor,\n    borderRadius: '50%',\n    alignItems: 'center',\n    display: 'flex',\n    justifyContent: 'center'\n  });\n\nconst smallAvatarStyle = mergeStyles({\n  height: '1.75rem',\n  width: '2rem',\n  color: '#444444',\n  fontWeight: 400,\n  fontSize: '1.5rem',\n  letterSpacing: '0',\n  lineHeight: '1.75rem',\n  textAlign: 'center'\n});\n\nconst largeAvatarStyle = mergeStyles({\n  height: '4.938rem',\n  color: '#444444',\n  fontWeight: 400,\n  fontSize: '3.75rem', // 60px\n  letterSpacing: '0',\n  lineHeight: '4.938rem',\n  textAlign: 'center'\n});\n\nconst namePreviewStyle = (isEmpty: boolean) => {\n  return mergeStyles({\n    height: '1.5rem',\n    width: '8.313rem',\n    fontSize: '1.125rem', // 18px\n    fontWeight: 600,\n    letterSpacing: '0',\n    lineHeight: '1.5rem',\n    textAlign: 'center',\n    opacity: isEmpty ? 1 : 0.34,\n    color: isEmpty ? '#000000' : '#A19F9D',\n    wordWrap: 'break-word',\n    overflowY: 'hidden'\n  });\n};\n\nconst labelFontStyle = mergeStyles({\n  height: '1.188rem',\n  width: '2.625rem',\n  color: '#444444',\n  fontSize: '1rem', // 16px\n  fontWeight: 600,\n  letterSpacing: '0',\n  lineHeight: '2rem',\n  marginBottom: '0.625rem'\n});\n\nconst nameInputFontStyle = mergeStyles({\n  height: '1.25rem',\n  color: '#A19F9D',\n  fontWeight: 400,\n  fontSize: '1rem', // 16px\n  letterSpacing: '0',\n  lineHeight: '1.125rem'\n});\n\nconst configContainerStyle = mergeStyles({\n  maxWidth: '46.875rem',\n  width: '100%',\n  height: '100%',\n  selectors: {\n    '@media (max-width: 46.875rem)': {\n      padding: 10,\n      height: '100%'\n    }\n  },\n  horizontalAlign: 'center',\n  verticalAlign: 'center'\n});\n\nconst inputBoxStyle = mergeStyles({\n  boxSizing: 'border-box',\n  height: '2.5rem',\n  width: '18.75rem',\n  border: '0.125rem solid #CCCCCC',\n  borderRadius: '0.188rem',\n  backgroundColor: '#FFFFFF',\n  marginTop: '0.375rem',\n  marginBottom: '0.875rem'\n});\n\nconst inputBoxTextStyle = mergeStyles({\n  fontSize: '1rem', // 16px\n  lineHeight: '1.5rem',\n  '::-webkit-input-placeholder': {\n    fontSize: '1rem'\n  },\n  '::-moz-placeholder': {\n    fontSize: '1rem'\n  },\n  ':-moz-placeholder': {\n    fontSize: '1rem'\n  }\n});\n\nconst TextFieldStyleProps = {\n  wrapper: {\n    height: '2.25rem'\n  },\n  fieldGroup: {\n    height: '2.25rem'\n  }\n};\n\nconst inputBoxTextWarningStyle = mergeStyles({\n  fontSize: '1rem', // 16px\n  lineHeight: '1.5rem',\n  color: 'red'\n});\n\nconst inputBoxWarningStyle = mergeStyles({\n  boxSizing: 'border-box',\n  height: '2.5rem',\n  width: '18.75rem',\n  border: '0.125rem solid #FF0000',\n  borderRadius: '0.188rem',\n  backgroundColor: '#FFFFFF',\n  marginTop: '0.375rem',\n  marginBottom: '0.875rem',\n  fontSize: '1rem' // 16px\n});\n\nconst warningStyle = mergeStyles({\n  width: '18.75rem',\n  backgroundColor: '#FFFFFF',\n  marginTop: '0.188rem',\n  marginBottom: '0.188rem',\n  marginLeft: '0.188rem',\n  color: 'red',\n  fontSize: '1rem' // 16px\n});\n\nconst chatIconStyle = mergeStyles({\n  marginRight: '0.375rem',\n  fontSize: '0.875rem' // 14px\n});\n\nconst buttonStyle = mergeStyles({\n  height: '2.75rem',\n  fontWeight: 600,\n  width: '100%',\n  maxWidth: '18.75rem',\n  minWidth: '12.5rem',\n  fontSize: '0.875rem' // 14px\n});\n\nconst mainContainerStyle = mergeStyles({\n  maxWidth: '46.875rem',\n  width: '100%',\n  height: '100%',\n  selectors: {\n    '@media (max-width: 46.875rem)': {\n      padding: '0.625rem',\n      height: '100%'\n    }\n  }\n});\n\nconst startChatButtonTextStyle = mergeStyles({\n  fontSize: '0.875rem' // 14px\n});\n\nexport {\n  responsiveLayoutStyle,\n  leftPreviewContainerStyle,\n  rightInputContainerStyle,\n  smallAvatarContainerStyle,\n  largeAvatarContainerStyle,\n  smallAvatarStyle,\n  largeAvatarStyle,\n  namePreviewStyle,\n  labelFontStyle,\n  nameInputFontStyle,\n  configContainerStyle,\n  inputBoxStyle,\n  inputBoxTextStyle,\n  TextFieldStyleProps,\n  inputBoxTextWarningStyle,\n  inputBoxWarningStyle,\n  warningStyle,\n  chatIconStyle,\n  buttonStyle,\n  mainContainerStyle,\n  startChatButtonTextStyle\n};\n","\nimport React, { useEffect } from 'react';\nimport { Stack, Toggle, Image, ImageFit } from '@fluentui/react';\nimport { MicIcon, CallVideoIcon } from '@fluentui/react-icons-northstar';\nimport { Constants } from '../core/constants';\nimport {\n  VideoStreamRendererView,\n  VideoDeviceInfo,\n  AudioDeviceInfo,\n  LocalVideoStream,\n  VideoStreamRenderer\n} from '@azure/communication-calling';\nimport staticMediaSVG from '../assets/staticmedia.svg';\nimport {\n  toggleStyle,\n  imgStyles,\n  toggleButtonsBarToken,\n  localPreviewContainerStyle,\n  toggleButtonsBarStyle,\n  localPreviewStyle\n} from './styles/LocalPreview.styles';\n\nexport interface LocalPreviewProps {\n  setMic(mic: boolean): void;\n  mic: boolean;\n  setLocalVideoStream(device: LocalVideoStream | undefined): void;\n  videoDeviceInfo: VideoDeviceInfo;\n  audioDeviceInfo: AudioDeviceInfo;\n  videoDeviceList: VideoDeviceInfo[];\n  audioDeviceList: AudioDeviceInfo[];\n  localVideoStream: LocalVideoStream;\n}\n\nlet rendererView: VideoStreamRendererView | undefined;\n\nexport default (props: LocalPreviewProps): JSX.Element => {\n  const imageProps = {\n    src: staticMediaSVG.toString(),\n    imageFit: ImageFit.cover,\n    maximizeFrame: true\n  };\n\n  const handleLocalVideoOnOff = (_ev: React.MouseEvent<HTMLElement>, checked = false): void => {\n    const stream = new LocalVideoStream(props.videoDeviceInfo);\n    props.setLocalVideoStream(checked ? stream : undefined);\n  };\n  const handleLocalMicOnOff = (_ev: React.MouseEvent<HTMLElement>, checked = false): void => {\n    props.setMic(checked);\n  };\n\n  useEffect(() => {\n    (async (): Promise<void> => {\n      if (props.localVideoStream) {\n        const renderer: VideoStreamRenderer = new VideoStreamRenderer(props.localVideoStream);\n        rendererView = await renderer.createView({ scalingMode: 'Crop', isMirrored: true });\n\n        const container = document.getElementById(Constants.CONFIGURATION_LOCAL_VIDEO_PREVIEW_ID);\n\n        if (container && container.childElementCount === 0) {\n          container.appendChild(rendererView.target);\n        }\n      }\n    })();\n\n    return (): void => {\n      if (rendererView) {\n        rendererView.dispose();\n        rendererView = undefined;\n      }\n    };\n  }, [props.localVideoStream]);\n  return (\n    <Stack className={localPreviewContainerStyle}>\n      <Stack\n        horizontalAlign=\"center\"\n        verticalAlign=\"center\"\n        id={Constants.CONFIGURATION_LOCAL_VIDEO_PREVIEW_ID}\n        className={localPreviewStyle}\n      >\n        {!props.localVideoStream && <Image styles={imgStyles} {...imageProps} aria-label=\"Local video preview image\" />}\n      </Stack>\n      <Stack\n        horizontal\n        horizontalAlign=\"center\"\n        verticalAlign=\"center\"\n        tokens={toggleButtonsBarToken}\n        className={toggleButtonsBarStyle}\n      >\n        <CallVideoIcon size=\"medium\" />\n        <Toggle\n          checked={props.localVideoStream !== undefined}\n          styles={toggleStyle}\n          disabled={!props.videoDeviceInfo || props.videoDeviceList.length === 0}\n          onChange={handleLocalVideoOnOff}\n          ariaLabel=\"Video Icon\"\n        />\n        <MicIcon size=\"medium\" />\n        <Toggle\n          checked={props.mic}\n          styles={toggleStyle}\n          disabled={!props.audioDeviceInfo || props.audioDeviceList.length === 0}\n          onChange={handleLocalMicOnOff}\n          ariaLabel=\"Microphone Icon\"\n        />\n      </Stack>\n    </Stack>\n  );\n};\n","import React from 'react';\nimport NewLocalSettings from './LocalSettings';\nimport ParticipantStack from '../containers/ParticipantStack';\nimport { VideoDeviceInfo, AudioDeviceInfo, DeviceManager } from '@azure/communication-calling';\nimport { Stack } from '@fluentui/react';\nimport {\n  fullHeightStyles,\n  paneHeaderStyle,\n  settingsContainerStyle,\n  paneHeaderTextStyle\n} from './styles/CommandPanel.styles';\nimport Footer from './Footer';\n\nexport interface CommandPanelProps {\n  selectedPane: string;\n  videoDeviceInfo: VideoDeviceInfo;\n  videoDeviceList: VideoDeviceInfo[];\n  audioDeviceList: AudioDeviceInfo[];\n  audioDeviceInfo: AudioDeviceInfo;\n  setSelectedPane: any;\n  setVideoDeviceInfo(device: VideoDeviceInfo): void;\n  setAudioDeviceInfo(device: AudioDeviceInfo): void;\n  deviceManager: DeviceManager;\n}\nexport enum CommandPanelTypes {\n  None = 'none',\n  People = 'People',\n  Settings = 'Settings'\n}\n\nexport default (props: CommandPanelProps): JSX.Element => {\n  return (\n    <Stack styles={fullHeightStyles}>\n      <Stack.Item className={paneHeaderStyle}>\n        <div className={paneHeaderTextStyle}>{props.selectedPane}</div>\n      </Stack.Item>\n\n      {props.selectedPane === CommandPanelTypes.People && (\n        <Stack.Item styles={fullHeightStyles}>\n          <ParticipantStack />\n        </Stack.Item>\n      )}\n      {props.selectedPane === CommandPanelTypes.People && (\n        <Stack.Item>\n          <Footer />\n        </Stack.Item>\n      )}\n      {props.selectedPane === CommandPanelTypes.Settings && (\n        <Stack.Item>\n          <div className={settingsContainerStyle}>\n            <NewLocalSettings\n              videoDeviceList={props.videoDeviceList}\n              audioDeviceList={props.audioDeviceList}\n              audioDeviceInfo={props.audioDeviceInfo}\n              videoDeviceInfo={props.videoDeviceInfo}\n              setVideoDeviceInfo={props.setVideoDeviceInfo}\n              setAudioDeviceInfo={props.setAudioDeviceInfo}\n              deviceManager={props.deviceManager}\n            />\n          </div>\n        </Stack.Item>\n      )}\n    </Stack>\n  );\n};\n","import { connect } from 'react-redux';\n\nimport { ChatParticipant } from '@azure/communication-chat';\n\nimport { GUID_FOR_INITIAL_TOPIC_NAME } from '../../src/constants';\nimport ChatHeader from '../components/ChatHeader';\nimport { State } from '../core/reducers/index';\nimport { removeThreadMemberByUserId } from '../core/sideEffects';\nimport { isUserMatchingIdentity } from '../utils/utils';\n\nexport type ChatHeaderProps = {\n  userId: string;\n  existsTopicName: boolean;\n  generateHeaderMessage: () => string;\n  threadMembers: ChatParticipant[];\n  topic: string;\n};\n\nexport type ChatHeaderDispatchProps = {\n  removeChatParticipantById: (userId: string) => Promise<void>;\n};\n\nconst mapStateToProps = (state: State): ChatHeaderProps => ({\n  threadMembers: state.threadMembers.threadMembers,\n  topic: state.thread.topic,\n  userId: state.contosoClient.user.identity,\n  existsTopicName: state.thread.topic !== GUID_FOR_INITIAL_TOPIC_NAME,\n  generateHeaderMessage: () => {\n    let header = 'Chat with ';\n\n    if (state.threadMembers === undefined) {\n      header += 'yourself';\n      return header;\n    }\n\n    let members = state.threadMembers.threadMembers.filter(\n      (member: ChatParticipant) => !isUserMatchingIdentity(member.id, state.contosoClient.user.identity)\n    );\n    if (members.length === 0) {\n      header += 'yourself';\n      return header;\n    }\n\n    // if we have at least one other participant we want to show names for the first 3\n    if (members.length > 0) {\n      let namedMembers = members.slice(0, 3);\n      header += namedMembers.map((member: ChatParticipant) => member.displayName).join(', ');\n    }\n\n    // if we have more than 3 other participants we want to show the number of other participants\n    if (members.length > 3) {\n      let len = members.length - 3;\n      header += ` and ${len} other participant${len === 1 ? '' : 's'}`;\n    }\n\n    return header;\n  }\n});\n\nconst mapDispatchToProps = (dispatch: any): ChatHeaderDispatchProps => ({\n  removeChatParticipantById: (userId: string) => dispatch(removeThreadMemberByUserId(userId))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ChatHeader);\n","import { DefaultButton, Icon, Pivot, PivotItem, Stack } from '@fluentui/react';\nimport { UserFriendsIcon, SettingsIcon } from '@fluentui/react-icons-northstar';\nimport React, { Dispatch, useEffect, useState } from 'react';\n\nimport { copyIconStyle } from './styles/SidePanel.styles';\nimport {\n  chatHeaderContainerStyle,\n  largeButtonContainerStyle,\n  leaveButtonStyle,\n  pivotItemStyle,\n  pivotItemStyles,\n  topicNameLabelStyle\n} from './styles/ChatHeader.styles';\nimport { SidePanelTypes } from './SidePanel';\nimport { ChatHeaderDispatchProps, ChatHeaderProps } from '../containers/ChatHeader';\nimport { GUID_FOR_INITIAL_TOPIC_NAME } from '../constants';\n\ntype ChatHeaderPaneProps = {\n  selectedPane: SidePanelTypes;\n  setSelectedPane: Dispatch<SidePanelTypes>;\n  leaveChatHandler: () => void;\n  startCallHandler: () => void;\n};\n\nexport default (props: ChatHeaderDispatchProps & ChatHeaderProps & ChatHeaderPaneProps): JSX.Element => {\n  const [header, setHeader] = useState('');\n\n  const togglePivotItem = (item: PivotItem | undefined) => {\n    if (!item) return;\n    if (item.props.itemKey === SidePanelTypes.Settings) toggleSettings(props.selectedPane, props.setSelectedPane);\n    if (item.props.itemKey === SidePanelTypes.People) togglePeople(props.selectedPane, props.setSelectedPane);\n  };\n\n  const togglePeople = (selectedPane: SidePanelTypes, setSelectedPane: (pane: SidePanelTypes) => void) => {\n    return selectedPane !== SidePanelTypes.People\n      ? setSelectedPane(SidePanelTypes.People)\n      : setSelectedPane(SidePanelTypes.None);\n  };\n\n  const toggleSettings = (selectedPane: SidePanelTypes, setSelectedPane: (pane: SidePanelTypes) => void) => {\n    return selectedPane !== SidePanelTypes.Settings\n      ? setSelectedPane(SidePanelTypes.Settings)\n      : setSelectedPane(SidePanelTypes.None);\n  };\n\n  const leaveString = 'Leave';\n  const joinCallString = 'Join Call'\n\n  const { topic, generateHeaderMessage, leaveChatHandler, removeChatParticipantById, userId, startCallHandler } = props;\n\n  useEffect(() => {\n    setHeader(topic && topic !== GUID_FOR_INITIAL_TOPIC_NAME ? topic : generateHeaderMessage());\n  }, [topic, generateHeaderMessage]);\n\n  return (\n    <Stack className={chatHeaderContainerStyle} horizontal={true} horizontalAlign=\"space-between\">\n      <Stack.Item align=\"center\">\n        <div className={topicNameLabelStyle}>{header}</div>\n      </Stack.Item>\n      <Stack.Item align=\"center\">\n        <Stack horizontal={true}>\n          <Stack.Item align=\"center\">\n            <Pivot\n              onKeyDownCapture={(e) => {\n                if ((e.target as HTMLElement).id === SidePanelTypes.People && e.keyCode === 39) e.preventDefault();\n              }}\n              getTabId={(itemKey: string) => itemKey}\n              onLinkClick={(item) => togglePivotItem(item)}\n              styles={pivotItemStyles}\n              defaultSelectedKey={SidePanelTypes.None}\n              selectedKey={props.selectedPane}\n            >\n              <PivotItem itemKey={SidePanelTypes.None} />\n              {/* To Toggle People's Panel */}\n              <PivotItem\n                itemKey={SidePanelTypes.People}\n                onRenderItemLink={() => (\n                  <UserFriendsIcon\n                    outline={props.selectedPane === SidePanelTypes.People ? false : true}\n                    size=\"medium\"\n                    className={pivotItemStyle}\n                  />\n                )}\n              />\n              {/* To Toggle Settings's Panel */}\n              <PivotItem\n                itemKey={SidePanelTypes.Settings}\n                onRenderItemLink={() => (\n                  <SettingsIcon\n                    outline={props.selectedPane === SidePanelTypes.Settings ? false : true}\n                    size=\"medium\"\n                    className={pivotItemStyle}\n                  />\n                )}\n              />\n            </Pivot>\n          </Stack.Item>\n          <Stack.Item align=\"center\">\n            <div className={largeButtonContainerStyle}>\n              <DefaultButton\n                id=\"leave\"\n                className={leaveButtonStyle}\n                onClick={() => {\n                  leaveChatHandler();\n                  removeChatParticipantById(userId);\n                }}\n              >\n                <Icon iconName=\"Leave\" className={copyIconStyle} />\n                {leaveString}\n              </DefaultButton>\n            </div>\n          </Stack.Item>\n\n          <Stack.Item align=\"center\">\n            <div className={largeButtonContainerStyle}>\n              <DefaultButton\n                id=\"joinCall\"\n                className={leaveButtonStyle}\n                onClick={() => {\n                  startCallHandler();\n                }}\n              >\n                <Icon iconName=\"Phone\" className={copyIconStyle} />\n                {joinCallString}\n              </DefaultButton>\n            </div>\n          </Stack.Item>\n          \n        </Stack>\n      </Stack.Item>\n    </Stack>\n  );\n};\n","import { connect } from 'react-redux';\n\nimport { GUID_FOR_INITIAL_TOPIC_NAME } from '../../src/constants';\nimport { setContosoUsers, SetContosoUsersAction } from '../core/actions/ContosoClientAction';\nimport SidePanel from '../components/SidePanel';\nimport { State } from '../core/reducers/index';\nimport React from 'react';\nimport { updateThreadTopicName, removeThreadMemberByUserId } from '../core/sideEffects';\nimport { ChatClient, ChatParticipant } from '@azure/communication-chat';\n\nexport type SidePanelProps = {\n  identity: string;\n  chatParticipants: ChatParticipant[];\n  users: any;\n  existsTopicName: boolean;\n  topic: string | undefined;\n  threadId: string | undefined;\n  chatClient: ChatClient | undefined;\n  updateThreadTopicName: (\n    chatClient: ChatClient,\n    threadId: string,\n    topicName: string,\n    setIsSavingTopicName: React.Dispatch<boolean>\n  ) => void;\n};\n\nexport type SidePanelDispatchProps = {\n  setContosoUsers: (users: any) => SetContosoUsersAction;\n  removeChatParticipantById: (userId: string) => void;\n};\n\nconst mapStateToProps = (state: State): SidePanelProps => ({\n  identity: state.contosoClient.user.identity,\n  chatParticipants: state.threadMembers.threadMembers,\n  users: state.contosoClient.users,\n  existsTopicName: state.thread.topic !== GUID_FOR_INITIAL_TOPIC_NAME,\n  topic: state.thread.topic,\n  threadId: state.thread.threadId,\n  chatClient: state.contosoClient.chatClient,\n  updateThreadTopicName: (\n    chatClient: ChatClient,\n    threadId: string,\n    topicName: string,\n    setIsSavingTopicName: React.Dispatch<boolean>\n  ) => {\n    updateThreadTopicName(chatClient, threadId, topicName, setIsSavingTopicName);\n  }\n});\n\nconst mapDispatchToProps = (dispatch: any): SidePanelDispatchProps => ({\n  setContosoUsers: (users: any) => setContosoUsers(users),\n  removeChatParticipantById: async (userId: string) => {\n    dispatch(removeThreadMemberByUserId(userId));\n  }\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SidePanel);\n","import { mergeStyles } from '@fluentui/react';\n\nconst chatScreenContainerStyle = mergeStyles({\n  height: '100%',\n  width: '100%'\n});\n\nconst chatScreenBottomContainerStyle = mergeStyles({\n  height: '100%',\n  width: '100%',\n  maxHeight: '100%',\n  overflow: 'auto'\n});\n\nexport { chatScreenContainerStyle, chatScreenBottomContainerStyle };\n","import { connect } from 'react-redux';\n\nimport ChatScreen from '../components/ChatScreen';\nimport { State } from '../core/reducers';\n\nconst mapStateToProps = (state: State) => ({\n  isRemoved: state.threadMembers.isRemoved\n});\n\nexport default connect(mapStateToProps)(ChatScreen);\n","import { Stack } from '@fluentui/react';\nimport React, { useEffect, useState } from 'react';\n\nimport ChatArea from '../containers/ChatArea';\nimport ChatHeader from '../containers/ChatHeader';\nimport SidePanel from '../containers/SidePanel';\nimport { chatScreenBottomContainerStyle, chatScreenContainerStyle } from './styles/ChatScreen.styles';\nimport { SidePanelTypes } from './SidePanel';\n\ninterface ChatScreenProps {\n  leaveChatHandler(): void;\n  removedFromThreadHandler(): void;\n  startCallHandler() : void;\n  isRemoved: boolean;\n}\n\nexport default (props: ChatScreenProps): JSX.Element => {\n  // People pane will be visible when a chat is joined if the window width is greater than 600\n  const [selectedPane, setSelectedPane] = useState(\n    window.innerWidth > 600 ? SidePanelTypes.People : SidePanelTypes.None\n  );\n\n  const { leaveChatHandler, isRemoved, removedFromThreadHandler, startCallHandler } = props;\n\n  // when the screen first loads we want to put focus on the sendbox\n  useEffect(() => {\n    document.getElementById('sendbox')?.focus();\n  }, []);\n\n  // if a user is on the chat screen and they are removed from the chat thread\n  // we want to move them to the removedFromThread screen\n  useEffect(() => {\n    if (isRemoved) {\n      removedFromThreadHandler();\n    }\n  }, [isRemoved, removedFromThreadHandler]);\n\n  return (\n    <Stack className={chatScreenContainerStyle}>\n      <ChatHeader leaveChatHandler={leaveChatHandler} selectedPane={selectedPane} setSelectedPane={setSelectedPane} startCallHandler={startCallHandler}/>\n      <Stack className={chatScreenBottomContainerStyle} horizontal={true}>\n        <ChatArea />\n        <Stack.Item grow disableShrink>\n          <SidePanel selectedPane={selectedPane} setSelectedPane={setSelectedPane} />\n        </Stack.Item>\n      </Stack>\n    </Stack>\n  );\n};\n","import React from 'react';\nimport { TextField } from '@fluentui/react';\n\nimport {\n  inputBoxStyle,\n  inputBoxTextStyle,\n  TextFieldStyleProps,\n  inputBoxWarningStyle,\n  labelFontStyle,\n  warningStyle\n} from './styles/ConfigurationScreen.styles';\nimport { MAXIMUM_LENGTH_OF_NAME, ENTER_KEY } from '../constants';\n\ninterface DisplayNameFieldProps {\n  setName(name: string): void;\n  setEmptyWarning(isEmpty: boolean): void;\n  setNameLengthExceedLimit(isNameLengthExceedLimit: boolean): void;\n  validateName(): void;\n  isEmpty: boolean;\n  isNameLengthExceedLimit: boolean;\n}\n\nexport default (props: DisplayNameFieldProps): JSX.Element => {\n  const onNameTextChange = (event: any) => {\n    props.setName(event.target.value);\n    if (!event.target.value) {\n      props.setEmptyWarning(true);\n    } else if (event.target.value.length > MAXIMUM_LENGTH_OF_NAME) {\n      props.setNameLengthExceedLimit(true);\n    } else {\n      props.setEmptyWarning(false);\n      props.setNameLengthExceedLimit(false);\n    }\n  };\n\n  return (\n    <div>\n      <div className={labelFontStyle}>Name</div>\n      <TextField\n        autoComplete=\"off\"\n        inputClassName={inputBoxTextStyle}\n        ariaLabel=\"Choose your name\"\n        borderless={true}\n        className={props.isEmpty || props.isNameLengthExceedLimit ? inputBoxWarningStyle : inputBoxStyle}\n        onChange={onNameTextChange}\n        id=\"name\"\n        placeholder=\"Enter your name\"\n        onKeyDown={(ev) => {\n          if (ev.which === ENTER_KEY) {\n            props.validateName();\n          }\n        }}\n        styles={TextFieldStyleProps}\n      />\n      {(props.isEmpty && (\n        <div role=\"alert\" className={warningStyle}>\n          {' '}\n          Name cannot be empty{' '}\n        </div>\n      )) ||\n        (props.isNameLengthExceedLimit && (\n          <div role=\"alert\" className={warningStyle}>\n            {' '}\n            Name cannot be over 10 characters{' '}\n          </div>\n        ))}\n    </div>\n  );\n};\n","import { connect } from 'react-redux';\n\nimport ConfigurationScreen from '../components/ConfigurationScreen';\nimport { addUserToThread, isValidThread } from '../core/sideEffects';\n\nconst mapDispatchToProps = (dispatch: any) => ({\n  setup: async (displayName: string, emoji: string) => {\n    dispatch(addUserToThread(displayName, emoji));\n  },\n  isValidThread: async (threadId: string) => dispatch(isValidThread(threadId))\n});\n\nexport default connect(undefined, mapDispatchToProps)(ConfigurationScreen);\n","import { PrimaryButton, Stack, Spinner } from '@fluentui/react';\nimport { ChatIcon } from '@fluentui/react-icons-northstar';\nimport React, { useEffect, useState } from 'react';\nimport { FocusZone, FocusZoneDirection } from 'office-ui-fabric-react/lib/FocusZone';\n\nimport { buttonStyle, chatIconStyle, mainContainerStyle } from './styles/ConfigurationScreen.styles';\nimport {\n  labelFontStyle,\n  largeAvatarContainerStyle,\n  largeAvatarStyle,\n  leftPreviewContainerStyle,\n  namePreviewStyle,\n  responsiveLayoutStyle,\n  rightInputContainerStyle,\n  smallAvatarContainerStyle,\n  smallAvatarStyle,\n  startChatButtonTextStyle\n} from './styles/ConfigurationScreen.styles';\nimport { CAT, MOUSE, KOALA, OCTOPUS, MONKEY, FOX, getThreadId } from '../utils/utils';\nimport DisplayNameField from './DisplayNameField';\nimport { MAXIMUM_LENGTH_OF_NAME } from '../constants';\n\nexport interface ConfigurationScreenProps {\n  joinChatHandler(): void;\n  setup(displayName: string, emoji: string): void;\n  isValidThread(threadId: string | null): any;\n}\n\nexport default (props: ConfigurationScreenProps): JSX.Element => {\n  const spinnerLabel = 'Initializing chat client...';\n\n  const avatarsList = [CAT, MOUSE, KOALA, OCTOPUS, MONKEY, FOX];\n  const [name, setName] = useState('');\n\n  const [emptyWarning, setEmptyWarning] = useState(false);\n\n  const [isNameLengthExceedLimit, setNameLengthExceedLimit] = useState(false);\n\n  const [selectedAvatar, setSelectedAvatar] = useState(CAT);\n\n  const [isJoining, setIsJoining] = useState(false);\n\n  const [isValidThread, setIsValidThread] = useState<boolean | undefined>(undefined);\n\n  const { joinChatHandler, setup } = props;\n\n  const onAvatarChange = (newAvatar: string) => {\n    setSelectedAvatar(newAvatar);\n  };\n\n  const validateName = () => {\n    if (!name) {\n      setEmptyWarning(true);\n      setNameLengthExceedLimit(false);\n    } else if (name.length > MAXIMUM_LENGTH_OF_NAME) {\n      setEmptyWarning(false);\n      setNameLengthExceedLimit(true);\n    } else {\n      setEmptyWarning(false);\n      setNameLengthExceedLimit(false);\n      if (!isJoining) {\n        setup(name, selectedAvatar);\n        setIsJoining(true);\n      }\n    }\n  };\n\n  const isValidThreadProp = props.isValidThread;\n\n  useEffect(() => {\n    const isValidThread = async () => {\n      if (await isValidThreadProp(getThreadId())) {\n        setIsValidThread(true);\n      } else {\n        setIsValidThread(false);\n      }\n    };\n    isValidThread();\n    document.getElementById('🐱')?.focus();\n  }, [isValidThreadProp]);\n\n  const invalidChatThread = () => {\n    return (\n      <div>\n        <p>thread Id is not valid</p>\n      </div>\n    );\n  };\n\n  const joinChatLoading = () => {\n    return <Spinner label={spinnerLabel} ariaLive=\"assertive\" labelPosition=\"top\" />;\n  };\n\n  const joinChatArea = () => {\n    return (\n      <div>\n        <Stack className={responsiveLayoutStyle} horizontal={true} horizontalAlign=\"center\" verticalAlign=\"center\">\n          <Stack\n            className={leftPreviewContainerStyle}\n            horizontal={false}\n            verticalAlign=\"center\"\n            horizontalAlign=\"center\"\n            tokens={{ childrenGap: 13 }}\n          >\n            <div className={largeAvatarContainerStyle(selectedAvatar)}>\n              <div className={largeAvatarStyle}>{selectedAvatar}</div>\n            </div>\n            <div aria-label=\"Display name\" className={namePreviewStyle(name !== '')}>\n              {name !== '' ? name : 'Name'}\n            </div>\n          </Stack>\n          <Stack className={rightInputContainerStyle} horizontal={false} tokens={{ childrenGap: 20 }}>\n            <div>\n              <div className={labelFontStyle}>Avatar</div>\n              <FocusZone direction={FocusZoneDirection.horizontal}>\n                <Stack role=\"list\" horizontal={true} tokens={{ childrenGap: 4 }}>\n                  {avatarsList.map((avatar, index) => (\n                    <div\n                      role=\"listitem\"\n                      id={avatar}\n                      key={index}\n                      tabIndex={0}\n                      data-is-focusable={true}\n                      className={smallAvatarContainerStyle(avatar, selectedAvatar)}\n                      onFocus={() => onAvatarChange(avatar)}\n                    >\n                      <div className={smallAvatarStyle}>{avatar}</div>\n                    </div>\n                  ))}\n                </Stack>\n              </FocusZone>\n            </div>\n            <DisplayNameField\n              setName={setName}\n              setEmptyWarning={setEmptyWarning}\n              setNameLengthExceedLimit={setNameLengthExceedLimit}\n              validateName={validateName}\n              isEmpty={emptyWarning}\n              isNameLengthExceedLimit={isNameLengthExceedLimit}\n            />\n            <div>\n              <PrimaryButton\n                id=\"join\"\n                className={buttonStyle}\n                onClick={() => {\n                  validateName();\n                  if (emptyWarning === false && isNameLengthExceedLimit === false) {\n                    joinChatHandler();\n                  }\n                }}\n              >\n                <ChatIcon className={chatIconStyle} size=\"medium\" />\n                <div className={startChatButtonTextStyle}>Join chat</div>\n              </PrimaryButton>\n            </div>\n          </Stack>\n        </Stack>\n      </div>\n    );\n  };\n\n  const configurationScreen = () => {\n    return (\n      <Stack className={mainContainerStyle} horizontalAlign=\"center\" verticalAlign=\"center\">\n        {isValidThread === false ? invalidChatThread() : joinChatArea()}\n      </Stack>\n    );\n  };\n\n  return isJoining ? joinChatLoading() : configurationScreen();\n};\n","import { IToggleStyles, IStackTokens, mergeStyles, IImageStyles, getTheme } from '@fluentui/react';\n\nconst palette = getTheme().palette;\nexport const toggleStyle: Partial<IToggleStyles> = {\n  root: { marginBottom: 0 }\n};\nexport const imgStyles: Partial<IImageStyles> = {\n  root: { width: '10rem', height: '10.5rem' }\n};\nexport const toggleButtonsBarToken: IStackTokens = {\n  childrenGap: '0.625rem',\n  padding: '0.625rem'\n};\nexport const localPreviewContainerStyle = mergeStyles({\n  maxWidth: '25rem',\n  minWidth: '12.5rem',\n  width: '100%',\n  height: '100%',\n  maxHeight: '18.75rem',\n  minHeight: '12.5rem',\n  background: palette.neutralLighter,\n  color: palette.neutralPrimaryAlt\n});\nexport const toggleButtonsBarStyle = mergeStyles({\n  height: '2.8125rem',\n  width: '100%',\n  backgroundColor: palette.neutralQuaternaryAlt\n});\nexport const localPreviewStyle = mergeStyles({\n  width: '100%',\n  height: '100%',\n  maxHeight: '15.9375rem'\n});\n","import { IStackTokens, mergeStyles, IDropdownStyles } from '@fluentui/react';\n\nexport const mainStackTokens: IStackTokens = {\n  childrenGap: '1.5rem'\n};\nexport const micStackTokens: IStackTokens = {\n  childrenGap: '0.75rem'\n};\nexport const dropDownStyles: Partial<IDropdownStyles> = {\n  caretDownWrapper: {\n    height: '2.5rem',\n    lineHeight: '2.5rem'\n  },\n  dropdownItem: {\n    fontWeight: 600,\n    fontSize: '0.875rem',\n    height: '2.5rem'\n  },\n  dropdown: { height: '2.5rem' },\n  title: {\n    fontWeight: 600,\n    fontSize: '0.875rem',\n    height: '2.5rem',\n    lineHeight: '2.3125rem'\n  },\n  label: {\n    fontWeight: 600,\n    fontSize: '0.875rem'\n  }\n};\nexport const localSettingsContainer = mergeStyles({\n  width: '100%',\n  maxWidth: '18.75rem',\n  minWidth: '12.5rem',\n  maxHeight: '14.125rem',\n  marginTop: '2.125rem'\n});\n","\nimport React from 'react';\nimport { Stack, Dropdown, IDropdownOption } from '@fluentui/react';\nimport { VideoDeviceInfo, AudioDeviceInfo, DeviceManager } from '@azure/communication-calling';\nimport { localSettingsContainer, dropDownStyles, micStackTokens, mainStackTokens } from './styles/LocalSettings.styles';\n\nexport interface LocalSettingsProps {\n  deviceManager: DeviceManager;\n  videoDeviceList: VideoDeviceInfo[];\n  audioDeviceList: AudioDeviceInfo[];\n  videoDeviceInfo: VideoDeviceInfo;\n  audioDeviceInfo: AudioDeviceInfo;\n  setVideoDeviceInfo(device: VideoDeviceInfo): void;\n  setAudioDeviceInfo(device: AudioDeviceInfo): void;\n}\n\nexport default (props: LocalSettingsProps): JSX.Element => {\n  const defaultPlaceHolder = 'Select an option';\n  const cameraLabel = 'Camera';\n  const micLabel = 'Microphone';\n\n  const getDropDownList = (list: Array<VideoDeviceInfo | AudioDeviceInfo>): IDropdownOption[] => {\n    return list.map((item) => ({\n      val: item,\n      key: item.id,\n      text: item.name === '' ? item.deviceType : item.name\n    }));\n  };\n  return (\n    <Stack className={localSettingsContainer} tokens={mainStackTokens}>\n      <Dropdown\n        placeholder={defaultPlaceHolder}\n        label={cameraLabel}\n        options={getDropDownList(props.videoDeviceList)}\n        styles={dropDownStyles}\n        disabled={props.videoDeviceList.length === 0}\n        defaultSelectedKey={props.videoDeviceInfo ? props.videoDeviceInfo.id : ''}\n        onChange={(...args): void => {\n          const index = args[2] ?? 0;\n          props.setVideoDeviceInfo(props.videoDeviceList[index]);\n        }}\n      />\n      <Stack tokens={micStackTokens}>\n        <Dropdown\n          placeholder={defaultPlaceHolder}\n          label={micLabel}\n          styles={dropDownStyles}\n          disabled={props.audioDeviceList.length === 0}\n          options={getDropDownList(props.audioDeviceList)}\n          defaultSelectedKey={props.audioDeviceInfo ? props.audioDeviceInfo.id : ''}\n          onChange={(...args): void => {\n            const index = args[2] ?? 0;\n            props.setAudioDeviceInfo(props.audioDeviceList[index]);\n            props.deviceManager.selectMicrophone(props.audioDeviceList[index]);\n          }}\n        />\n      </Stack>\n    </Stack>\n  );\n};\n","import { mergeStyles, IStackTokens } from '@fluentui/react';\n\nexport const configurationStackTokens: IStackTokens = {\n  childrenGap: '3rem'\n};\nexport const videoCameraIconStyle = mergeStyles({\n  marginRight: '0.375rem',\n  fontSize: '1.375rem'\n});\nexport const buttonStyle = mergeStyles({\n  fontWeight: 600,\n  fontSize: '0.875rem', // 14px\n  height: '2.75rem',\n  width: '100%',\n  marginTop: '2.125rem',\n  maxWidth: '18.75rem',\n  minWidth: '12.5rem'\n});\nexport const mainContainerStyle = mergeStyles({\n  maxWidth: '46.875rem',\n  width: '100%',\n  height: '100%',\n  selectors: {\n    '@media (max-width: 750px)': {\n      padding: '0.625rem',\n      height: '100%'\n    }\n  }\n});\nexport const localSettingsContainerStyle = mergeStyles({\n  width: '100%',\n  maxWidth: '18.75rem'\n});\nexport const fullScreenStyle = mergeStyles({\n  height: '100%',\n  width: '100%'\n});\nexport const verticalStackStyle = mergeStyles({\n  height: '100%',\n  width: '100%',\n  justifyContent: 'space-evenly'\n});\nexport const localVideoWrapperStyle = mergeStyles({\n  minWidth: '12.5rem'\n});\n\nexport const inputBoxStyle = mergeStyles({\n  boxSizing: 'border-box',\n  height: '2.5rem',\n  width: '18.75rem',\n  border: '1px solid #605e5c',\n  borderRadius: '2px',\n  backgroundColor: '#FFFFFF'\n});\n\nexport const inputBoxTextStyle = mergeStyles({\n  fontSize: '0.875rem',\n  fontWeight: 600,\n  lineHeight: '1.5rem',\n  '::-webkit-input-placeholder': {\n    fontSize: '0.875rem',\n    fontWeight: 600\n  },\n  '::-moz-placeholder': {\n    fontSize: '0.875rem',\n    fontWeight: 600\n  },\n  ':-moz-placeholder': {\n    fontSize: '0.875rem',\n    fontWeight: 600\n  }\n});\n\nexport const inputBoxWarningStyle = mergeStyles({\n  boxSizing: 'border-box',\n  height: '2.5rem',\n  width: '18.75rem',\n  border: '1px solid #e81123',\n  borderRadius: '2px',\n  backgroundColor: '#FFFFFF',\n  fontSize: '0.875rem'\n});\n\nexport const labelFontStyle = mergeStyles({\n  fontSize: '0.875rem',\n  fontWeight: 600,\n  color: 'rgb(50, 49, 48)',\n  boxSizing: 'border-box',\n  boxShadow: 'none',\n  margin: 0,\n  display: 'inline-block',\n  padding: '5px 0px',\n  overflowWrap: 'break-word'\n});\n\nexport const warningStyle = mergeStyles({\n  width: '18.75rem',\n  backgroundColor: '#FFFFFF',\n  marginTop: '0.188rem',\n  marginBottom: '0.188rem',\n  marginLeft: '0.188rem',\n  color: '#e81123',\n  fontSize: '.7375rem',\n  fontWeight: '400'\n});\n","import React from 'react';\nimport { TextField } from '@fluentui/react';\n\nimport {\n  inputBoxStyle,\n  inputBoxTextStyle,\n  inputBoxWarningStyle,\n  labelFontStyle,\n  warningStyle\n} from './styles/CallConfigurationScreen.styles';\n\ninterface DisplayNameFieldProps {\n  setName(name: string): void;\n  name: string;\n  setEmptyWarning(isEmpty: boolean): void;\n  isEmpty: boolean;\n}\n\nconst TextFieldStyleProps = {\n  wrapper: {\n    height: '2.3rem'\n  },\n  fieldGroup: {\n    height: '2.3rem'\n  }\n};\n\nexport default (props: DisplayNameFieldProps): JSX.Element => {\n  const onNameTextChange = (event: any): void => {\n    props.setName(event.target.value);\n    if (event.target.value) {\n      props.setEmptyWarning(false);\n    } else {\n      props.setEmptyWarning(true);\n    }\n  };\n\n  return (\n    <div>\n      <div className={labelFontStyle}>Name</div>\n      <TextField\n        autoComplete=\"off\"\n        inputClassName={inputBoxTextStyle}\n        ariaLabel=\"Choose your name\"\n        borderless={true}\n        className={props.isEmpty ? inputBoxWarningStyle : inputBoxStyle}\n        onChange={onNameTextChange}\n        id=\"name\"\n        placeholder=\"Enter your name\"\n        defaultValue={props.name}\n        styles={TextFieldStyleProps}\n      />\n      {props.isEmpty && (\n        <div role=\"alert\" className={warningStyle}>\n          {' '}\n          Name cannot be empty{' '}\n        </div>\n      )}\n    </div>\n  );\n};\n","import { connect } from 'react-redux';\r\nimport ConfigurationScreen, { ConfigurationScreenProps, TokenResponse } from '../components/CallConfigurationScreen';\r\nimport { setCallAgent, setGroup } from '../core/actions/calls';\r\nimport { setVideoDeviceInfo, setAudioDeviceInfo } from '../core/actions/devices';\r\nimport { initCallClient, joinGroup, registerToCallAgent, updateDevices } from '../core/sideEffects';\r\nimport { setMic } from '../core/actions/controls';\r\nimport { State } from '../core/reducers';\r\nimport {\r\n  AudioDeviceInfo,\r\n  VideoDeviceInfo,\r\n  LocalVideoStream,\r\n  CallAgent,\r\n  CallEndReason\r\n} from '@azure/communication-calling';\r\nimport { CommunicationUserToken } from '@azure/communication-identity';\r\nimport { utils } from '../utils/utils';\r\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\r\nimport { setUserId } from '../core/actions/sdk';\r\nimport { getToken } from '../core/sideEffects';\r\n\r\nconst mapStateToProps = (state: State, props: ConfigurationScreenProps) => ({\r\n  deviceManager: state.devices.deviceManager,\r\n  callAgent: state.calls.callAgent,\r\n  group: state.calls.group,\r\n  mic: state.controls.mic,\r\n  screenWidth: props.screenWidth,\r\n  audioDeviceInfo: state.devices.audioDeviceInfo,\r\n  videoDeviceInfo: state.devices.videoDeviceInfo,\r\n  videoDeviceList: state.devices.videoDeviceList,\r\n  audioDeviceList: state.devices.audioDeviceList,\r\n  cameraPermission: state.devices.cameraPermission,\r\n  microphonePermission: state.devices.microphonePermission,\r\n  joinGroup: async (callAgent: CallAgent, groupId: string, localVideoStream: LocalVideoStream): Promise<void> => {\r\n    callAgent &&\r\n      (await joinGroup(\r\n        callAgent,\r\n        {\r\n          groupId\r\n        },\r\n        {\r\n          videoOptions: {\r\n            localVideoStreams: localVideoStream ? [localVideoStream] : undefined\r\n          },\r\n          audioOptions: { muted: !state.controls.mic }\r\n        }\r\n      ));\r\n  },\r\n  getToken: async (): Promise<TokenResponse> => {\r\n    const tokenResponse: CommunicationUserToken = await getToken();\r\n    const userToken = tokenResponse.token;\r\n    const userId = tokenResponse.user.communicationUserId;\r\n\r\n    const tokenCredential = new AzureCommunicationTokenCredential({\r\n      tokenRefresher: (): Promise<string> => {\r\n        return utils.getRefreshedTokenForUser(userId);\r\n      },\r\n      refreshProactively: true,\r\n      token: userToken\r\n    });\r\n\r\n    return {\r\n      tokenCredential,\r\n      userId\r\n    };\r\n  },\r\n  createCallAgent: async (\r\n    tokenCredential: AzureCommunicationTokenCredential,\r\n    displayName: string\r\n  ): Promise<CallAgent> => {\r\n    const callClient = state.sdk.callClient;\r\n\r\n    if (callClient === undefined) {\r\n      throw new Error('CallClient is not initialized');\r\n    }\r\n\r\n    const callAgent: CallAgent = await callClient.createCallAgent(tokenCredential, { displayName });\r\n    return callAgent;\r\n  }\r\n});\r\n\r\nconst mapDispatchToProps = (dispatch: any) => ({\r\n  setMic: (mic: boolean): void => dispatch(setMic(mic)),\r\n  setAudioDeviceInfo: (deviceInfo: AudioDeviceInfo): void => dispatch(setAudioDeviceInfo(deviceInfo)),\r\n  setVideoDeviceInfo: (deviceInfo: VideoDeviceInfo): void => dispatch(setVideoDeviceInfo(deviceInfo)),\r\n  setupCallClient: (unsupportedStateHandler: () => void): void => dispatch(initCallClient(unsupportedStateHandler)),\r\n  registerToCallEvents: async (\r\n    userId: string,\r\n    callAgent: CallAgent,\r\n    endCallHandler: (reason: CallEndReason) => void\r\n  ): Promise<void> => {\r\n    dispatch(setUserId(userId));\r\n    dispatch(setCallAgent(callAgent));\r\n    dispatch(registerToCallAgent(userId, callAgent, endCallHandler));\r\n  },\r\n  setGroup: (groupId: string): void => dispatch(setGroup(groupId)),\r\n  updateDevices: (): void => dispatch(updateDevices())\r\n});\r\n\r\nconst connector: any = connect(mapStateToProps, mapDispatchToProps);\r\nexport default connector(ConfigurationScreen);\r\n","import React, { useEffect, useState } from 'react';\r\nimport { Stack, Spinner, PrimaryButton } from '@fluentui/react';\r\nimport LocalPreview from './LocalPreview';\r\nimport LocalSettings from './LocalSettings';\r\nimport CallDisplayNameField from './CallDisplayNameField';\r\nimport {\r\n  VideoDeviceInfo,\r\n  AudioDeviceInfo,\r\n  LocalVideoStream,\r\n  DeviceManager,\r\n  CallAgent,\r\n  CallEndReason\r\n} from '@azure/communication-calling';\r\nimport { VideoCameraEmphasisIcon } from '@fluentui/react-icons-northstar';\r\nimport {\r\n  videoCameraIconStyle,\r\n  configurationStackTokens,\r\n  buttonStyle,\r\n  localSettingsContainerStyle,\r\n  mainContainerStyle,\r\n  fullScreenStyle,\r\n  verticalStackStyle\r\n} from './styles/CallConfigurationScreen.styles';\r\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\r\n\r\nexport type TokenResponse = {\r\n  tokenCredential: AzureCommunicationTokenCredential;\r\n  userId: string;\r\n};\r\n\r\nexport interface ConfigurationScreenProps {\r\n  userId: string;\r\n  groupId: string;\r\n  callAgent: CallAgent;\r\n  deviceManager: DeviceManager;\r\n  setupCallClient(unsupportedStateHandler: () => void): void;\r\n  setupCallAgent(\r\n    displayName: string,\r\n    groupId: string,\r\n    afterSetupHandler: (callAgent: CallAgent, groupId: string) => void\r\n  ): void;\r\n  setGroup(groupId: string): void;\r\n  startCallHandler(): void;\r\n  unsupportedStateHandler: () => void;\r\n  callEndedHandler: (reason: CallEndReason) => void;\r\n  videoDeviceList: VideoDeviceInfo[];\r\n  audioDeviceList: AudioDeviceInfo[];\r\n  setVideoDeviceInfo(device: VideoDeviceInfo): void;\r\n  setAudioDeviceInfo(device: AudioDeviceInfo): void;\r\n  mic: boolean;\r\n  setMic(mic: boolean): void;\r\n  setLocalVideoStream(stream: LocalVideoStream | undefined): void;\r\n  localVideoRendererIsBusy: boolean;\r\n  videoDeviceInfo: VideoDeviceInfo;\r\n  audioDeviceInfo: AudioDeviceInfo;\r\n  localVideoStream: LocalVideoStream;\r\n  screenWidth: number;\r\n  joinGroup(callAgent: CallAgent, groupId: string): void;\r\n  getToken(): Promise<TokenResponse>;\r\n  createCallAgent(tokenCredential: AzureCommunicationTokenCredential, displayName: string): Promise<CallAgent>;\r\n  registerToCallEvents(\r\n    userId: string,\r\n    callAgent: CallAgent,\r\n    endCallHandler: (reason: CallEndReason) => void\r\n  ): Promise<void>;\r\n}\r\n\r\nexport default (props: ConfigurationScreenProps): JSX.Element => {\r\n  const spinnerLabel = 'Initializing call client...';\r\n  const buttonText = 'Start call';\r\n\r\n  const createUserId = (): string => 'user' + Math.ceil(Math.random() * 1000);\r\n\r\n  const [name, setName] = useState(createUserId());\r\n  const [emptyWarning, setEmptyWarning] = useState(false);\r\n\r\n  const { groupId, setupCallClient, setGroup, unsupportedStateHandler } = props;\r\n\r\n  useEffect(() => {\r\n    setupCallClient(unsupportedStateHandler);\r\n  }, [setupCallClient, unsupportedStateHandler]);\r\n\r\n  return (\r\n    <Stack className={mainContainerStyle} horizontalAlign=\"center\" verticalAlign=\"center\">\r\n      {props.deviceManager ? (\r\n        <Stack\r\n          className={props.screenWidth > 750 ? fullScreenStyle : verticalStackStyle}\r\n          horizontal={props.screenWidth > 750}\r\n          horizontalAlign=\"center\"\r\n          verticalAlign=\"center\"\r\n          tokens={props.screenWidth > 750 ? configurationStackTokens : undefined}\r\n        >\r\n          <LocalPreview\r\n            mic={props.mic}\r\n            setMic={props.setMic}\r\n            setLocalVideoStream={props.setLocalVideoStream}\r\n            videoDeviceInfo={props.videoDeviceInfo}\r\n            audioDeviceInfo={props.audioDeviceInfo}\r\n            localVideoStream={props.localVideoStream}\r\n            videoDeviceList={props.videoDeviceList}\r\n            audioDeviceList={props.audioDeviceList}\r\n          />\r\n          <Stack className={localSettingsContainerStyle}>\r\n            <CallDisplayNameField setName={setName} name={name} setEmptyWarning={setEmptyWarning} isEmpty={emptyWarning} />\r\n            <div>\r\n              <LocalSettings\r\n                videoDeviceList={props.videoDeviceList}\r\n                audioDeviceList={props.audioDeviceList}\r\n                audioDeviceInfo={props.audioDeviceInfo}\r\n                videoDeviceInfo={props.videoDeviceInfo}\r\n                setVideoDeviceInfo={props.setVideoDeviceInfo}\r\n                setAudioDeviceInfo={props.setAudioDeviceInfo}\r\n                deviceManager={props.deviceManager}\r\n              />\r\n            </div>\r\n            <div>\r\n              <PrimaryButton\r\n                className={buttonStyle}\r\n                onClick={async (): Promise<void> => {\r\n                  if (!name) {\r\n                    setEmptyWarning(true);\r\n                  } else {\r\n                    setEmptyWarning(false);\r\n                    //1. Retrieve a token\r\n                    const { tokenCredential, userId } = await props.getToken();\r\n                    //2. Initialize the call agent\r\n                    const callAgent = await props.createCallAgent(tokenCredential, name);\r\n                    //3. Register for calling events\r\n                    props.registerToCallEvents(userId, callAgent, props.callEndedHandler);\r\n                    //4. Join the call\r\n                    await props.joinGroup(callAgent, groupId);\r\n                    props.startCallHandler();\r\n                    setGroup(groupId);\r\n                  }\r\n                }}\r\n              >\r\n                <VideoCameraEmphasisIcon className={videoCameraIconStyle} size=\"medium\" />\r\n                {buttonText}\r\n              </PrimaryButton>\r\n            </div>\r\n          </Stack>\r\n        </Stack>\r\n      ) : (\r\n        <Spinner label={spinnerLabel} ariaLive=\"assertive\" labelPosition=\"top\" />\r\n      )}\r\n    </Stack>\r\n  );\r\n};\r\n","import { IStackTokens, mergeStyles } from '@fluentui/react';\n\nconst mainStackTokens: IStackTokens = {\n  childrenGap: 44\n};\n\nconst buttonsStackTokens: IStackTokens = {\n  childrenGap: 12\n};\n\nconst upperStackTokens: IStackTokens = {\n  childrenGap: 24\n};\nconst endCallContainerStyle = mergeStyles({\n  width: 330\n});\n\nconst endCallTitleStyle = mergeStyles({\n  fontWeight: 600,\n  fontSize: '1.375rem' // 22px\n});\n\nconst buttonStyle = mergeStyles({\n  fontWeight: 600,\n  height: '2.5rem',\n  width: '9.875rem',\n  fontSize: '0.875rem', // 14px\n  padding: 0\n});\n\nconst videoCameraIconStyle = mergeStyles({\n  marginRight: '0.375rem',\n  fontSize: '1.375rem' // 22px\n});\n\nconst bottomStackFooterStyle = mergeStyles({\n  color: 'rgb(0,0,0)',\n  fontSize: '0.875rem' // 14px\n});\n\nconst buttonTextStyle = mergeStyles({\n  fontSize: '0.875rem' // 14px\n});\n\nexport {\n  mainStackTokens,\n  buttonsStackTokens,\n  upperStackTokens,\n  endCallContainerStyle,\n  endCallTitleStyle,\n  buttonStyle,\n  videoCameraIconStyle,\n  bottomStackFooterStyle,\n  buttonTextStyle\n};\n","import { DefaultButton, PrimaryButton, Stack } from '@fluentui/react';\nimport { ChatIcon } from '@fluentui/react-icons-northstar';\nimport React, { useState } from 'react';\n\nimport {\n  buttonsStackTokens,\n  buttonStyle,\n  endCallContainerStyle,\n  endCallTitleStyle,\n  mainStackTokens,\n  upperStackTokens,\n  videoCameraIconStyle,\n  buttonTextStyle\n} from './styles/EndChat.styles';\n\nexport interface EndCallProps {\n  rejoinHandler(): void;\n  homeHandler(): void;\n}\n\nexport default (props: EndCallProps): JSX.Element => {\n  const leftCall = 'You left the chat';\n  const goHomePage = 'Go to homepage';\n  const rejoinChat = 'Rejoin chat';\n  const rejoining = 'Rejoining...';\n\n  const [isRejoiningThread, setIsRejoiningThread] = useState(false);\n\n  const rejoinThread = async () => {\n    if (!isRejoiningThread) {\n      setIsRejoiningThread(true);\n      props.rejoinHandler();\n    }\n  };\n\n  return (\n    <Stack verticalAlign=\"center\" tokens={mainStackTokens} className={endCallContainerStyle}>\n      <Stack tokens={upperStackTokens}>\n        <div tabIndex={0} className={endCallTitleStyle}>\n          {leftCall}\n        </div>\n        <Stack horizontal tokens={buttonsStackTokens}>\n          <PrimaryButton\n            disabled={isRejoiningThread}\n            className={buttonStyle}\n            onClick={async () => {\n              await rejoinThread();\n            }}\n          >\n            <ChatIcon className={videoCameraIconStyle} size=\"medium\" />\n            <div className={buttonTextStyle}>{isRejoiningThread ? rejoining : rejoinChat}</div>\n          </PrimaryButton>\n          <DefaultButton className={buttonStyle} onClick={props.homeHandler}>\n            <div className={buttonTextStyle}> {goHomePage}</div>\n          </DefaultButton>\n        </Stack>\n      </Stack>\n    </Stack>\n  );\n};\n","import { DefaultButton, Stack } from '@fluentui/react';\nimport React from 'react';\n\nimport {\n  buttonsStackTokens,\n  buttonStyle,\n  endCallContainerStyle,\n  endCallTitleStyle,\n  mainStackTokens,\n  upperStackTokens\n} from './styles/EndChat.styles';\n\nexport interface RemovedFromThreadProps {\n  homeHandler(): void;\n}\n\nexport default (props: RemovedFromThreadProps): JSX.Element => {\n  const leftCall = 'You are no longer a participant for the chat thread.';\n  const goHomePage = 'Go to homepage';\n\n  return (\n    <Stack verticalAlign=\"center\" tokens={mainStackTokens} className={endCallContainerStyle}>\n      <Stack tokens={upperStackTokens}>\n        <div tabIndex={0} className={endCallTitleStyle}>\n          {leftCall}\n        </div>\n        <Stack horizontal tokens={buttonsStackTokens}>\n          <DefaultButton className={buttonStyle} onClick={props.homeHandler}>\n            {goHomePage}\n          </DefaultButton>\n        </Stack>\n      </Stack>\n    </Stack>\n  );\n};\n","import { getTheme, IStackTokens, mergeStyles } from '@fluentui/react';\n\nconst palette = getTheme().palette;\n\nconst imgStyle = mergeStyles({\n  width: '26.813rem',\n  height: '20.125rem',\n  selectors: {\n    '@media (max-width: 53.438rem)': {\n      display: 'none'\n    }\n  }\n});\n\nconst containerTokens: IStackTokens = {\n  childrenGap: 55\n};\n\nconst upperStackTokens: IStackTokens = {\n  childrenGap: 42\n};\n\nconst nestedStackTokens: IStackTokens = {\n  childrenGap: 12\n};\n\nconst listStyle = mergeStyles({\n  listStyleType: 'none',\n  paddingLeft: '0px',\n  fontSize: '0.875rem' // 14px\n});\n\nconst iconStyle = mergeStyles({\n  marginRight: 7,\n  color: palette.themePrimary\n});\n\nconst headerStyle = mergeStyles({\n  fontWeight: 600,\n  fontSize: '2.25rem', // 36px\n  maxWidth: '23.188rem'\n});\n\nconst videoCameraIconStyle = mergeStyles({\n  marginRight: '0.375rem',\n  fontSize: '1.375rem' // 22px\n});\n\nconst buttonStyle = mergeStyles({\n  fontWeight: 600,\n  fontSize: '0.875rem', // 14px\n  width: 'fit-content',\n  height: '2.5rem',\n  borderRadius: 3,\n  selectors: {\n    '@media (max-width: 53.438rem)': {\n      padding: '0.625rem'\n    }\n  }\n});\n\nconst upperStackStyle = mergeStyles({\n  selectors: {\n    '@media (max-width: 53.438rem)': {\n      padding: '0.625'\n    }\n  }\n});\n\nconst moreInfoStyle = mergeStyles({\n  color: '#303030',\n  opacity: 0.8,\n  marginTop: '0.625rem',\n  fontSize: '0.75rem', // 12px\n  fontWeight: 400\n});\n\nconst startChatTextStyle = mergeStyles({\n  fontSize: '0.875rem' // 14px\n});\n\nexport {\n  imgStyle,\n  containerTokens,\n  upperStackTokens,\n  nestedStackTokens,\n  listStyle,\n  iconStyle,\n  headerStyle,\n  videoCameraIconStyle,\n  buttonStyle,\n  upperStackStyle,\n  moreInfoStyle,\n  startChatTextStyle\n};\n","import { Image, PrimaryButton, Stack, IImageStyles, Spinner } from '@fluentui/react';\nimport { ChatIcon } from '@fluentui/react-icons-northstar';\nimport React, { useState } from 'react';\n\nimport heroSVG from '../assets/hero.svg';\nimport {\n  buttonStyle,\n  containerTokens,\n  headerStyle,\n  imgStyle,\n  upperStackStyle,\n  upperStackTokens,\n  videoCameraIconStyle,\n  startChatTextStyle\n} from './styles/HomeScreen.styles';\n\nexport interface HomeScreenProps {\n  createThreadHandler(): void;\n}\n\nconst imageStyleProps: IImageStyles = {\n  image: {\n    height: '100%'\n  },\n  root: {}\n};\n\nexport default (props: HomeScreenProps): JSX.Element => {\n  const spinnerLabel = 'Creating a new chat thread...';\n  const imageProps = { src: heroSVG.toString() };\n  const headerTitle = 'Welcome to ConnectBox!';\n  const startChatButtonText = 'Start connecting';\n\n  const [isCreatingThread, setIsCreatingThread] = useState(false);\n\n  const onCreateThread = () => {\n    props.createThreadHandler();\n    setIsCreatingThread(true);\n  };\n\n  const creatThreadLoading = () => {\n    return <Spinner label={spinnerLabel} ariaLive=\"assertive\" labelPosition=\"top\" />;\n  };\n\n  const homeScreen = () => {\n    return (\n      <div>\n        <Stack horizontal horizontalAlign=\"center\" verticalAlign=\"center\" tokens={containerTokens}>\n          <Stack className={upperStackStyle} tokens={upperStackTokens}>\n            <div tabIndex={0} className={headerStyle}>\n              {headerTitle}\n            </div>\n            <PrimaryButton\n              id=\"startChat\"\n              role=\"main\"\n              aria-label=\"Start chat\"\n              className={buttonStyle}\n              onClick={() => {\n                onCreateThread();\n              }}\n            >\n              <ChatIcon className={videoCameraIconStyle} size=\"medium\" />\n              <div className={startChatTextStyle}>{startChatButtonText}</div>\n            </PrimaryButton>\n          </Stack>\n          <Image\n            styles={imageStyleProps}\n            alt=\"Welcome to the Azure Communication Services Chat sample app\"\n            className={imgStyle}\n            {...imageProps}\n          />\n        </Stack>\n      </div>\n    );\n  };\n\n  return isCreatingThread ? creatThreadLoading() : homeScreen();\n};\n","import { connect } from 'react-redux';\n\nimport HomeScreen from '../components/HomeScreen';\nimport { createThread } from '../core/sideEffects';\n\nconst mapStateToProps = () => ({\n  createThreadHandler: () => {\n    createThread();\n  }\n});\n\nexport default connect(mapStateToProps)(HomeScreen);\n","import { ChatClient } from '@azure/communication-chat';\n\nimport {\n  ContosoActionTypes,\n  SET_CHAT_CLIENT,\n  SET_CURRENT_USER,\n  SET_USERS,\n  Users\n} from '../actions/ContosoClientAction';\n\nexport interface User {\n  identity: string;\n  token?: string;\n  displayName: string;\n  memberRole?: String;\n}\n\nexport interface ContosoState {\n  chatClient: ChatClient | undefined;\n  user: User;\n  users: Users;\n}\n\nconst initContosoState: ContosoState = {\n  chatClient: undefined,\n  user: { identity: '', token: '', displayName: '', memberRole: '' },\n  users: {}\n};\n\nexport const ContosoReducer = (state = initContosoState, action: ContosoActionTypes) => {\n  switch (action.type) {\n    case SET_CHAT_CLIENT:\n      return {\n        ...state,\n        chatClient: action.chatClient\n      };\n    case SET_CURRENT_USER:\n      return {\n        ...state,\n        user: {\n          identity: action.identity,\n          token: action.token,\n          displayName: action.displayName,\n          memberRole: action.memberRole\n        }\n      };\n    case SET_USERS:\n      return {\n        ...state,\n        users: Object.assign({}, action.users)\n      };\n    default:\n      return state;\n  }\n};\n","import { ChatMessageReadReceipt } from '@azure/communication-chat';\n\nimport { SET_RECEIPTS, ConversationsActionTypes } from '../actions/ConversationsAction';\n\nexport interface ConversationsState {\n  receipts: ChatMessageReadReceipt[];\n}\n\nconst initConversationsState: ConversationsState = {\n  receipts: []\n};\n\nexport const ConversationsReducer = (state = initConversationsState, action: ConversationsActionTypes) => {\n  switch (action.type) {\n    case SET_RECEIPTS:\n      return {\n        ...state,\n        receipts: [...action.receipts]\n      };\n    default:\n      return state;\n  }\n};\n","import { ChatParticipant } from '@azure/communication-chat';\r\nimport { CommunicationIdentifierKind } from '@azure/communication-common';\r\n\r\nimport {\r\n  MessagesActionTypes,\r\n  SET_MESSAGES,\r\n  SET_TYPING_NOTIFICATIONS,\r\n  SET_TYPING_USERS,\r\n  SET_FAILED_MESSAGES\r\n} from '../actions/MessagesAction';\r\n\r\nexport interface MessagesState {\r\n  messages: ClientChatMessage[];\r\n  typingNotifications: any;\r\n  typingUsers: ChatParticipant[];\r\n  failedMessages: string[];\r\n}\r\n\r\n// model that allows us to track a message before its replicated on the server\r\n// it also allows us to maintain state if the message was properly sent or not\r\nexport interface ClientChatMessage {\r\n  clientMessageId?: string;\r\n  sender?: CommunicationIdentifierKind;\r\n  senderDisplayName?: string;\r\n  content?: { message?: string };\r\n  createdOn: Date;\r\n  id?: string;\r\n  failed?: boolean;\r\n}\r\n\r\nconst initMessagesState: MessagesState = {\r\n  messages: [],\r\n  typingNotifications: {},\r\n  typingUsers: [],\r\n  failedMessages: []\r\n};\r\n\r\nexport const MessagesReducer = (state = initMessagesState, action: MessagesActionTypes) => {\r\n  switch (action.type) {\r\n    case SET_MESSAGES:\r\n      return {\r\n        ...state,\r\n        messages: [...action.messages]\r\n      };\r\n    case SET_TYPING_NOTIFICATIONS:\r\n      return {\r\n        ...state,\r\n        typingNotifications: {\r\n          ...state.typingNotifications,\r\n          [action.id]: action.typingNotification\r\n        }\r\n      };\r\n    case SET_TYPING_USERS:\r\n      return {\r\n        ...state,\r\n        typingUsers: [...action.typingUsers]\r\n      };\r\n    case SET_FAILED_MESSAGES:\r\n      return {\r\n        ...state,\r\n        failedMessages: [...action.failedMessages]\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { GUID_FOR_INITIAL_TOPIC_NAME } from '../../constants';\nimport { SET_THREAD_TOPIC_NAME, SET_THREAD_ID, ThreadActionTypes } from '../actions/ThreadAction';\n\nexport interface ThreadState {\n  topic: string;\n  threadId: string | undefined;\n}\n\nconst initThreadState: ThreadState = {\n  topic: GUID_FOR_INITIAL_TOPIC_NAME,\n  threadId: undefined\n};\n\nexport const ThreadReducer = (state = initThreadState, action: ThreadActionTypes) => {\n  switch (action.type) {\n    case SET_THREAD_TOPIC_NAME:\n      return {\n        ...state,\n        topic: action.topicName\n      };\n    case SET_THREAD_ID:\n      return {\n        ...state,\n        threadId: action.threadId\n      };\n    default:\n      return state;\n  }\n};\n","import { ChatParticipant } from '@azure/communication-chat';\n\nimport {\n  SET_THREAD_MEMBERS,\n  SET_THREAD_MEMBERS_ERROR,\n  ThreadMembersActionTypes,\n  SET_REMOVED_FROM_THREAD\n} from '../actions/ThreadMembersAction';\n\nexport interface ThreadMembersState {\n  threadMembers: ChatParticipant[];\n  error?: boolean;\n  isRemoved: boolean;\n}\n\nconst initState: ThreadMembersState = {\n  threadMembers: [],\n  error: false,\n  isRemoved: false\n};\n\nexport const ThreadMembersReducer = (state = initState, action: ThreadMembersActionTypes) => {\n  switch (action.type) {\n    case SET_THREAD_MEMBERS:\n      return {\n        ...state,\n        threadMembers: [...action.threadMembers]\n      };\n    case SET_THREAD_MEMBERS_ERROR:\n      return {\n        ...state,\n        error: true\n      };\n    case SET_REMOVED_FROM_THREAD:\n      return {\n        ...state,\n        isRemoved: action.isRemoved\n      };\n    default:\n      return state;\n  }\n};\n","import { Reducer } from 'redux';\nimport { AudioDeviceInfo, VideoDeviceInfo, DeviceManager } from '@azure/communication-calling';\nimport {\n  SET_DEVICE_MANAGER,\n  SET_AUDIO_DEVICE_INFO,\n  SET_AUDIO_DEVICE_LIST,\n  SET_CAMERA_PERMISSION,\n  SET_MICROPHONE_PERMISSION,\n  SET_VIDEO_DEVICE_INFO,\n  SET_VIDEO_DEVICE_LIST,\n  DeviceTypes\n} from '../actions/devices';\n\nexport interface DevicesState {\n  deviceManager?: DeviceManager;\n  audioDeviceInfo?: AudioDeviceInfo;\n  videoDeviceInfo?: VideoDeviceInfo;\n  audioDeviceList: AudioDeviceInfo[];\n  videoDeviceList: VideoDeviceInfo[];\n  cameraPermission?: string;\n  microphonePermission?: string;\n}\n\nconst initialState: DevicesState = {\n  deviceManager: undefined,\n  audioDeviceInfo: undefined,\n  videoDeviceInfo: undefined,\n  audioDeviceList: [],\n  videoDeviceList: [],\n  cameraPermission: undefined,\n  microphonePermission: undefined\n};\n\nexport const devicesReducer: Reducer<DevicesState, DeviceTypes> = (\n  state = initialState,\n  action: DeviceTypes\n): DevicesState => {\n  switch (action.type) {\n    case SET_DEVICE_MANAGER:\n      return { ...state, deviceManager: action.deviceManager };\n    case SET_VIDEO_DEVICE_INFO:\n      return { ...state, videoDeviceInfo: action.videoDeviceInfo };\n    case SET_AUDIO_DEVICE_INFO:\n      return { ...state, audioDeviceInfo: action.audioDeviceInfo };\n    case SET_VIDEO_DEVICE_LIST:\n      return { ...state, videoDeviceList: action.videoDeviceList };\n    case SET_AUDIO_DEVICE_LIST:\n      return { ...state, audioDeviceList: action.audioDeviceList };\n    case SET_CAMERA_PERMISSION:\n      return { ...state, cameraPermission: action.cameraPermission };\n    case SET_MICROPHONE_PERMISSION:\n      return { ...state, microphonePermission: action.microphonePermission };\n    default:\n      return state;\n  }\n};\n","import { Reducer } from 'redux';\nimport { ParticipantStream } from './index';\nimport { ADD_SCREENSHARE_STREAM, StreamTypes, REMOVE_SCREENSHARE_STREAM } from '../actions/streams';\nimport { DeviceTypes } from '../actions/devices';\n\nexport interface StreamsState {\n  screenShareStreams: ParticipantStream[];\n  localVideoRendererIsBusy: boolean;\n}\n\nconst initialState: StreamsState = {\n  localVideoRendererIsBusy: false,\n  screenShareStreams: []\n};\n\nexport const streamsReducer: Reducer<StreamsState, StreamTypes | DeviceTypes> = (\n  state = initialState,\n  action: StreamTypes | DeviceTypes\n): StreamsState => {\n  switch (action.type) {\n    case ADD_SCREENSHARE_STREAM:\n      const newScreenShareStream: ParticipantStream = { stream: action.stream, user: action.user };\n      return { ...state, screenShareStreams: [...state.screenShareStreams, newScreenShareStream] };\n    case REMOVE_SCREENSHARE_STREAM:\n      const screenShareStreams = state.screenShareStreams.filter(\n        (stream) => stream.stream !== action.stream && stream.user !== action.user\n      );\n      return { ...state, screenShareStreams };\n    default:\n      return state;\n  }\n};\n","import { Reducer } from 'redux';\nimport { SET_MIC, SET_SHARE_SCREEN, ControlTypes } from '../actions/controls';\n\nexport interface ControlsState {\n  mic: boolean;\n  localVideo: boolean;\n  shareScreen: boolean;\n}\n\nconst initialState: ControlsState = {\n  mic: false,\n  localVideo: false,\n  shareScreen: false\n};\n\nexport const controlsReducer: Reducer<ControlsState, ControlTypes> = (\n  state = initialState,\n  action: ControlTypes\n): ControlsState => {\n  switch (action.type) {\n    case SET_MIC:\n      return { ...state, mic: action.mic };\n    case SET_SHARE_SCREEN:\n      return { ...state, shareScreen: action.shareScreen };\n    default:\n      return state;\n  }\n};\n","import { CallClient } from '@azure/communication-calling';\nimport { Reducer } from 'redux';\nimport { SET_USERID, SdkTypes, SET_CALL_CLIENT, SET_DISPLAY_NAME } from '../actions/sdk';\n\nexport interface SdkState {\n  userId?: string;\n  callClient?: CallClient;\n  displayName: string;\n}\n\nconst initialState: SdkState = {\n  displayName: ''\n};\n\nexport const sdkReducer: Reducer<SdkState, SdkTypes> = (state = initialState, action: SdkTypes): SdkState => {\n  switch (action.type) {\n    case SET_USERID:\n      return { ...state, userId: action.userId };\n    case SET_CALL_CLIENT:\n      return { ...state, callClient: action.callClient };\n    case SET_DISPLAY_NAME:\n      return { ...state, displayName: action.displayName };\n    default:\n      return state;\n  }\n};\n","import { Call, CallEndReason, RemoteParticipant, CallAgent } from '@azure/communication-calling';\nimport { SelectionState } from '../RemoteStreamSelector';\nimport { Reducer } from 'redux';\nimport {\n  CALL_ADDED,\n  CALL_REMOVED,\n  SET_CALL_STATE,\n  SET_GROUP,\n  SET_DOMINANT_PARTICIPANTS,\n  SET_PARTICIPANTS,\n  CallTypes,\n  SET_CALL_AGENT\n} from '../actions/calls';\n\nexport interface CallsState {\n  callAgent?: CallAgent;\n  group: string;\n  call?: Call;\n  callState: string;\n  incomingCallEndReason: CallEndReason | undefined;\n  groupCallEndReason: CallEndReason | undefined;\n  remoteParticipants: RemoteParticipant[];\n  attempts: number;\n  dominantParticipants: SelectionState[];\n}\n\nconst initialState: CallsState = {\n  callAgent: undefined,\n  call: undefined,\n  callState: 'None',\n  incomingCallEndReason: undefined,\n  groupCallEndReason: undefined,\n  remoteParticipants: [],\n  dominantParticipants: [],\n  group: '',\n  attempts: 0\n};\n\nexport const callsReducer: Reducer<CallsState, CallTypes> = (state = initialState, action: CallTypes): CallsState => {\n  switch (action.type) {\n    case SET_CALL_AGENT:\n      return { ...state, callAgent: action.callAgent };\n    case CALL_ADDED:\n      return { ...state, call: action.call };\n    case CALL_REMOVED:\n      return {\n        ...state,\n        call: undefined,\n        remoteParticipants: [],\n        incomingCallEndReason: action.incomingCallEndReason,\n        groupCallEndReason: action.groupCallEndReason\n      };\n    case SET_CALL_STATE:\n      return { ...state, callState: action.callState };\n    case SET_DOMINANT_PARTICIPANTS:\n      return { ...state, dominantParticipants: action.dominantParticipants };\n    case SET_PARTICIPANTS:\n      return { ...state, remoteParticipants: action.remoteParticipants };\n    case SET_GROUP:\n      return { ...state, group: action.group };\n    default:\n      return state;\n  }\n};\n","import { combineReducers, Reducer } from 'redux';\n\nimport { ContosoActionTypes } from '../actions/ContosoClientAction';\nimport { ConversationsActionTypes } from '../actions/ConversationsAction';\nimport { MessagesActionTypes } from '../actions/MessagesAction';\nimport { ThreadActionTypes } from '../actions/ThreadAction';\nimport { ThreadMembersActionTypes } from '../actions/ThreadMembersAction';\nimport { ContosoReducer, ContosoState } from './ContosoClientReducers';\nimport { ConversationsReducer, ConversationsState } from './ConversationsReducers';\nimport { MessagesReducer, MessagesState } from './MessagesReducer';\nimport { ThreadReducer, ThreadState } from './ThreadReducers';\nimport { ThreadMembersReducer, ThreadMembersState } from './ThreadMembersReducers';\nimport { RemoteParticipant, RemoteVideoStream } from '@azure/communication-calling';\nimport { devicesReducer, DevicesState } from '../reducers/devices';\nimport { streamsReducer, StreamsState } from './streams';\nimport { controlsReducer, ControlsState } from './controls';\nimport { SdkState, sdkReducer } from './sdk';\nimport { CallsState, callsReducer } from './calls';\nimport { CallTypes } from '../actions/calls';\nimport { ControlTypes } from '../actions/controls';\nimport { DeviceTypes } from '../actions/devices';\nimport { SdkTypes } from '../actions/sdk';\nimport { StreamTypes } from '../actions/streams';\n\nexport interface State {\n  chat: MessagesState;\n  contosoClient: ContosoState;\n  conversations: ConversationsState;\n  thread: ThreadState;\n  threadMembers: ThreadMembersState;\n  calls: CallsState;\n  devices: DevicesState;\n  streams: StreamsState;\n  controls: ControlsState;\n  sdk: SdkState;\n}\n\nexport interface ParticipantStream {\n  user: RemoteParticipant;\n  stream: RemoteVideoStream | undefined;\n}\n\ntype TotalActions =\n  | MessagesActionTypes\n  | ContosoActionTypes\n  | ConversationsActionTypes\n  | ThreadActionTypes\n  | ThreadMembersActionTypes\n  | CallTypes \n  | ControlTypes \n  | DeviceTypes \n  | SdkTypes \n  | StreamTypes;\n\nexport const reducer : Reducer<State, TotalActions> = combineReducers({\n  chat: MessagesReducer,\n  contosoClient: ContosoReducer,\n  conversations: ConversationsReducer,\n  thread: ThreadReducer,\n  threadMembers: ThreadMembersReducer,\n  calls: callsReducer,\n  devices: devicesReducer,\n  streams: streamsReducer,\n  controls: controlsReducer,\n  sdk: sdkReducer\n});\n","import { mergeStyles, getTheme } from '@fluentui/react';\n\nconst MODERATE_RED = '#d74654';\nconst palette = getTheme().palette;\nexport const mediaControlStyles = mergeStyles({\n  height: '3.75rem',\n  padding: '0 0.8125rem',\n  display: 'inline-block',\n  borderRadius: 7,\n  overflow: 'hidden'\n});\nexport const controlButtonStyle = mergeStyles({\n  backgroundColor: palette.white,\n  width: '2rem',\n  height: '3.75rem',\n  border: '0.125rem',\n  borderRadius: 2,\n  marginRight: '0.4375rem',\n  color: palette.neutralSecondary\n});\nexport const controlButtonDisabledStyle = mergeStyles(controlButtonStyle, {\n  color: palette.neutralLight\n});\nexport const endCallButtonStyle = mergeStyles({\n  backgroundColor: MODERATE_RED,\n  width: '6.5625rem',\n  height: '2.1875rem',\n  border: '0.125rem',\n  marginRight: '0.75rem',\n  marginLeft: '0.75rem',\n  borderRadius: 2,\n  color: palette.white,\n  selectors: {\n    ':focus': { color: palette.white },\n    ':hover': { color: palette.white },\n    ':active': { color: palette.white }\n  }\n});\nexport const endCallButtonTextStyle = mergeStyles({\n  color: palette.white,\n  padding: '0.3125rem',\n  fontSize: '0.875rem',\n  lineHeight: '3.75rem'\n});\nexport const fullWidth = mergeStyles({\n  width: '100%'\n});\n","import * as React from 'react';\nimport { Stack, CommandButton } from '@fluentui/react';\nimport {\n  MicIcon,\n  MicOffIcon,\n  CallVideoIcon,\n  CallVideoOffIcon,\n  CallEndIcon,\n  CallControlPresentNewIcon,\n  CallControlCloseTrayIcon\n} from '@fluentui/react-icons-northstar';\nimport {\n  controlButtonStyle,\n  endCallButtonStyle,\n  endCallButtonTextStyle,\n  mediaControlStyles,\n  fullWidth,\n  controlButtonDisabledStyle\n} from './styles/MediaControls.styles';\nimport { ParticipantStream } from '../core/reducers';\n\nexport interface MediaControlsProps {\n  micActive: boolean;\n  screenShareActive: boolean;\n  activeScreenShareStream: ParticipantStream | undefined;\n  cameraActive: boolean;\n  cameraPermission: string;\n  microphonePermission: string;\n  localVideoRendererIsBusy: boolean;\n  compressedMode: boolean;\n  onMicChange(): void;\n  onCameraChange(): void;\n  onScreenShareChange(): void;\n  onEndCallClick(): void;\n  isLocalScreenShareSupportedInBrowser(): boolean;\n}\n\nexport default (props: MediaControlsProps): JSX.Element => {\n  const cameraActive = props.cameraPermission === 'Denied' ? false : props.cameraActive;\n  const cameraDisabled = props.cameraPermission === 'Denied';\n  const cameraOnClick = props.cameraPermission !== 'Denied' ? props.onCameraChange : undefined;\n  const micActive = props.microphonePermission === 'Denied' ? false : props.micActive;\n  const micDisabled = props.microphonePermission === 'Denied';\n  const micOnClick = props.microphonePermission !== 'Denied' ? props.onMicChange : undefined;\n  const screenShareDisabled = !!props.activeScreenShareStream;\n\n  return (\n    <Stack className={mediaControlStyles}>\n      <CommandButton\n        onKeyDownCapture={(e): void => {\n          if (e.keyCode === 13 && props.localVideoRendererIsBusy) {\n            e.preventDefault();\n          }\n        }}\n        disabled={cameraDisabled}\n        onClick={cameraOnClick}\n        className={controlButtonStyle}\n      >\n        <div className={fullWidth}>\n          {cameraActive ? <CallVideoIcon size=\"medium\" /> : <CallVideoOffIcon size=\"medium\" />}\n        </div>\n      </CommandButton>\n      <CommandButton onClick={micOnClick} disabled={micDisabled} className={controlButtonStyle}>\n        <div className={fullWidth}>{micActive ? <MicIcon size=\"medium\" /> : <MicOffIcon size=\"medium\" />}</div>\n      </CommandButton>\n      {props.isLocalScreenShareSupportedInBrowser() && (\n        <CommandButton\n          disabled={screenShareDisabled}\n          onClick={props.onScreenShareChange}\n          className={screenShareDisabled ? controlButtonDisabledStyle : controlButtonStyle}\n        >\n          <div className={fullWidth}>\n            {props.screenShareActive ? (\n              <CallControlCloseTrayIcon size=\"medium\" />\n            ) : (\n              <CallControlPresentNewIcon size=\"medium\" />\n            )}\n          </div>\n        </CommandButton>\n      )}\n      <CommandButton\n        onClick={props.onEndCallClick}\n        className={props.compressedMode ? controlButtonStyle : endCallButtonStyle}\n      >\n        <div className={fullWidth}>\n          <CallEndIcon size=\"medium\" />\n          {!props.compressedMode && <span className={endCallButtonTextStyle}>Leave</span>}\n        </div>\n      </CommandButton>\n    </Stack>\n  );\n};\n","import { mergeStyles, IStackTokens, IPersonaStyles, IButtonStyles } from '@fluentui/react';\n\nconst BLACK = '#000000';\nexport const itemStyles: Partial<IPersonaStyles> = {\n  root: {\n    minWidth: 0,\n    padding: '0 0.25rem',\n    alignSelf: 'stretch',\n    height: 'auto',\n    width: '12.5rem'\n  },\n  primaryText: {\n    color: BLACK\n  }\n};\nexport const overFlowButtonStyles: IButtonStyles = {\n  root: {\n    minWidth: 0,\n    padding: '0 0.25rem',\n    alignSelf: 'stretch',\n    height: 'auto'\n  }\n};\nexport const participantStackStyle = mergeStyles({\n  maxHeight: '100%',\n  overflow: 'auto',\n  paddingLeft: '1.125rem',\n  paddingRight: '1.125rem'\n});\nexport const iconStyle = mergeStyles({\n  margin: '0.4375rem',\n  fontSize: '1rem'\n});\nexport const participantStackTokens: IStackTokens = {\n  childrenGap: '0.625rem',\n  padding: '0.625rem'\n};\n","import * as React from 'react';\nimport { Persona, PersonaSize, Stack, IconButton, PersonaPresence, FontIcon, OverflowSet } from '@fluentui/react';\nimport {\n  itemStyles,\n  participantStackStyle,\n  participantStackTokens,\n  overFlowButtonStyles,\n  iconStyle\n} from './styles/ParticipantStack.styles';\nimport { RemoteParticipant, Call } from '@azure/communication-calling';\nimport { ParticipantStream } from '../core/reducers';\nimport { utils } from '../utils/utils';\nimport { MicIcon, MicOffIcon } from '@fluentui/react-icons-northstar';\n\nexport interface ParticipantStackProps {\n  userId: string;\n  displayName: string;\n  call: Call;\n  callState: string;\n  screenShareStreams: ParticipantStream[];\n  remoteParticipants: RemoteParticipant[];\n}\nexport interface CallParticipant {\n  key: string;\n  name: string;\n  participant: RemoteParticipant | undefined;\n  state: string;\n  isScreenSharing: boolean;\n  isSpeaking: boolean;\n}\n\nconst onRenderItem = (item: any): JSX.Element => (\n  <>\n    <Persona\n      text={item.name}\n      styles={itemStyles}\n      size={PersonaSize.size32}\n      presence={item.state === 'Connected' ? PersonaPresence.online : PersonaPresence.offline}\n    />\n    {item.isSpeaking ? <MicIcon size=\"medium\" /> : <MicOffIcon size=\"medium\" />}\n    {item.isScreenSharing && <FontIcon className={iconStyle} iconName=\"ScreenCast\" />}\n  </>\n);\nconst onRenderOverflowButton = (overflowItems: any): JSX.Element => (\n  <IconButton\n    role=\"menuitem\"\n    title=\"More options\"\n    styles={overFlowButtonStyles}\n    menuIconProps={{ iconName: 'More' }}\n    menuProps={{ items: overflowItems }}\n  />\n);\nconst getParticipants = (participants: CallParticipant[]): JSX.Element[] =>\n  participants.map((item, i) => (\n    <OverflowSet\n      key={i}\n      items={[item]}\n      role=\"menubar\"\n      vertical={false}\n      onRenderOverflowButton={onRenderOverflowButton}\n      onRenderItem={onRenderItem}\n    />\n  ));\nexport default (props: ParticipantStackProps): JSX.Element => {\n  const activeScreenShareStream = props.screenShareStreams && props.screenShareStreams.length === 1;\n  const screenShareStream = props.screenShareStreams[0];\n  const participants: CallParticipant[] = props.remoteParticipants.map((participant) => {\n    const isScreenSharing = activeScreenShareStream ? screenShareStream.user === participant : false;\n    return {\n      key: utils.getId(participant.identifier),\n      name: participant.displayName ?? utils.getId(participant.identifier),\n      participant: participant,\n      state: participant.state,\n      isScreenSharing: isScreenSharing,\n      isSpeaking: participant.isSpeaking\n    };\n  });\n  participants.push({\n    key: `${props.userId} (You)`,\n    name: `${props.displayName} (You)`,\n    participant: undefined,\n    state: 'Connected',\n    isScreenSharing: activeScreenShareStream ? utils.getId(screenShareStream.user.identifier) === props.userId : false,\n    isSpeaking: !props.call.isMuted\n  });\n  return (\n    <Stack className={participantStackStyle} tokens={participantStackTokens}>\n      {getParticipants(participants)}\n    </Stack>\n  );\n};\n","import { connect } from 'react-redux';\nimport { State } from '../core/reducers';\nimport ParticipantStack from '../components/ParticipantStack';\n\nconst mapStateToProps = (state: State) => ({\n  userId: state.sdk.userId,\n  displayName: state.calls.callAgent?.displayName,\n  call: state.calls.call,\n  callState: state.calls.callState,\n  remoteParticipants: state.calls.remoteParticipants,\n  screenShareStreams: state.streams.screenShareStreams\n});\n\nconst connector: any = connect(mapStateToProps);\nexport default connector(ParticipantStack);\n","import { IStackStyles, mergeStyles, ITextFieldStyles, IStackTokens, getTheme } from '@fluentui/react';\n\nconst palette = getTheme().palette;\nexport const fullHeightStyles: IStackStyles = {\n  root: {\n    height: '100%',\n    overflowY: 'auto'\n  }\n};\nexport const paneFooterStyles: IStackStyles = {\n  root: {\n    marginBottom: '1.25rem'\n  }\n};\nexport const paneFooterTokens: IStackTokens = {\n  childrenGap: '0.3125rem'\n};\nexport const textFieldStyles: Partial<ITextFieldStyles> = {\n  field: {\n    color: palette.neutralSecondary,\n    padding: 0\n  },\n  root: {\n    marginLeft: '1rem',\n    marginRight: '1rem'\n  },\n  fieldGroup: {\n    border: 'none'\n  }\n};\n\nexport const paneHeaderStyle = mergeStyles({\n  height: '4.3125rem'\n});\n\nexport const paneHeaderTextStyle = mergeStyles({\n  fontSize: '1.375rem',\n  fontWeight: 600,\n  width: '69px',\n  float: 'left',\n  margin: '20px'\n});\nexport const footerMainTextStyle = mergeStyles({\n  fontWeight: 600,\n  fontSize: '1rem',\n  marginLeft: '1rem',\n  marginRight: '1rem'\n});\nexport const copyLinkButtonStyle = mergeStyles({\n  fontWeight: 600,\n  fontSize: '0.875rem', // 14px\n  height: '2.5rem',\n  marginLeft: '1rem',\n  marginRight: '1rem',\n  width: '90%'\n});\nexport const copyIconStyle = mergeStyles({\n  marginRight: '0.5em'\n});\nexport const settingsContainerStyle = mergeStyles({\n  marginLeft: '1.25rem',\n  width: '15.375rem'\n});\n","import React from 'react';\nimport { Stack, Icon, PrimaryButton, TextField, Separator } from '@fluentui/react';\nimport {\n  paneFooterStyles,\n  paneFooterTokens,\n  footerMainTextStyle,\n  textFieldStyles,\n  copyLinkButtonStyle,\n  copyIconStyle\n} from './styles/CommandPanel.styles';\n\nconst invitePeopleString = 'Invite people to join';\nconst copyJoinInfoString = 'Copy join info';\n\nconst copyJoinLink = (): void => {\n  const inputElement = document.getElementById('inputText') as HTMLInputElement;\n  inputElement.select();\n  document.execCommand('copy');\n};\n\nexport default (): JSX.Element => {\n  return (\n    <Stack styles={paneFooterStyles} tokens={paneFooterTokens}>\n      <Separator />\n      <div className={footerMainTextStyle}>{invitePeopleString}</div>\n      <TextField styles={textFieldStyles} id=\"inputText\" type=\"text\" value={`${document.baseURI}`}></TextField>\n      <PrimaryButton className={copyLinkButtonStyle} onClick={copyJoinLink}>\n        <Icon iconName=\"Copy\" className={copyIconStyle} />\n        {copyJoinInfoString}\n      </PrimaryButton>\n    </Stack>\n  );\n};\n","import { mergeStyles, IPivotStyles, getTheme } from '@fluentui/react';\n\nconst headerShadow = 'rgba(0, 0, 0, 0.133) 0px 1.6px 3.6px 0px, rgba(0, 0, 0, 0.11) 0px 0.3px 0.9px 0px';\nconst palette = getTheme().palette;\nexport const pivotItemStyles: Partial<IPivotStyles> = {\n  linkIsSelected: {\n    padding: 0,\n    marginRight: 0,\n    height: '100%',\n    color: palette.themePrimary,\n    selectors: {\n      ':hover': { color: palette.themePrimary }\n    }\n  },\n  link: { padding: 0, marginRight: 0, height: '3.75rem' },\n  root: { width: '5.25rem', height: '3.75rem', display: 'inline-block', verticalAlign: 'top' }\n};\nexport const pivotContainerStyle = mergeStyles({\n  display: 'inline-block'\n});\nexport const headerContainer = mergeStyles({\n  width: '100%',\n  height: '3.875rem',\n  padding: '0.0625rem 0',\n  boxShadow: headerShadow,\n  overflow: 'hidden',\n  flexDirection: 'row',\n  justifyContent: 'flex-end',\n  alignItems: 'center',\n  marginBottom: 2\n});\nexport const headerCenteredContainer = mergeStyles(headerContainer, {\n  justifyContent: 'center'\n});\n\nexport const separatorContainerStyle = mergeStyles({\n  display: 'inline-block',\n  padding: '0 1rem',\n  height: '1.875rem'\n});\nexport const pivotItemStyle = mergeStyles({\n  padding: '0 0.8125rem'\n});\nexport const separatorStyles = {\n  root: {\n    color: palette.neutralLight,\n    width: '0.0625rem' // 1px\n  }\n};\n","import { connect } from 'react-redux';\nimport Header, { HeaderProps } from '../components/Header';\nimport { setMicrophone, setShareUnshareScreen, endCall } from '../core/sideEffects';\nimport { utils } from '../utils/utils';\nimport { Constants } from '../core/constants';\nimport { State } from '../core/reducers';\n\nconst mapStateToProps = (state: State, props: HeaderProps) => ({\n  actionable:\n    state.calls.callState === Constants.INCOMING ||\n    state.calls.callState === Constants.RINGING ||\n    state.calls.callState === Constants.CONNECTING ||\n    state.calls.callState === Constants.CONNECTED,\n  mic: state.controls.mic,\n  call: state.calls.call,\n  shareScreen: state.controls.shareScreen,\n  endCall: (): void => {\n    state.calls.call && endCall(state.calls.call, { forEveryone: false });\n    props.endCallHandler();\n  },\n  videoDeviceInfo: state.devices.videoDeviceInfo,\n  screenWidth: props.screenWidth,\n  screenShareStreams: state.streams.screenShareStreams,\n  localVideoRendererIsBusy: state.streams.localVideoRendererIsBusy,\n  cameraPermission: state.devices.cameraPermission,\n  microphonePermission: state.devices.microphonePermission\n});\n\nconst mapDispatchToProps = (dispatch: any) => ({\n  setMic: (mic: boolean): void => dispatch(setMicrophone(mic)),\n  setScreenShare: (screenShare: boolean): void => dispatch(setShareUnshareScreen(screenShare)),\n  // Only support Desktop -- Chrome | Edge (Chromium) | Safari\n  isLocalScreenShareSupportedInBrowser: (): boolean => {\n    return (true);\n  }\n});\n\nconst connector: any = connect(mapStateToProps, mapDispatchToProps);\nexport default connector(Header);\n","import React, { useEffect } from 'react';\nimport { Separator, Pivot, PivotItem, Stack } from '@fluentui/react';\nimport { Call, LocalVideoStream, VideoDeviceInfo } from '@azure/communication-calling';\nimport MediaControls from './MediaControls';\nimport { CommandPanelTypes } from './CommandPanel';\nimport { UserFriendsIcon, SettingsIcon } from '@fluentui/react-icons-northstar';\nimport { Constants } from '../core/constants';\nimport {\n  headerContainer,\n  pivotItemStyles,\n  separatorContainerStyle,\n  separatorStyles,\n  pivotItemStyle,\n  headerCenteredContainer\n} from './styles/Header.styles';\nimport { ParticipantStream } from '../core/reducers';\n\nexport interface HeaderProps {\n  selectedPane: CommandPanelTypes;\n  setSelectedPane: any;\n  endCallHandler(): void;\n  actionable: boolean;\n  localVideo: boolean;\n  mic: boolean;\n  shareScreen: boolean;\n  call: Call;\n  endCall(): void;\n  screenShareStreams: ParticipantStream[];\n  activeScreenShareStream: ParticipantStream | undefined;\n  localVideoRendererIsBusy: boolean;\n  cameraPermission: string;\n  microphonePermission: string;\n  screenWidth: number;\n  setMic(mic: boolean): void;\n  setLocalVideoStream(localVideoStream: LocalVideoStream | undefined): void;\n  setScreenShare(screenShare: boolean): void;\n  isLocalScreenShareSupportedInBrowser(): boolean;\n  localVideoStream: LocalVideoStream | undefined;\n  videoDeviceInfo: VideoDeviceInfo | undefined;\n}\n\nexport default (props: HeaderProps): JSX.Element => {\n  const togglePeople = (selectedPane: string, setSelectedPane: (pane: string) => void): void => {\n    return selectedPane !== CommandPanelTypes.People\n      ? setSelectedPane(CommandPanelTypes.People)\n      : setSelectedPane(CommandPanelTypes.None);\n  };\n\n  const toggleOptions = (selectedPane: string, setSelectedPane: (pane: string) => void): void => {\n    return selectedPane !== CommandPanelTypes.Settings\n      ? setSelectedPane(CommandPanelTypes.Settings)\n      : setSelectedPane(CommandPanelTypes.None);\n  };\n\n  const handleLocalVideoOnOff = async (): Promise<void> => {\n    if (props.localVideoStream) {\n      await props.call.stopVideo(props.localVideoStream);\n      props.setLocalVideoStream(undefined);\n    } else {\n      if (props.videoDeviceInfo) {\n        const localVideoStream = new LocalVideoStream(props.videoDeviceInfo);\n        props.setLocalVideoStream(localVideoStream);\n        await props.call.startVideo(localVideoStream);\n      }\n    }\n  };\n\n  const handleMuteOnOff = (): void => {\n    props.setMic(!props.mic);\n  };\n\n  const handleScreenSharingOnOff = (): void => {\n    props.setScreenShare(!props.shareScreen);\n  };\n\n  useEffect(() => {\n    if (props.call && props.call.localVideoStreams.length === 0 && props.localVideoStream) {\n      props.call.startVideo(props.localVideoStream);\n    }\n  }, [props.call, props.localVideoStream]);\n\n  return (\n    <Stack\n      id=\"header\"\n      className={props.screenWidth > Constants.MINI_HEADER_WINDOW_WIDTH ? headerContainer : headerCenteredContainer}\n    >\n      <Pivot\n        onKeyDownCapture={(e): void => {\n          if ((e.target as HTMLElement).id === CommandPanelTypes.People && e.keyCode === 39) e.preventDefault();\n        }}\n        getTabId={(itemKey: string): string => itemKey}\n        onLinkClick={(item): void => {\n          if (!item) return;\n          if (item.props.itemKey === CommandPanelTypes.Settings)\n            toggleOptions(props.selectedPane, props.setSelectedPane);\n          if (item.props.itemKey === CommandPanelTypes.People) togglePeople(props.selectedPane, props.setSelectedPane);\n        }}\n        styles={pivotItemStyles}\n        initialSelectedKey={CommandPanelTypes.None}\n        selectedKey={props.selectedPane}\n      >\n        <PivotItem\n          itemKey={CommandPanelTypes.Settings}\n          onRenderItemLink={(): JSX.Element => (\n            <SettingsIcon\n              outline={props.selectedPane === CommandPanelTypes.Settings ? false : true}\n              size=\"medium\"\n              className={pivotItemStyle}\n            />\n          )}\n        />\n        <PivotItem\n          itemKey={CommandPanelTypes.People}\n          onRenderItemLink={(): JSX.Element => (\n            <UserFriendsIcon\n              outline={props.selectedPane === CommandPanelTypes.People ? false : true}\n              size=\"medium\"\n              className={pivotItemStyle}\n            />\n          )}\n        />\n        <PivotItem itemKey={CommandPanelTypes.None} />\n      </Pivot>\n      {props.screenWidth > Constants.MINI_HEADER_WINDOW_WIDTH && (\n        <div className={separatorContainerStyle}>\n          <Separator styles={separatorStyles} vertical={true} />\n        </div>\n      )}\n      <MediaControls\n        micActive={props.mic}\n        onMicChange={handleMuteOnOff}\n        cameraActive={props.localVideoStream !== undefined}\n        onCameraChange={handleLocalVideoOnOff}\n        screenShareActive={props.shareScreen}\n        activeScreenShareStream={props.screenShareStreams[0] ?? undefined}\n        onScreenShareChange={handleScreenSharingOnOff}\n        onEndCallClick={(): void => {\n          if (props.localVideo) handleLocalVideoOnOff();\n          props.endCall();\n        }}\n        cameraPermission={props.cameraPermission}\n        microphonePermission={props.microphonePermission}\n        localVideoRendererIsBusy={props.localVideoRendererIsBusy}\n        compressedMode={props.screenWidth <= Constants.MINI_HEADER_WINDOW_WIDTH}\n        isLocalScreenShareSupportedInBrowser={props.isLocalScreenShareSupportedInBrowser}\n      />\n    </Stack>\n  );\n};\n","import { mergeStyles, getTheme } from '@fluentui/react';\n\nconst palette = getTheme().palette;\nexport const mediaGalleryStyle = mergeStyles({\n  padding: '0.4375rem',\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'center',\n  border: 0,\n  borderRight: '1px solid rgba(0,0,0,0.05)',\n  borderBottom: '1px solid rgba(0,0,0,0.05)'\n});\n\nexport const substageMediaGalleryStyle = mergeStyles({\n  padding: '0.4375rem',\n  width: '100px',\n  minWidth: '100px',\n  height: '100px',\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'center',\n  border: 0,\n  borderRight: '1px solid rgba(0,0,0,0.05)',\n  borderBottom: '1px solid rgba(0,0,0,0.05)'\n});\n\nexport const mediaGalleryGridStyle = mergeStyles({\n  height: '100%',\n  background: palette.neutralLighterAlt,\n  display: 'grid',\n  overflow: 'hidden'\n});\n\nexport const mediaGallerySubstageStyle = mergeStyles({\n  height: '8.438rem',\n  overflowX: 'auto',\n  overflowY: 'hidden'\n});\n","import { mergeStyles, getTheme } from '@fluentui/react';\n\nconst palette = getTheme().palette;\nexport const videoHint = mergeStyles({\n  backgroundColor: palette.neutralSecondary,\n  bottom: '5%',\n  height: '1.75rem',\n  boxShadow: '0 0 1px 0 rgba(0,0,0,.16)',\n  color: palette.neutralLighter,\n  fontSize: '1.25rem',\n  lineHeight: '1.0625rem',\n  textAlign: 'left',\n  left: '2%',\n  overflow: 'hidden',\n  position: 'absolute',\n  padding: '0.25rem',\n  whiteSpace: 'nowrap',\n  maxWidth: '95%',\n  borderRadius: 4,\n  textOverflow: 'ellipsis'\n});\nexport const mediaContainer = mergeStyles({\n  position: 'relative',\n  height: '100%',\n  width: '100%',\n  background: 'transparent'\n});\nexport const localVideoContainerStyle = mergeStyles(mediaContainer, {\n  width: '100%',\n  height: '100%'\n});\n","\n\nimport React, { useEffect, useRef, useState } from 'react';\nimport { Image, ImageFit, Label } from '@fluentui/react';\nimport { LocalVideoStream, VideoStreamRenderer, VideoStreamRendererView } from '@azure/communication-calling';\nimport { videoHint, mediaContainer, localVideoContainerStyle } from './styles/StreamMedia.styles';\nimport { Constants } from '../core/constants';\nimport staticMediaSVG from '../assets/staticmedia.svg';\n\nexport interface LocalStreamMediaProps {\n  label: string;\n  stream: LocalVideoStream;\n}\n\nexport default (props: LocalStreamMediaProps): JSX.Element => {\n  const rendererViewRef = useRef<VideoStreamRendererView>();\n\n  const [activeStreamBeingRendered, setActiveStreamBeingRendered] = useState(false);\n\n  const imageProps = {\n    src: staticMediaSVG.toString(),\n    imageFit: ImageFit.contain,\n    styles: {\n      root: {\n        width: '100%',\n        height: '100%',\n        display: activeStreamBeingRendered ? 'none' : 'block'\n      }\n    }\n  };\n\n  const { stream, label } = props;\n\n  useEffect(() => {\n    (async (): Promise<void> => {\n      if (stream) {\n        const renderer: VideoStreamRenderer = new VideoStreamRenderer(stream);\n        rendererViewRef.current = await renderer.createView({ scalingMode: 'Crop', isMirrored: true });\n\n        const container = document.getElementById(Constants.LOCAL_VIDEO_PREVIEW_ID);\n\n        if (container && container.childElementCount === 0) {\n          container.appendChild(rendererViewRef.current.target);\n          setActiveStreamBeingRendered(true);\n        }\n      } else {\n        if (rendererViewRef) {\n          rendererViewRef.current?.dispose();\n          setActiveStreamBeingRendered(false);\n        }\n      }\n    })();\n\n    return (): void => {\n      if (rendererViewRef) {\n        rendererViewRef.current?.dispose();\n        rendererViewRef.current = undefined;\n        setActiveStreamBeingRendered(false);\n      }\n    };\n  }, [stream]);\n\n  return (\n    <div className={mediaContainer}>\n      <div\n        style={{ display: activeStreamBeingRendered ? 'block' : 'none' }}\n        className={localVideoContainerStyle}\n        id={Constants.LOCAL_VIDEO_PREVIEW_ID}\n      />\n      <Image {...imageProps} />\n      <Label className={videoHint}>{label}</Label>\n    </div>\n  );\n};\n","\n\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { Label, Spinner, SpinnerSize } from '@fluentui/react';\nimport { RemoteVideoStream, VideoStreamRenderer, VideoStreamRendererView } from '@azure/communication-calling';\nimport { videoHint, mediaContainer } from './styles/StreamMedia.styles';\nimport { utils } from '../utils/utils';\nimport staticMediaSVG from '../assets/staticmedia.svg';\nimport { Image, ImageFit } from '@fluentui/react';\n\nexport interface RemoteStreamMediaProps {\n  label: string;\n  stream: RemoteVideoStream | undefined;\n  isParticipantStreamSelected: boolean;\n}\n\nexport default (props: RemoteStreamMediaProps): JSX.Element => {\n  const rendererViewRef = useRef<VideoStreamRendererView>();\n\n  const streamId = props.stream ? utils.getStreamId(props.label, props.stream) : `${props.label} - no stream`;\n\n  const [activeStreamBeingRendered, setActiveStreamBeingRendered] = useState(false);\n  const [showRenderLoading, setShowRenderLoading] = useState(false);\n\n  const imageProps = {\n    src: staticMediaSVG.toString(),\n    imageFit: ImageFit.contain,\n    styles: {\n      root: {\n        width: '100%',\n        height: '100%',\n        display: activeStreamBeingRendered ? 'none' : 'block'\n      }\n    }\n  };\n\n  const loadingStyle = {\n    height: '100%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center'\n  };\n\n  const { label, stream, isParticipantStreamSelected } = props;\n\n  const renderRemoteStream = useCallback(async () => {\n    const container = document.getElementById(streamId);\n    if (container && stream && stream.isAvailable && isParticipantStreamSelected) {\n      // if we are already rendering a stream we don't want to start rendering the same stream\n      if (activeStreamBeingRendered) {\n        return;\n      }\n\n      // set the flag that a stream is being rendered\n      setActiveStreamBeingRendered(true);\n      setShowRenderLoading(true);\n      const renderer: VideoStreamRenderer = new VideoStreamRenderer(stream);\n      // this can block a really long time if we fail to be subscribed to the call and it has to retry\n      rendererViewRef.current = await renderer.createView({ scalingMode: 'Crop' });\n      setShowRenderLoading(false);\n      if (container && container.childElementCount === 0) {\n        container.appendChild(rendererViewRef.current.target);\n      }\n    } else {\n      setActiveStreamBeingRendered(false);\n\n      if (rendererViewRef.current) {\n        rendererViewRef.current.dispose();\n        rendererViewRef.current = undefined;\n      }\n    }\n  }, [\n    stream,\n    streamId,\n    isParticipantStreamSelected,\n    activeStreamBeingRendered,\n    setShowRenderLoading,\n    setActiveStreamBeingRendered\n  ]);\n\n  useEffect(() => {\n    if (!stream) {\n      return;\n    }\n\n    stream.on('isAvailableChanged', renderRemoteStream);\n\n    if (stream.isAvailable) {\n      renderRemoteStream();\n    }\n  }, [stream, isParticipantStreamSelected, renderRemoteStream]);\n\n  return (\n    <div className={mediaContainer}>\n      <div style={{ display: activeStreamBeingRendered ? 'block' : 'none' }} className={mediaContainer} id={streamId}>\n        {showRenderLoading && <Spinner style={loadingStyle} label={`Rendering stream...`} size={SpinnerSize.xSmall} />}\n      </div>\n      <Image {...imageProps} />\n      <Label className={videoHint}>{label}</Label>\n    </div>\n  );\n};\n","import { connect } from 'react-redux';\nimport MediaGallery from '../components/MediaGallery';\nimport { State } from '../core/reducers';\n\nconst mapStateToProps = (state: State) => ({\n  userId: state.sdk.userId,\n  displayName: state.calls.callAgent?.displayName,\n  remoteParticipants: state.calls.remoteParticipants,\n  dominantParticipants: state.calls.dominantParticipants\n});\n\nconst connector: any = connect(mapStateToProps);\nexport default connector(MediaGallery);\n","import React, { useMemo, useState } from 'react';\nimport {\n  mediaGalleryGridStyle,\n  mediaGalleryStyle,\n  mediaGallerySubstageStyle,\n  substageMediaGalleryStyle\n} from './styles/MediaGallery.styles';\nimport { RemoteParticipant, LocalVideoStream } from '@azure/communication-calling';\nimport { utils } from '../utils/utils';\nimport LocalStreamMedia from './LocalStreamMedia';\nimport RemoteStreamMedia from './RemoteStreamMedia';\nimport { SelectionState } from '../core/RemoteStreamSelector';\nimport { Stack } from '@fluentui/react';\nimport { Constants } from '../core/constants';\n\nexport interface MediaGalleryProps {\n  userId: string;\n  displayName: string;\n  remoteParticipants: RemoteParticipant[];\n  localVideoStream: LocalVideoStream;\n  dominantParticipants: SelectionState[];\n}\n\nexport default (props: MediaGalleryProps): JSX.Element => {\n  const [gridCol, setGridCol] = useState(1);\n  const [gridRow, setGridRow] = useState(1);\n\n  // For now we are only going to support up to a 4x3 grid or 10 participants in a call\n  // Since this is a sample, we will just hard-code how we want the grid to scale\n  // the rows and columns for the number of users in the call\n  const rows = [1, 1, 2, 2, 2, 2, 3, 3, 3, 3];\n  const cols = [1, 2, 2, 2, 3, 3, 3, 3, 3, 4];\n\n  if (Constants.DOMINANT_PARTICIPANTS_COUNT < 0 || Constants.DOMINANT_PARTICIPANTS_COUNT > rows.length - 1) {\n    console.warn(`Please use a value for dominant participants between 0 <= x <= ${rows.length - 1}`);\n  }\n\n  const numRemoteParticipantsToRender = Math.min(Constants.DOMINANT_PARTICIPANTS_COUNT, rows.length - 1);\n\n  const clamp = (num: number, min: number, max: number): number => Math.min(Math.max(num, min), max);\n\n  const getMediaGalleryTilesForParticipants = (\n    participants: RemoteParticipant[],\n    displayName: string\n  ): JSX.Element[] => {\n    const remoteParticipantsMediaGalleryItems = participants.map((participant) => (\n      <div key={`${utils.getId(participant.identifier)}-tile`} className={mediaGalleryStyle}>\n        <RemoteStreamMedia\n          key={utils.getId(participant.identifier)}\n          stream={participant.videoStreams[0]}\n          isParticipantStreamSelected={\n            props.dominantParticipants.filter((p) => p.participantId === utils.getId(participant.identifier)).length > 0\n          }\n          label={participant.displayName ?? utils.getId(participant.identifier)}\n        />\n      </div>\n    ));\n\n    // for now we will always add the local user to the main stage\n    const localParticipantMediaGalleryItem = (\n      <div key=\"localParticipantTile\" className={mediaGalleryStyle}>\n        <LocalStreamMedia label={displayName} stream={props.localVideoStream} />\n      </div>\n    );\n\n    remoteParticipantsMediaGalleryItems.unshift(localParticipantMediaGalleryItem);\n\n    return remoteParticipantsMediaGalleryItems;\n  };\n\n  const getSubstageMediaGalleryTilesForParticipants = (participants: RemoteParticipant[]): JSX.Element[] => {\n    const remoteParticipantsMediaGalleryItems = participants.map((participant) => (\n      <div key={`${utils.getId(participant.identifier)}-tile`} className={substageMediaGalleryStyle}>\n        <RemoteStreamMedia\n          key={utils.getId(participant.identifier)}\n          stream={participant.videoStreams[0]}\n          isParticipantStreamSelected={false}\n          label={participant.displayName ?? utils.getId(participant.identifier)}\n        />\n      </div>\n    ));\n\n    return remoteParticipantsMediaGalleryItems;\n  };\n\n  // determine number of rows/columns to add to the grid\n  const numberStreamsToRender = useMemo(\n    () => clamp(props.remoteParticipants.length, 0, numRemoteParticipantsToRender),\n    [numRemoteParticipantsToRender, props.remoteParticipants.length]\n  );\n  if (cols[numberStreamsToRender] !== gridCol) {\n    if (numberStreamsToRender > cols.length - 1) {\n      throw new Error(\n        `attempting to set up a number of columns in the gallery for an unexpected number of participants ${numberStreamsToRender}`\n      );\n    }\n    setGridCol(cols[numberStreamsToRender]);\n  }\n\n  if (rows[numberStreamsToRender] !== gridRow) {\n    if (numberStreamsToRender > rows.length - 1) {\n      throw new Error(\n        `attempting to set up a number of rows in the gallery for an expected number of participants ${numberStreamsToRender}`\n      );\n    }\n    setGridRow(rows[numberStreamsToRender]);\n  }\n\n  // sort by dominance\n  const participantsToLayout = props.remoteParticipants.sort((a, b) => {\n    const isParticipantADominant =\n      props.dominantParticipants.filter((p) => p.participantId === utils.getId(a.identifier)).length > 0;\n    const isParticipantBDominant =\n      props.dominantParticipants.filter((p) => p.participantId === utils.getId(b.identifier)).length > 0;\n    if (isParticipantADominant && !isParticipantBDominant) {\n      return -1;\n    } else if (!isParticipantADominant && isParticipantBDominant) {\n      return 1;\n    }\n    return 0;\n  });\n\n  const mainStageParticipants = participantsToLayout.slice(0, numRemoteParticipantsToRender);\n  const substageParticipants = participantsToLayout.slice(numRemoteParticipantsToRender);\n  // don't show the substage if its not necessary\n  const isSubstageVisible = substageParticipants.length > 0;\n  return (\n    <Stack style={{ height: '100%' }}>\n      <div\n        id=\"video-gallery\"\n        className={mediaGalleryGridStyle}\n        style={{\n          gridTemplateRows: `repeat(${gridRow}, minmax(0, 1fr))`,\n          gridTemplateColumns: `repeat(${gridCol}, 1fr)`\n        }}\n      >\n        {getMediaGalleryTilesForParticipants(mainStageParticipants, props.displayName)}\n      </div>\n      {isSubstageVisible && (\n        <Stack horizontal className={mediaGallerySubstageStyle}>\n          {getSubstageMediaGalleryTilesForParticipants(substageParticipants)}\n        </Stack>\n      )}\n    </Stack>\n  );\n};\n","import { mergeStyles, getTheme } from '@fluentui/react';\n\nconst palette = getTheme().palette;\nexport const fullScreenStyle = mergeStyles({\n  padding: '0.5em',\n  borderRight: '1px solid rgba(0,0,0,0.05)',\n  height: '100%',\n  width: '100%',\n  background: palette.neutralLighterAlt\n});\n\nexport const hiddenFullScreenStyle = mergeStyles({\n  display: 'none',\n  borderRight: '1px solid rgba(0,0,0,0.05)',\n  height: '100%',\n  width: '100%',\n  background: palette.neutralLighterAlt\n});\n\nexport const loadingStyle = mergeStyles({\n  height: '100%',\n  display: 'flex',\n  justifyContent: 'center'\n});\n","import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { ParticipantStream } from '../core/reducers';\nimport { hiddenFullScreenStyle, fullScreenStyle, loadingStyle } from './styles/MediaFullScreen.styles';\nimport { RemoteVideoStream, VideoStreamRenderer, VideoStreamRendererView } from '@azure/communication-calling';\nimport { Spinner, SpinnerSize } from '@fluentui/react';\nimport { utils } from '../utils/utils';\n\nexport interface MediaFullScreenProps {\n  activeScreenShareStream: ParticipantStream;\n}\n\nexport default (props: MediaFullScreenProps): JSX.Element => {\n  const [loading, setLoading] = useState(true);\n  const fullScreenStreamMediaId = 'fullScreenStreamMediaId';\n  const rendererViewRef = useRef<VideoStreamRendererView>();\n\n  /**\n   * Start stream after DOM has rendered\n   */\n\n  const activeScreenShareStream = props.activeScreenShareStream;\n\n  const renderStreamCallback = useCallback(async () => {\n    if (activeScreenShareStream && activeScreenShareStream.stream) {\n      const stream: RemoteVideoStream = activeScreenShareStream.stream;\n      const renderer: VideoStreamRenderer = new VideoStreamRenderer(stream);\n      rendererViewRef.current = await renderer.createView({ scalingMode: 'Fit' });\n\n      const container = document.getElementById(fullScreenStreamMediaId);\n      if (container && container.childElementCount === 0) {\n        setLoading(false);\n        container.appendChild(rendererViewRef.current.target);\n      }\n    } else {\n      if (rendererViewRef) {\n        rendererViewRef.current?.dispose();\n      }\n    }\n  }, [activeScreenShareStream]);\n\n  useEffect(() => {\n    renderStreamCallback();\n  }, [renderStreamCallback]);\n\n  const displayName =\n    props.activeScreenShareStream.user.displayName ?? utils.getId(props.activeScreenShareStream.user.identifier);\n\n  return (\n    <>\n      {loading && (\n        <div className={loadingStyle}>\n          <Spinner label={`Loading ${displayName}'s screen`} size={SpinnerSize.xSmall} />\n        </div>\n      )}\n      <div id={fullScreenStreamMediaId} className={loading ? hiddenFullScreenStyle : fullScreenStyle}></div>\n    </>\n  );\n};\n","import { IStackItemStyles, IStackStyles, getTheme, mergeStyles } from '@fluentui/react';\n\nconst palette = getTheme().palette;\nexport const headerStyles: IStackItemStyles = {\n  root: {\n    width: '100%'\n  }\n};\nexport const containerStyles: IStackStyles = {\n  root: {\n    height: '100%',\n    minHeight: '9.375rem',\n    width: '100%'\n  }\n};\nexport const paneStyles: IStackItemStyles = {\n  root: {\n    width: '17.875rem'\n  }\n};\nexport const overlayStyles: IStackItemStyles = {\n  root: {\n    background: palette.white,\n    marginTop: '4rem'\n  }\n};\nexport const hiddenContainerClassName: IStackItemStyles = {\n  root: {\n    border: `solid 1px ${palette.neutralLighterAlt}`,\n    height: '100%',\n    display: 'none'\n  }\n};\nexport const activeContainerClassName: IStackItemStyles = {\n  root: {\n    border: `solid 1px ${palette.neutralLighterAlt}`,\n    height: 'calc(100% - 3px)',\n    display: 'initial',\n    width: '100%'\n  }\n};\n\nexport const loadingStyle: IStackItemStyles ={\n  root: {\n    height: '100%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    width: '100%'\n  }  \n};\n\nexport const chatPopupStyle: IStackItemStyles ={\n  root: {\n    display: 'none',\n    position: 'fixed',\n    bottom: '0',\n    left: '15px',\n    border: '3px solid #f1f1f1',\n  }\n};\n\nexport const messageBoxstyle: IStackItemStyles ={\n  root: {\n    \n  }\n}\n// body {box-sizing: border-box;}\n// /* The popup chat - hidden by default */\n// .chat-popup {\n\n// }\n// .message-box {\n// display: none;\n// position: fixed;\n// bottom: 0;\n// left: 15px;\n// border: 3px solid #FFFACD;\n// z-index: 9;\n// }\n// .form-container {\n// max-width: 300px;\n// padding: 10px;\n// background-color: white;\n// }\n// .form-container textarea {\n// width: 90%;\n// padding: 15px;\n// margin: 5px 0 22px 0;\n// border: none;\n// background: #e1e1e1;\n// resize: none;\n// min-height: 50px;\n// }\n// .form-container .btn {\n// background-color: #4CAF40;\n// color: white;\n// padding: 14px 18px;\n// margin-bottom:10px;\n// opacity: 0.6;\n// border: none;\n// cursor: pointer;\n// width: 100%;\n// }\n// .container {\n// border: 1px solid #dedede;\n// background-color: #F1F1F1;\n// border-radius: 3px;\n// padding: 8px;\n// margin: 8px 0;\n// }\n// .darker {\n// border-color: #ccc;\n// background-color: #ffdab9;\n// margin-left: 25px;\n// margin-right: 3px;\n// }\n// .lighter {\n// margin-right: 20px;\n// margin-left: 3px;\n// }\n// .container::after {\n// content: \"\";\n// clear: both;\n// display: table;\n// }\n// </style>\n","import { connect } from 'react-redux';\nimport GroupCall, { GroupCallProps } from '../components/GroupCall';\nimport { setMicrophone } from '../core/sideEffects';\nimport { setVideoDeviceInfo, setAudioDeviceInfo } from '../core/actions/devices';\nimport { AudioDeviceInfo, VideoDeviceInfo } from '@azure/communication-calling';\nimport { State } from '../core/reducers';\n\nconst mapStateToProps = (state: State, props: GroupCallProps) => ({\n  userId: state.sdk.userId,\n  callAgent: state.calls.callAgent,\n  deviceManager: state.devices.deviceManager,\n  group: state.calls.group,\n  screenWidth: props.screenWidth,\n  call: state.calls.call,\n  shareScreen: state.controls.shareScreen,\n  mic: state.controls.mic,\n  groupCallEndReason: state.calls.groupCallEndReason,\n  isGroup: (): boolean | undefined =>\n    state.calls.call && state.calls.call.direction !== 'Incoming' && !!state.calls.group,\n  remoteParticipants: state.calls.remoteParticipants,\n  callState: state.calls.callState,\n  localVideo: state.controls.localVideo,\n  screenShareStreams: state.streams.screenShareStreams,\n  videoDeviceInfo: state.devices.videoDeviceInfo,\n  audioDeviceInfo: state.devices.audioDeviceInfo,\n  videoDeviceList: state.devices.videoDeviceList,\n  audioDeviceList: state.devices.audioDeviceList,\n  cameraPermission: state.devices.cameraPermission,\n  microphonePermission: state.devices.microphonePermission\n});\n\nconst mapDispatchToProps = (dispatch: any) => ({\n  mute: (): void => dispatch(setMicrophone(false)),\n  setAudioDeviceInfo: (deviceInfo: AudioDeviceInfo): void => {\n    dispatch(setAudioDeviceInfo(deviceInfo));\n  },\n  setVideoDeviceInfo: (deviceInfo: VideoDeviceInfo): void => {\n    dispatch(setVideoDeviceInfo(deviceInfo));\n  }\n});\n\nconst connector: any = connect(mapStateToProps, mapDispatchToProps);\nexport default connector(GroupCall);\n","import React, { useState } from 'react';\r\nimport { Label, Overlay, Stack } from '@fluentui/react';\r\nimport Header from '../containers/Header';\r\nimport MediaGallery from '../containers/MediaGallery';\r\nimport MediaFullScreen from './MediaFullScreen';\r\nimport CommandPanel, { CommandPanelTypes } from './CommandPanel';\r\nimport { Constants } from '../core/constants';\r\nimport {\r\n  headerStyles,\r\n  containerStyles,\r\n  paneStyles,\r\n  hiddenContainerClassName,\r\n  activeContainerClassName,\r\n  loadingStyle,\r\n  overlayStyles\r\n} from './styles/GroupCall.styles';\r\nimport {\r\n  Call,\r\n  AudioDeviceInfo,\r\n  VideoDeviceInfo,\r\n  RemoteParticipant,\r\n  CallAgent,\r\n  DeviceManager,\r\n  LocalVideoStream\r\n} from '@azure/communication-calling';\r\nimport { ParticipantStream } from '../core/reducers/index.js';\r\n\r\nexport interface GroupCallProps {\r\n  userId: string;\r\n  groupId: string;\r\n  call: Call;\r\n  callAgent: CallAgent;\r\n  deviceManager: DeviceManager;\r\n  mic: boolean;\r\n  remoteParticipants: RemoteParticipant[];\r\n  callState: string;\r\n  localVideo: boolean;\r\n  screenShareStreams: ParticipantStream[];\r\n  audioDeviceInfo: AudioDeviceInfo;\r\n  videoDeviceInfo: VideoDeviceInfo;\r\n  audioDeviceList: AudioDeviceInfo[];\r\n  videoDeviceList: VideoDeviceInfo[];\r\n  screenWidth: number;\r\n  shareScreen: boolean;\r\n  setAudioDeviceInfo(deviceInfo: AudioDeviceInfo): void;\r\n  setVideoDeviceInfo(deviceInfo: VideoDeviceInfo): void;\r\n  mute(): void;\r\n  isGroup(): void;\r\n  joinGroup(): void;\r\n  endCallHandler(): void;\r\n  localVideoStream: LocalVideoStream;\r\n  setLocalVideoStream: void;\r\n}\r\n\r\nexport default (props: GroupCallProps): JSX.Element => {\r\n  const [selectedPane, setSelectedPane] = useState(CommandPanelTypes.None);\r\n  const activeScreenShare = props.screenShareStreams && props.screenShareStreams.length === 1;\r\n\r\n  return (\r\n    <Stack horizontalAlign=\"center\" verticalAlign=\"center\" styles={containerStyles}>\r\n      <Stack.Item styles={headerStyles}>\r\n        <Header\r\n          selectedPane={selectedPane}\r\n          setSelectedPane={setSelectedPane}\r\n          endCallHandler={(): void => {\r\n            props.endCallHandler();\r\n          }}\r\n          screenWidth={props.screenWidth}\r\n          localVideoStream={props.localVideoStream}\r\n          setLocalVideoStream={props.setLocalVideoStream}\r\n        />\r\n      </Stack.Item>\r\n      <Stack.Item styles={containerStyles}>\r\n        {!props.shareScreen ? (\r\n          props.callState === Constants.CONNECTED && (\r\n            <Stack horizontal styles={containerStyles}>\r\n              <Stack.Item grow styles={activeScreenShare ? activeContainerClassName : hiddenContainerClassName}>\r\n                {activeScreenShare && <MediaFullScreen activeScreenShareStream={props.screenShareStreams[0]} />}\r\n              </Stack.Item>\r\n              <Stack.Item grow styles={!activeScreenShare ? activeContainerClassName : hiddenContainerClassName}>\r\n                <MediaGallery localVideoStream={props.localVideoStream} />\r\n              </Stack.Item>\r\n              {selectedPane !== CommandPanelTypes.None &&\r\n                (window.innerWidth > Constants.MINI_HEADER_WINDOW_WIDTH ? (\r\n                  <Stack.Item disableShrink styles={paneStyles}>\r\n                    <CommandPanel {...props} selectedPane={selectedPane} setSelectedPane={setSelectedPane} />\r\n                  </Stack.Item>\r\n                ) : (\r\n                  <Overlay styles={overlayStyles}>\r\n                    <CommandPanel {...props} selectedPane={selectedPane} setSelectedPane={setSelectedPane} />\r\n                  </Overlay>\r\n                ))}\r\n            </Stack>\r\n          )\r\n        ) : (\r\n          <Stack horizontal styles={containerStyles}>\r\n            <Stack.Item styles={loadingStyle}>\r\n              <Label>Your screen is being shared</Label>\r\n            </Stack.Item>\r\n            {selectedPane !== CommandPanelTypes.None &&\r\n            (window.innerWidth > Constants.MINI_HEADER_WINDOW_WIDTH ? (\r\n              <Stack.Item disableShrink styles={paneStyles}>\r\n                <CommandPanel {...props} selectedPane={selectedPane} setSelectedPane={setSelectedPane} />\r\n              </Stack.Item>\r\n            ) : (\r\n              <Overlay styles={overlayStyles}>\r\n                <CommandPanel {...props} selectedPane={selectedPane} setSelectedPane={setSelectedPane} />\r\n              </Overlay>\r\n            ))}\r\n          </Stack>           \r\n        )}\r\n      </Stack.Item>\r\n    </Stack>\r\n  );\r\n};\r\n","import { IStackTokens, mergeStyles } from '@fluentui/react';\n\nexport const mainStackTokens: IStackTokens = {\n  childrenGap: '0.25rem'\n};\nexport const buttonsStackTokens: IStackTokens = {\n  childrenGap: '0.75rem'\n};\nexport const upperStackTokens: IStackTokens = {\n  childrenGap: '1.5rem'\n};\nexport const bottomStackTokens: IStackTokens = {\n  childrenGap: '1.4375rem'\n};\nexport const endCallContainerStyle = mergeStyles({\n  width: '20.625rem'\n});\nexport const endCallTitleStyle = mergeStyles({\n  fontSize: '1.375rem',\n  fontWeight: 600\n});\nexport const buttonStyle = mergeStyles({\n  fontWeight: 600,\n  height: '2.5rem',\n  width: '9.875rem',\n  fontSize: '0.875rem', // 14px\n  padding: 0\n});\nexport const videoCameraIconStyle = mergeStyles({\n  marginRight: '0.375rem',\n  fontSize: '1.375rem'\n});\nexport const bottomStackFooterStyle = mergeStyles({\n  color: 'rgb(0,0,0)',\n  fontSize: '0.875 rem'\n});\n","import React from 'react';\r\nimport { DefaultButton, PrimaryButton, Stack } from '@fluentui/react';\r\nimport { VideoCameraEmphasisIcon } from '@fluentui/react-icons-northstar';\r\nimport {\r\n  endCallContainerStyle,\r\n  endCallTitleStyle,\r\n  buttonStyle,\r\n  mainStackTokens,\r\n  buttonsStackTokens,\r\n  upperStackTokens,\r\n  videoCameraIconStyle,\r\n} from './styles/EndCall.styles';\r\n\r\nexport interface EndCallProps {\r\n  message: string;\r\n  rejoinHandler(): void;\r\n  homeHandler(): void;\r\n}\r\n\r\nexport default (props: EndCallProps): JSX.Element => {\r\n  const goHomePage = 'Go to chatpage';\r\n  const rejoinCall = 'Rejoin call';\r\n  \r\n  return (\r\n    <Stack verticalAlign=\"center\" tokens={mainStackTokens} className={endCallContainerStyle}>\r\n      <Stack tokens={upperStackTokens}>\r\n        <div className={endCallTitleStyle}>{props.message}</div>\r\n        <Stack horizontal tokens={buttonsStackTokens}>\r\n          <PrimaryButton className={buttonStyle} onClick={props.rejoinHandler}>\r\n            <VideoCameraEmphasisIcon className={videoCameraIconStyle} size=\"medium\" />\r\n            {rejoinCall}\r\n          </PrimaryButton>\r\n          <DefaultButton className={buttonStyle} onClick={props.homeHandler}>\r\n            {goHomePage}\r\n          </DefaultButton>\r\n        </Stack>\r\n      </Stack>\r\n    </Stack>\r\n  );\r\n};\r\n","import { loadTheme, initializeIcons } from '@fluentui/react';\nimport React, { useState, useCallback, useEffect} from 'react';\nimport { Provider } from 'react-redux';\nimport { createStore, applyMiddleware } from 'redux';\nimport thunk from 'redux-thunk';\nimport { CallEndReason } from '@azure/communication-calling';\n\nimport ChatScreen from './containers/ChatScreen';\nimport ConfigurationScreen from './containers/ConfigurationScreen';\nimport CallConfigurationScreen from './containers/CallConfigurationScreen';\nimport EndScreen from './components/EndScreen';\nimport RemovedFromThreadScreen from './components/RemovedFromThreadScreen';\nimport HomeScreen from './containers/HomeScreen';\nimport { reducer } from './core/reducers/index';\nimport { getBuildTime, getChatSDKVersion, getThreadId } from './utils/utils';\n\nimport GroupCall from './containers/GroupCall';\nimport EndCall from './components/EndCall';\n\nconsole.info(`Azure Communication Services chat sample using @azure/communication-chat : ${getChatSDKVersion()}`);\nconsole.info(`Build Date : ${getBuildTime()}`);\n\nloadTheme({});\ninitializeIcons();\n\nconst store = createStore(reducer, applyMiddleware(thunk));\nconst groupId = \"c07ff9d0-e09a-11eb-a078-25f7f03a6567\";\n\n\nexport default (): JSX.Element => {\n  const [page, setPage] = useState('home');\n  const [callEndReason, setCallEndReason] = useState<CallEndReason | undefined>();\n  const [screenWidth, setScreenWidth] = useState(0);\n  const [localVideoStream, setLocalVideoStream] = useState(undefined);\n\n  const unsupportedStateHandler = useCallback((): void => setPage('unsupported'), []);  \n\n  useEffect(() => {\n    const setWindowWidth = (): void => {\n      const width = typeof window !== 'undefined' ? window.innerWidth : 0;\n      setScreenWidth(width);\n    };\n\n    setWindowWidth();\n    window.addEventListener('resize', setWindowWidth);\n    return (): void => {\n      window.removeEventListener('resize', setWindowWidth);\n    } \n  }, []);\n\n  const getGroupIdFromUrl = (): string | null => {\n    const urlParams = new URLSearchParams(window.location.search);\n    console.log(\"I am here\" + urlParams.get('groupId'));\n    return urlParams.get('groupId');\n  };\n\n  const getGroupId = (): string => {\n    return groupId;\n  };\n\n  const getComponent = () => {\n    if (page === 'home') {\n      return <HomeScreen />;\n    } else if (page === 'configuration') {\n      return <ConfigurationScreen joinChatHandler={() => setPage('chat') } />;\n    } else if (page === 'chat') {     \n      return (\n        <ChatScreen\n          removedFromThreadHandler={() => setPage('removedFromThread')}\n          leaveChatHandler={() => setPage('end')}\n          startCallHandler={(): void => {\n            if(!getGroupIdFromUrl()) {\n              window.history.pushState({}, document.title, window.location.href + '&groupId=' + getGroupId());\n            }\n            setPage('callConfiguration');\n          }}\n        />\n      );\n    } else if (page === 'callConfiguration') {\n      return (\n        <CallConfigurationScreen\n          startCallHandler={(): void => setPage('call')}\n          unsupportedStateHandler={unsupportedStateHandler}\n          callEndedHandler={(errorMsg: CallEndReason): void => {\n            setCallEndReason(errorMsg);\n            setPage('error');\n          }}\n          groupId={getGroupId()}\n          screenWidth={screenWidth}\n          localVideoStream={localVideoStream}\n          setLocalVideoStream={setLocalVideoStream}\n        />\n      );\n    } else if (page === 'call') {\n      return (\n        <GroupCall\n          endCallHandler={(): void => setPage('endCall')}\n          groupId={getGroupId()}\n          screenWidth={screenWidth}\n          localVideoStream={localVideoStream}\n          setLocalVideoStream={setLocalVideoStream}\n        />\n      );\n    } else if (page === 'endCall') {\n      return (\n        <EndCall\n          message={'You left the call'}\n          rejoinHandler={(): void => {\n            setPage('callConfiguration');\n          }}\n          homeHandler={(): void => {\n            setPage('chat');\n          }}\n        />\n      );\n    } \n    else if (page === 'end') {\n      return (\n        <EndScreen\n          rejoinHandler={() => {\n            setPage('chat');\n          }}\n          homeHandler={() => (window.location.href = window.location.origin)}\n        />\n      );\n    } else if (page === 'removedFromThread') {\n      return <RemovedFromThreadScreen homeHandler={() => (window.location.href = window.location.origin)} />;\n    }\n  };\n\n  if (getThreadId() && page === 'home') {\n    setPage('configuration');\n  }\n\n  // if (getGroupIdFromUrl() && page === 'chat') {\n  //   setPage('callConfiguration');\n  // }\n\n  return <Provider store={store}>{getComponent()}</Provider>;\n};\n","import { Provider, teamsTheme, mergeThemes } from '@fluentui/react-northstar';\nimport { svgIconStyles } from '@fluentui/react-northstar/dist/es/themes/teams/components/SvgIcon/svgIconStyles';\nimport { svgIconVariables } from '@fluentui/react-northstar/dist/es/themes/teams/components/SvgIcon/svgIconVariables';\nimport * as siteVariables from '@fluentui/react-northstar/dist/es/themes/teams/siteVariables';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\nimport './index.css';\n\nconst iconTheme = {\n  componentStyles: {\n    SvgIcon: svgIconStyles\n  },\n  componentVariables: {\n    SvgIcon: svgIconVariables\n  },\n  siteVariables\n};\n\nReactDOM.render(\n  <Provider theme={mergeThemes(iconTheme, teamsTheme)} className=\"wrapper\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0\" />\n    <App />\n  </Provider>,\n  document.getElementById('root')\n);\n","module.exports = __webpack_public_path__ + \"static/media/staticmedia.3545b0ef.svg\";","module.exports = __webpack_public_path__ + \"static/media/hero.8df54419.svg\";"],"sourceRoot":""}